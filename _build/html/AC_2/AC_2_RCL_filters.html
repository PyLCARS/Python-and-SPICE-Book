
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Basic Passive Filters &#8212; Python &amp; SPICE</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What is PZ anylsis" href="AC_4_PZ.html" />
    <link rel="prev" title="&lt;no title&gt;" href="AC_1_One-Two-Three_Phase_AC.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python & SPICE</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../needed_libraries.html">
   Dependency install instruction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../DC_1/DC_1.html">
   Chapter 1 DC Simulations and Basic DC Elements with Python and SPICE
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_1_op_ohm.html">
     Getting started with Python &amp; SPICE, DC Operating Point Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_1_op_ohm.html#spice-s-dc-operating-point-simulation-op">
     SPICE’s DC Operating Point simulation
     <code class="docutils literal notranslate">
      <span class="pre">
       .op
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_2_op_source_transform.html">
     Working with SKiDl elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html">
     DC Sweeps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#dc-load-sweep-of-an-ideal-voltage-source">
     DC load sweep of an Ideal Voltage source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#a-better-dc-sim-interaction">
     A Better
     <code class="docutils literal notranslate">
      <span class="pre">
       .dc
      </span>
     </code>
     Sim Interaction¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#ideal-current-source">
     Ideal Current Source¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#first-testbench-element">
     First testbench element¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html">
     Controlled Dependent Sources in SPICE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#ccvs">
     CCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#enter-the-spice-transfer-function">
     Enter the SPICE transfer function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#lcapy">
     LCAPY
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#vcvs">
     VCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#cccs">
     CCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#vccs">
     VCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_5_Thvenin_Norton.html">
     Thevenin’s DC Equivalent Circuit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_5_Thvenin_Norton.html#norton-s-theorem">
     Norton’s Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_6_DC_MaxPower_MaxEfficiency.html">
     Maximum Power Transfer Theorem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="AC_1.html">
   Chapter 2 AC simulations with Python and SPICE
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Basic Passive Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#first-order-cascade-filter">
     First Order Cascade filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#second-order-filters-and-resonators">
     Second-Order Filters and resonators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#all-pass-filters">
     All Pass filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html">
     What is PZ anylsis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#pz-analysis-of-an-rc-lowpass-filter">
     PZ analysis of an RC lowpass filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#pz-ease">
     PZ ease
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#pole-zero-analysis-of-a-series-band-reject-filter">
     Pole-Zero analysis of a Series Band Reject filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#pole-zero-analysis-of-a-lattice-all-pass-filter">
     Pole-Zero analysis of a lattice All-Pass filter¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#add-the-razavi-t-coil-after-the-previous-magnetic-section-is-done">
     Add the Razavi T-coil after the previous magnetic section is done¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AC_4_PZ.html#citations">
     Citations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html">
   Checking tool
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#basic-elements">
   Basic Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-sinusoidalmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SinusoidalMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-pulsemixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PulseMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-exponentialmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     ExponentialMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-piecewiselinearmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PieceWiseLinearMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-singlefrequencyfmmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SingleFrequencyFMMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-amplitudemodulatedmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     AmplitudeModulatedMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-randommixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     RandomMixin
    </span>
   </code>
   Based
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/AC_2/AC_2_RCL_filters.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book/issues/new?title=Issue%20on%20page%20%2FAC_2/AC_2_RCL_filters.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PyLCARS/Python-and-SPICE-Book/master?urlpath=tree/docs/AC_2/AC_2_RCL_filters.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Basic Passive Filters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-rc-low-pass-filter">
     The RC Low Pass Filter¶
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-low-pass-rc-filter-from-all-about-electronics-rc-low-pass-filter-explained-8-35min">
       The low pass RC filter from ALL ABOUT ELECTRONICS “RC Low Pass Filter Explained” @~ 8:35min
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rc-low-pass-filter-subcircuit-container-class">
       RC Low Pass Filter Subcircuit container class
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#making-ac-ease">
       making ac_ease¶
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#making-a-basic-ac-data-conversion-tool">
       making a basic ac data conversion tool
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#making-a-complex-representation-plotting-templet">
       Making a complex representation plotting templet¶
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-quick-filter-exploration-tool-for-the-rest-of-this-notebook">
       A quick filter exploration tool for the rest of this notebook¶
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-high-pass-filter-from-all-about-electronics-rc-high-pass-filter-explained-7-57min">
     The high pass filter from ALL ABOUT ELECTRONICS “RC High Pass Filter Explained” @~ 7:57min
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rl-highpass">
     RL Highpass
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-order-cascade-filter">
   First Order Cascade filter
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-band-pass-filter-from-all-about-electronics-band-pass-filter-and-band-stop-filter-explained-4-03min">
     The band pass filter from ALL ABOUT ELECTRONICS “Band Pass Filter and Band Stop Filter Explained” @~ 4:03min
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-order-filters-and-resonators">
   Second-Order Filters and resonators
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#series-based">
     Series Based¶
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-series-lowpass">
       RLC series lowpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-series-highpass">
       RLC series highpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-series-bandpass">
       RLC series bandpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-series-bandstop">
       RLC series bandstop
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-based">
     Parallel Based¶
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-parallel-lowpass">
       RLC parallel lowpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-parallel-highpass">
       RLC parallel highpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-parallel-bandpass">
       RLC parallel bandpass
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rlc-parallel-bandstop">
       RLC parallel bandstop
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#all-pass-filters">
   All Pass filters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#citations">
     Citations:
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>TODO:</p>
<ul class="simple">
<li><p>get the unit renaming in the columns working with regex in <code class="docutils literal notranslate"><span class="pre">ac_representation_tool</span></code></p></li>
<li><p>figure out why the sym and symbolic all-pass filter diverge from each other</p></li>
<li><p>create a table of low-high pass vs rc &amp; rl</p></li>
<li><p>look into ngspice internals and really verify that there are no
equivalencies to dc internals with .ac sims</p></li>
</ul>
<p>Most likely will do this in another section further down the road</p>
<ul class="simple">
<li><p>add filter design tool and filter circuit generation tool; see isbn 978-0-387-92766-4 and things like cauer network tf implimentation</p></li>
<li><p>discuss L-&gt;C passive conversion</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skidl.pyspice</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#can you say cheeky </span>
<span class="kn">import</span> <span class="nn">PySpice</span> <span class="k">as</span> <span class="nn">pspice</span>
<span class="c1">#becouse it&#39;s written by a kiwi you know</span>
<span class="kn">import</span> <span class="nn">lcapy</span> <span class="k">as</span> <span class="nn">kiwi</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>


<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: KICAD_SYMBOL_DIR environment variable is missing, so the default KiCad symbol libraries won&#39;t be searched.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DC_1_Codes</span> <span class="kn">import</span> <span class="n">get_skidl_spice_ref</span>
<span class="c1">#from AC_2_Codes import </span>

<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>

<span class="c1">#notebook specific loading control statements </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#tool to log notebook internals</span>
<span class="c1">#https://github.com/jrjohansson/version_information</span>
<span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> skidl, PySpice,lcapy, sympy, numpy, matplotlib, pandas, scipy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.6 64bit [GCC 7.3.0]</td></tr><tr><td>IPython</td><td>7.12.0</td></tr><tr><td>OS</td><td>Linux 4.19.104 microsoft standard x86_64 with debian bullseye sid</td></tr><tr><td>skidl</td><td>0.0.31.dev0</td></tr><tr><td>PySpice</td><td>1.4.3</td></tr><tr><td>lcapy</td><td>0.75.dev0</td></tr><tr><td>sympy</td><td>1.6.2</td></tr><tr><td>numpy</td><td>1.18.1</td></tr><tr><td>matplotlib</td><td>3.3.0</td></tr><tr><td>pandas</td><td>1.1.4</td></tr><tr><td>scipy</td><td>1.4.1</td></tr><tr><td colspan='2'>Fri Jan 15 01:34:05 2021 MST</td></tr></table></div></div>
</div>
<div class="section" id="basic-passive-filters">
<h1>Basic Passive Filters<a class="headerlink" href="#basic-passive-filters" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will construct and look at the basic passive analog filters constructed of RLC elements only. For now, we will just develop an ac equivalent tool to <code class="docutils literal notranslate"><span class="pre">dc_ease</span></code> that was in the last chapter. As well as some basic data manipulation, plotting tool, and classes for the RLC primitive filters. For advanced tools filter analysis will be developed later in this chapter in section asdlkjfaljdfkj where then we can compare not only the SPICE simulation data but also the SPICE generated Pole-Zero Transfer function and the theoretical transfer function to each other in greater detail.</p>
<div class="section" id="the-rc-low-pass-filter">
<h2>The RC Low Pass Filter¶<a class="headerlink" href="#the-rc-low-pass-filter" title="Permalink to this headline">¶</a></h2>
<p>The RC filter is a first-order single-pole filter. Where the pole is realized physically by a shunt capacitor. For more technical details about an RC low pass filter consult the YT video by ALL ABOUT ELECTRONICS “RC Low Pass Filter Explained” that serves as the example source below</p>
<div class="section" id="the-low-pass-rc-filter-from-all-about-electronics-rc-low-pass-filter-explained-8-35min">
<h3>The low pass RC filter from ALL ABOUT ELECTRONICS “RC Low Pass Filter Explained” &#64;~ 8:35min<a class="headerlink" href="#the-low-pass-rc-filter-from-all-about-electronics-rc-low-pass-filter-explained-8-35min" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;_2L0l-E1Wx0&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">515</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/_2L0l-E1Wx0?start=515"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
</div>
<div class="section" id="rc-low-pass-filter-subcircuit-container-class">
<h3>RC Low Pass Filter Subcircuit container class<a class="headerlink" href="#rc-low-pass-filter-subcircuit-container-class" title="Permalink to this headline">¶</a></h3>
<p>The class below is the first in a series of classes developed in this section to create and store information about the filter primitive under test. For each of these primitives we will create a class that does three things:</p>
<ul class="simple">
<li><p>stores the filter element values in the class initiation method</p></li>
<li><p>generates the filter and its elements inside a SKiDl subcircuit to then included in the circuit under design</p></li>
<li><p>provides a schematic representation method of the filter being constructed by this class via lcapy</p></li>
<li><p>provides the transfer function and two-port representation of the filter in sympy via its own methods by using the lcapy schematic</p></li>
</ul>
<p>We see how this is done with the RC Low Pass filter first below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rc_lowpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RC lowpass filter</span>

<span class="k">class</span> <span class="nc">rc_lowpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    lowpass RC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RC_Lowpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RC lowpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract simply variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R 0_1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;C 2_1 1_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
        
            
        
        
</pre></div>
</div>
</div>
</div>
<p>In the method for the subcircuit <code class="docutils literal notranslate"><span class="pre">SKiDl</span></code> above we referenced a port-terminal convention from a library <strong>scikit-rf</strong>. This is the main python library for S-parameter analysis and primitive rf circuit design in the Python scientific ecosystem. Where we will interact with it at length in the following sections but for now let’s just get in the habit of using their port-terminal convention since we are coding all this up in python</p>
<p>Below we instantiate the filter to the values found in the reference example above and draw it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rc_lowpass filter to </span>
<span class="n">lowpassF</span><span class="o">=</span><span class="n">rc_lowpass</span><span class="p">(</span><span class="n">C_value</span><span class="o">=.</span><span class="mi">1</span><span class="nd">@u_uF</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_kOhm</span><span class="p">)</span>
<span class="n">lowpassF</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_11_0.png" src="../_images/AC_2_RCL_filters_11_0.png" />
</div>
</div>
<p>Nest using <code class="docutils literal notranslate"><span class="pre">lcapy</span></code> we can use the circuit we created in <code class="docutils literal notranslate"><span class="pre">rc_lowpass.lcapy_self</span></code> to then extract the voltage transfer function coming from the Port 0 &amp; 1 Terminals to the Port 2 &amp; 3 Terminals. Where the method has been abstracted such that it can be called to just get the symbolic equation or get the symbolic equation with the values of this particular instance substituted into the symbolic expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">lowpassF</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{1}{C R \left(s + \frac{1}{C R}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">lowpassF</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{10000}{s + 10000}\]</div>
</div>
</div>
<p>and finally, we will now use the lowpass filter in its primary utilization as part of a circuit to be simulated with SPICE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">lowpassF</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 Out 0 0.1uF
R1 In Out 1kOhm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="making-ac-ease">
<h3>making ac_ease¶<a class="headerlink" href="#making-ac-ease" title="Permalink to this headline">¶</a></h3>
<p>In the last chapter, we developed a class <code class="docutils literal notranslate"><span class="pre">dc_ease</span></code> to make running the .dc SPICE simulation more automated. Here we will develop an analogies class <code class="docutils literal notranslate"><span class="pre">ac_ease</span></code> to automate the .ac simulation. There are some differences thou. For one with .dc simulation, we could sweep over any variable (I still need to fix pyspice to do that); whereas we learned in the last section that .ac simulation only allows us to sweep the operating frequency of all our sources simultaneously and observe the response of the circuit to each frequency in terms of Fourier transform terms. The second thing is that .dc simulations allowed us to access a plethora of circuit elements’ internal parameters to record things such as current and power without having to add SPICE ammeter all over the place. While .ac does not have quite that support in ngspice (see typically chapter 31 “Model and Device Parameters” in the ngspice manual). So we are going to forgo do internal parameters in <code class="docutils literal notranslate"><span class="pre">ac_ease</span></code>.</p>
<p>Also, in the last section, we just used the “linear” sweep capability of an ac simulation. However, AC simulations are more commonly done via logarithm sweeps. This is akin to <code class="docutils literal notranslate"><span class="pre">np.logspace</span></code>, however, unlike NumPy’s logspace, we till .ac what the starting and stop are and how many samples we want per decade. And then there is the less used ” octave ” sampling scheme where there is no numpy kin. Octave takes the starting frequency, say 1kHz, and then computes the doubles of it (think octaves in music) and then samples within that doubling. So 1kHz doubles to 2kHz and so on till the stop frequency is reached while getting n samples within each double via the “number_of_points” argument in the .ac simulation control.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 ac_ease class</span>
<span class="c1">#class to perform .ac simulations with a bit more grace</span>

<span class="k">class</span> <span class="nc">ac_ease</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to perform AC (.ac) SPICE simulation with some grace; </span>
<span class="sd">    currently limited to what pyspice and ngspice support</span>
<span class="sd">    </span>
<span class="sd">    TODO:</span>
<span class="sd">        - independent current sources can have their AC current measured via </span>
<span class="sd">        `@I&lt;name&gt;[acreal]` &amp; `@I&lt;name&gt;[acrimag]` not shure if this is usefull</span>
<span class="sd">        also trying via the sensitivity </span>
<span class="sd">        - do some serious testing with ngspice directly to verify that internal</span>
<span class="sd">        parameters are as limited as they appear to be with .ac</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">circ_netlist_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class to perform AC (.ac) SPICE simulation with some grace</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            circ_netlist_obj (pyspice.Spice.Netlist.Circuit): the Netlist circuit produced </span>
<span class="sd">                from SKiDl&#39;s `generate_netlist()`</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            creates a table to control the ac sweep `self.fsweep_DF`</span>
<span class="sd">            this table will still need to be filled out before a simulation can be run with `self.do_ac_sim`</span>
<span class="sd">            can be filled out manually or with the helper method `self.ac_sweep_setup`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">=</span><span class="n">circ_netlist_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_build_table</span><span class="p">()</span>
        
        <span class="c1">#dic of allowed AC sweep types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_steptypes_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linear&#39;</span><span class="p">:</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="s1">&#39;decade&#39;</span><span class="p">:</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;octave&#39;</span><span class="p">:</span> <span class="s1">&#39;oct&#39;</span><span class="p">}</span>

    
    <span class="k">def</span> <span class="nf">_build_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        protected method to create `self.fsweep_DF` dataframe that stores the controls for the ac simulation</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            -when pyspice accepts more things to sweep add them below</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Start_freq&#39;</span><span class="p">,</span> <span class="s1">&#39;Stop_Freq&#39;</span><span class="p">,</span> <span class="s1">&#39;SamplingInc&#39;</span><span class="p">,</span> <span class="s1">&#39;StepType&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="mi">120</span><span class="nd">@u_GHz</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;decade&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">ac_sweep_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Start_freq</span><span class="p">,</span> <span class="n">Stop_Freq</span><span class="p">,</span> <span class="n">SamplingInc</span><span class="p">,</span> <span class="n">StepType</span><span class="p">,</span> <span class="n">display_table</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to create the `self.fsweep_DF` to control the ac simulation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            Start_freq (Hertz): starting frequency in Hertz of the ac simulation, must be less than `Stop_Freq` and can</span>
<span class="sd">                only be zero if `StepType=&#39;linear&#39;`</span>
<span class="sd">            </span>
<span class="sd">            Stop_Freq (Hertz): stoping  frequency in Hertz of the ac simulation, must be greater than `Start_freq` </span>
<span class="sd">            </span>
<span class="sd">            SamplingInc (int): number of samples per StepType interval</span>
<span class="sd">            </span>
<span class="sd">            StepType (string): string control for the ac simulation Step type.</span>
<span class="sd">                must be &#39;linear&#39; (self-explanatory), &#39;decade&#39; (log base 10 sampling interval), </span>
<span class="sd">                or &#39;octave&#39; (starting frequency times 2**n to create sample space a double of the starting frequency</span>
<span class="sd">                so that samples are pulled from 2**(n-1) and 2**(n) times the starting frequency)</span>
<span class="sd">            </span>
<span class="sd">            display_table (bool; False): when true will display the generated `self.fsweep_DF` below</span>
<span class="sd">             this method call in a jupyter notebook like environment</span>
<span class="sd">            </span>
<span class="sd">        TODO:</span>
<span class="sd">            -add display action</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#check for allowed step types</span>
        <span class="k">assert</span> <span class="n">StepType</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_steptypes_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{StepType}</span><span class="s2"> is not allowed&quot;</span>
        <span class="c1">#force start to non zero if sweep not linear</span>
        <span class="k">if</span> <span class="n">StepType</span> <span class="o">!=</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">Start_freq</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;&quot;linear&quot; is only sweep type that can start at 0Hz,</span><span class="se">\n</span><span class="s1"> setting starting frequancy to 1e-1Hz&#39;</span><span class="p">)</span>
                <span class="n">Start_freq</span><span class="o">=</span><span class="mf">1e-1</span><span class="nd">@u_Hz</span>
                
                
        <span class="c1">#check that stop frequency is greater than start</span>
        <span class="k">assert</span> <span class="n">Stop_Freq</span><span class="o">&gt;</span><span class="n">Start_freq</span><span class="p">,</span> <span class="s1">&#39;Stop frequency must be greater then starting frequency&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">Start_freq</span><span class="p">,</span> <span class="n">Stop_Freq</span><span class="p">,</span> <span class="n">SamplingInc</span><span class="p">,</span> <span class="n">StepType</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">display_table</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_make_sim_control</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal method to extract the row information to the .ac pyspice call arguments</span>
<span class="sd">        Will raise a warning if the simulation start frequency is 0Hz for non-linear frequency sampling and </span>
<span class="sd">        then set the start frequency to .1Hz</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            NONE</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            `self.ac_control` what is feed into the .ac to do the simulation over a frequency</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#check the control table struct</span>
        <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="p">[</span><span class="s1">&#39;Start_freq&#39;</span><span class="p">,</span> <span class="s1">&#39;Stop_Freq&#39;</span><span class="p">,</span> <span class="s1">&#39;SamplingInc&#39;</span><span class="p">,</span> <span class="s1">&#39;StepType&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;Contorl Table Column structer has been altered&#39;</span>
        
        <span class="c1">#will probably change this down the road</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;there should only be one entry in the control table&#39;</span>
        
        <span class="c1">#check the sweep type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">[</span><span class="s1">&#39;StepType&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_steptypes_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{self.fsweep_DF[&#39;StepType&#39;][0]}</span><span class="s2"> is not allowed&quot;</span>
        
        <span class="c1">#check that stop frequency is greater than start</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Stop_Freq&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Start_freq&#39;</span><span class="p">],</span> <span class="s1">&#39;Stop freqauncy must be grater then starting freauncy&#39;</span>
        
        <span class="c1">#force start to non zero if sweep not linear</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">[</span><span class="s1">&#39;StepType&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="p">[</span><span class="s1">&#39;Start_freq&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;&quot;linear&quot; is only sweep type that can start at 0Hz,</span><span class="se">\n</span><span class="s1"> setting starting frequancy to 1e-1Hz&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Start_freq&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1e-1</span><span class="nd">@u_Hz</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_control</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;start_frequency&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Start_freq&#39;</span><span class="p">],</span> 
            <span class="s1">&#39;stop_frequency&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Stop_Freq&#39;</span><span class="p">],</span> 
            <span class="s1">&#39;number_of_points&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SamplingInc&#39;</span><span class="p">],</span>
            <span class="s1">&#39;variation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_steptypes_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;StepType&#39;</span><span class="p">]]</span>
        <span class="p">}</span>
        
        
        
    
    <span class="k">def</span> <span class="nf">do_ac_sim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a standard Branch and Node .ac simulation for the single filled out row in `self.fsweep_DF`</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            None</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            raw results are stored in `self.ac_vals`, processed results are automatically stored in </span>
<span class="sd">            `self.ac_resultsNB_DF` via `self.record_ac_nodebranch`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_sim_control</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_vals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_control</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">record_ac_nodebranch</span><span class="p">()</span>

    
    <span class="k">def</span> <span class="nf">record_ac_nodebranch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Helper method to put .ac node branch results into a dataframe where the index is the </span>
<span class="sd">        sweep frequency used in the simulation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            None</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            `self.ac_resultsNB_DF` which is a pandas dataframe with the index being the sweep frequency</span>
<span class="sd">            and the columns being the node voltages and branch currents from any available voltage sources  </span>
<span class="sd">            </span>
<span class="sd">        TODO:</span>
<span class="sd">            look into getting the current in any current sources</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>
        
        <span class="c1">#get the node voltages</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">.</span><span class="n">node_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s1">&#39;0&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="s1">&#39;_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
        
        <span class="c1">#get the current from any voltage source</span>
        <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">.</span><span class="n">element_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;V&#39;</span><span class="o">==</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="p">[</span><span class="n">cm</span><span class="o">+</span><span class="s1">&#39;_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">cm</span><span class="p">]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
                
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instainte the simulation from the circuit</span>
<span class="n">ac_sweep</span><span class="o">=</span><span class="n">ac_ease</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="c1">#setup the simulation parameter with the helper method</span>
<span class="n">ac_sweep</span><span class="o">.</span><span class="n">ac_sweep_setup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="nd">@u_MHz</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;decade&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/iridium/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:76: UserWarning: &quot;linear&quot; is only sweep type that can start at 0Hz,
 setting starting frequancy to 1e-1Hz
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>100 MHz</td>
      <td>10</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_sweep</span><span class="o">.</span><span class="n">do_ac_sim</span><span class="p">()</span>
<span class="n">ac_sweep</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Out_[V]</th>
      <th>In_[V]</th>
      <th>V1_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.000000e-01</th>
      <td>1.000000-0.000063j</td>
      <td>1.000000+0.000000j</td>
      <td>3.947842e-12+6.283185e-08j</td>
    </tr>
    <tr>
      <th>1.258925e-01</th>
      <td>1.000000-0.000079j</td>
      <td>1.000000+0.000000j</td>
      <td>6.256907e-12+7.910062e-08j</td>
    </tr>
    <tr>
      <th>1.584893e-01</th>
      <td>1.000000-0.000100j</td>
      <td>1.000000+0.000000j</td>
      <td>9.916529e-12+9.958178e-08j</td>
    </tr>
    <tr>
      <th>1.995262e-01</th>
      <td>1.000000-0.000125j</td>
      <td>1.000000+0.000000j</td>
      <td>1.571664e-11+1.253660e-07j</td>
    </tr>
    <tr>
      <th>2.511886e-01</th>
      <td>1.000000-0.000158j</td>
      <td>1.000000+0.000000j</td>
      <td>2.490920e-11+1.578265e-07j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3.981072e+07</th>
      <td>0.000000-0.000040j</td>
      <td>1.000000+0.000000j</td>
      <td>1.000000e-03+3.997791e-08j</td>
    </tr>
    <tr>
      <th>5.011872e+07</th>
      <td>0.000000-0.000032j</td>
      <td>1.000000+0.000000j</td>
      <td>1.000000e-03+3.175559e-08j</td>
    </tr>
    <tr>
      <th>6.309574e+07</th>
      <td>0.000000-0.000025j</td>
      <td>1.000000+0.000000j</td>
      <td>1.000000e-03+2.522436e-08j</td>
    </tr>
    <tr>
      <th>7.943282e+07</th>
      <td>0.000000-0.000020j</td>
      <td>1.000000+0.000000j</td>
      <td>1.000000e-03+2.003642e-08j</td>
    </tr>
    <tr>
      <th>1.000000e+08</th>
      <td>0.000000-0.000016j</td>
      <td>1.000000+0.000000j</td>
      <td>1.000000e-03+1.591549e-08j</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 3 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="making-a-basic-ac-data-conversion-tool">
<h3>making a basic ac data conversion tool<a class="headerlink" href="#making-a-basic-ac-data-conversion-tool" title="Permalink to this headline">¶</a></h3>
<p>As we learned in the last section since the returns of an AC simulation are complex values we have to represent the values in order to just plot the values. The following class has methods that will allow us to pass in the raw results of the AC simulation and then perform reinterpretation of the values as needed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 ac_representation_tool class</span>
<span class="c1">#class that converts dataframe of raw ac complex data to veries complex</span>
<span class="c1">#repsentations </span>

<span class="k">class</span> <span class="nc">ac_representation_tool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to take a dataframe with AC simulation complex value data and</span>
<span class="sd">    represent it in various ways. raw data should come from `ac_ease.ac_resultsNB_DF`</span>
<span class="sd">    </span>
<span class="sd">    TODO:</span>
<span class="sd">        -get the unit renaming in the columns working with regex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ac_sim_raw_DF</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        pull in the data</span>
<span class="sd">        Args:</span>
<span class="sd">            ac_sim_raw_DF (pandas dataframe): pandas dataframe of raw data from AC simulation </span>
<span class="sd">                preferbyly from `ac_ease.ac_resultsNB_DF`, index must be the simulation</span>
<span class="sd">                frequency and columns must be the complex data</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            None</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            broaden complex assertin to include np.complex128</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#write asserts for ac_sim_DF</span>
        <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ac_sim_raw_DF</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;`ac_sim_raw_DF` must be a dataframe&#39;</span>
        <span class="c1">#check that all columns from raw data are complex</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">dtypes</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">dtypes</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;Raw data must be complex from AC sim&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">=</span><span class="n">ac_sim_raw_DF</span>
    
    <span class="k">def</span> <span class="nf">make_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create a real and image version of the raw data</span>

<span class="sd">        Args: None</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            real values are stored in `self.ac_sim_real_DF`; and </span>
<span class="sd">            imaginary values are stored in `self.ac_sim_imag_DF`</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_real_DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_imag_DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
    
    <span class="k">def</span> <span class="nf">make_mag_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span> <span class="n">char_res</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">phase_unwrap</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to make generate the various magnitude and phase representation of the complex data</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            mag (string, &quot;dB&quot;): control statement to specify the representation of the generated </span>
<span class="sd">                magnitude data; right now only &#39;dB&#39; and &#39;abs&#39; are supported</span>
<span class="sd">            </span>
<span class="sd">            char_res (float; 50; ohms): the characteristic impedance for magnitude representation calculations; not </span>
<span class="sd">                implemented at the moment</span>
<span class="sd">            </span>
<span class="sd">            deg (bool; True): bool control statement to represent the phase data in degrees if True; else in radians</span>
<span class="sd">            </span>
<span class="sd">            phase_unwrap (bool; True): when True and `deg` is True will represent the degrees in phased unwrapped</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            magnitude data is stored in `self.ac_sim_mag_DF` and phase data is stored in `self.ac_sim_phase_DF`</span>
<span class="sd">        </span>
<span class="sd">        TODO: </span>
<span class="sd">            -complete all of the magnitude conversions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#deal with the cacophony of magnitudes</span>
        <span class="n">mag_conversions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;dB&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="s1">&#39;[VAR]&#39;</span><span class="p">,</span> <span class="s1">&#39;[VA]&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> 
            <span class="s1">&#39;abs&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1">#check the input</span>
        <span class="k">assert</span> <span class="n">mag</span> <span class="ow">in</span> <span class="n">mag_conversions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{mag}</span><span class="s1"> is not a known magnitude repsentation&#39;</span>
         
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mag_conversions</span><span class="p">[</span><span class="n">mag</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="c1">#redo the column name units</span>
        <span class="c1">#get down with the regex to really do this</span>
        <span class="k">if</span> <span class="n">mag</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dB&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;[dB]&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">columns</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1">#deal with the phase</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">deg</span><span class="o">==</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">phase_unwrap</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
            <span class="c1">#phase unwrapped lambda function</span>
            <span class="n">angle_phase_unwrap</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">angle_phase_unwrap</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_raw_DF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="n">deg</span><span class="p">)</span>

        <span class="c1">#realy need that stupid regex working</span>
        
        <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;[deg]&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">.</span><span class="n">columns</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;[rads]&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="o">.</span><span class="n">columns</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_rep_tool</span><span class="o">=</span><span class="n">ac_representation_tool</span><span class="p">(</span><span class="n">ac_sweep</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="p">)</span>
<span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">make_real_imag</span><span class="p">()</span>
<span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_real_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Out_[V]</th>
      <th>In_[V]</th>
      <th>V1_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.000000e-01</th>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>3.947842e-12</td>
    </tr>
    <tr>
      <th>1.258925e-01</th>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>6.256907e-12</td>
    </tr>
    <tr>
      <th>1.584893e-01</th>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>9.916529e-12</td>
    </tr>
    <tr>
      <th>1.995262e-01</th>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>1.571664e-11</td>
    </tr>
    <tr>
      <th>2.511886e-01</th>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>2.490920e-11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3.981072e+07</th>
      <td>1.598234e-09</td>
      <td>1.0</td>
      <td>1.000000e-03</td>
    </tr>
    <tr>
      <th>5.011872e+07</th>
      <td>1.008417e-09</td>
      <td>1.0</td>
      <td>1.000000e-03</td>
    </tr>
    <tr>
      <th>6.309574e+07</th>
      <td>6.362683e-10</td>
      <td>1.0</td>
      <td>1.000000e-03</td>
    </tr>
    <tr>
      <th>7.943282e+07</th>
      <td>4.014581e-10</td>
      <td>1.0</td>
      <td>1.000000e-03</td>
    </tr>
    <tr>
      <th>1.000000e+08</th>
      <td>2.533030e-10</td>
      <td>1.0</td>
      <td>1.000000e-03</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">make_mag_phase</span><span class="p">()</span>
<span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Out_[V][dB]</th>
      <th>In_[V][dB]</th>
      <th>V1_[A][dB]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.000000e-01</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-144.036407</td>
    </tr>
    <tr>
      <th>1.258925e-01</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-142.036407</td>
    </tr>
    <tr>
      <th>1.584893e-01</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-140.036407</td>
    </tr>
    <tr>
      <th>1.995262e-01</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-138.036407</td>
    </tr>
    <tr>
      <th>2.511886e-01</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-136.036407</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3.981072e+07</th>
      <td>-87.963600</td>
      <td>0.0</td>
      <td>-60.000000</td>
    </tr>
    <tr>
      <th>5.011872e+07</th>
      <td>-89.963600</td>
      <td>0.0</td>
      <td>-60.000000</td>
    </tr>
    <tr>
      <th>6.309574e+07</th>
      <td>-91.963593</td>
      <td>0.0</td>
      <td>-60.000000</td>
    </tr>
    <tr>
      <th>7.943282e+07</th>
      <td>-93.963593</td>
      <td>0.0</td>
      <td>-60.000000</td>
    </tr>
    <tr>
      <th>1.000000e+08</th>
      <td>-95.963593</td>
      <td>0.0</td>
      <td>-60.000000</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 3 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="making-a-complex-representation-plotting-templet">
<h3>Making a complex representation plotting templet¶<a class="headerlink" href="#making-a-complex-representation-plotting-templet" title="Permalink to this headline">¶</a></h3>
<p>Here we are going to make a class the store plot templets for the 3+1 major representations of complex values:</p>
<ul class="simple">
<li><p>Bode Plot with Magnitude and Phase on the same plot: The Bode plot is the most widely used plot of complex data that is parametric to the frequency which we use as the x-axis. This is one of two standard variations of the Bode plot where the Magnitude and Phase is plotted on the same graph using twin axis</p></li>
<li><p>Bode Plot with Magnitude and Phase on the separate plots: In this version of the Bode plot the x-axis is still the frequency and there are two subplots sharing the same x-axis with the top plot being the magnitude plot and the bottom being the phase</p></li>
<li><p>Nichols Plot: This is a parametric plot where the x-axis and the phase and the y-axis is the magnitude and direction is indicated by an arrow along the line showing the direction of frequency increase. This plot is used more in Feedback and Control system design.</p></li>
<li><p>Nyquist Plot: This is a parametric plot where the x-axis and the real part and the y-axis is the imaginary part and direction is indicated by an arrow along the line showing the direction of frequency increase. This plot is used more in Feedback and Control system design.</p></li>
</ul>
<p>This class contains templets since an existing matplotlib axis can be passed through them to then include them in more advanced plots with additional information being able to be added to the axis. Or these plot methods can be called without any axis passed to them to then generate a basic plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 eecomplex_plot_templets class</span>
<span class="c1">#class that stores templets plots for most common complex rep plots</span>

<span class="k">class</span> <span class="nc">eecomplex_plot_templets</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that stores basic/common Electrical Engineering Complex value</span>
<span class="sd">    representation plots that may be used stand-alone or as templets in other plots </span>
<span class="sd">    with refinements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">bode_plot_one_templet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_data</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">,</span> <span class="n">phase_data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Templet plot to make a Bode plot with Magnitude and Phase all in one</span>
<span class="sd">        graph using a twinx. </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            freq_data (numpy array or pandas series; Hz): the sampling frequency</span>
<span class="sd">            </span>
<span class="sd">            mag_data (numpy array or pandas seres; dB): the magnitude data in decibels</span>
<span class="sd">            </span>
<span class="sd">            phase_data (numpy array or pandas series; deg unwrapped): the phase data in degrees unwrapped</span>
<span class="sd">            </span>
<span class="sd">            ax (matplotlib axis; None): If left None will create a new plot, else must</span>
<span class="sd">                be a matplotlib subplot axis to be added to</span>
<span class="sd">            </span>
<span class="sd">            title (str; &#39;&#39;): Subplot title string</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns a bode plot, and if an axis was passed to `ax` will be modified</span>
<span class="sd">            with how to plot the magnitude</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - figure out how to return the `ax_phase` generated internally</span>
<span class="sd">            - add x,y scale control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">mag_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">phase_data</span><span class="p">),</span> <span class="s1">&#39;freq_data, mag_data, phase_data, must all be the same length&#39;</span>
        
        <span class="k">if</span> <span class="n">ax</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;matplotlib.axes._subplots.AxesSubplot&#39;&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;ax must be a matplotlib axis&#39;</span>

        <span class="n">ax_mag</span><span class="o">=</span><span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>


        <span class="c1">#fig, ax_mag=plt.subplots()</span>

        <span class="n">ax_phase</span><span class="o">=</span><span class="n">ax_mag</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="n">ax_mag</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">freq_data</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">freq_data</span><span class="p">,</span> <span class="n">phase_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
        

        <span class="n">ax_mag</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequancy [Hz]&#39;</span><span class="p">)</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[dB]&#39;</span><span class="p">)</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[deg]&#39;</span><span class="p">)</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="c1">#make a single legend </span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax_mag</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">(),</span> <span class="n">ax_phase</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">())]</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39; of &#39;</span><span class="o">+</span><span class="n">title</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bode Plot</span><span class="si">{title}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        
        
    <span class="k">def</span> <span class="nf">bode_plot_two_templet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_data</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">,</span> <span class="n">phase_data</span><span class="p">,</span> 
                              <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Templet plot to make a Bode plot with Magnitude and Phase in two separate subplots</span>
<span class="sd">        with shared x-axis</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            freq_data (numpy array or pandas series; Hz): the sampling frequency</span>
<span class="sd">            </span>
<span class="sd">            mag_data (numpy array or pandas seres; dB): the magnitude data in decibels</span>
<span class="sd">            </span>
<span class="sd">            phase_data (numpy array or pandas series; deg unwrapped): the phase data in degrees unwrapped</span>
<span class="sd">            </span>
<span class="sd">            axs (list of matplotlib axis; None): If left None will create a new plot, else must </span>
<span class="sd">                be a list of matplotlib subplots axis to be added to where the first entry</span>
<span class="sd">                will be the magnitude axis, and the second will be the phase axis</span>
<span class="sd">            </span>
<span class="sd">            title (str; &#39;&#39;): Subplot title string</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns a bode plot, and if an axis was passed to `ax` will be modified</span>
<span class="sd">            with how to plot the magnitude</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - add x,y scale control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">mag_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">phase_data</span><span class="p">),</span> <span class="s1">&#39;freq_data, mag_data, phase_data, must all be the same length&#39;</span>
        
       
        <span class="k">if</span> <span class="n">axs</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_phase</span><span class="p">]</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;there should only be two elements in axs&#39;</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;matplotlib.axes._subplots.AxesSubplot&#39;&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;element </span><span class="si">{i}</span><span class="s2"> in axs was not a matplotlib axis&quot;</span>
            <span class="n">ax_mag</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">ax_phase</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax_mag</span><span class="o">.</span><span class="n">get_shared_x_axes</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_phase</span><span class="p">)</span>
        
        <span class="c1">#fore the two axes to share x</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>




        <span class="n">ax_mag</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">freq_data</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">freq_data</span><span class="p">,</span> <span class="n">phase_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>



        <span class="n">ax_mag</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[dB]&#39;</span><span class="p">)</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[deg]&#39;</span><span class="p">)</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="c1">#style the x-axis for both subplots so it&#39;s between the two</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequancy [Hz]&#39;</span><span class="p">)</span>
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span> 
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span> 
        <span class="n">ax_phase</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39; of &#39;</span><span class="o">+</span><span class="n">title</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bode Plot</span><span class="si">{title}</span><span class="s1">&#39;</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    
    <span class="k">def</span> <span class="nf">nichols_plot_templet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">,</span> <span class="n">phase_data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Templet plot to make a Nichols plot with magnitude in the y-axis and</span>
<span class="sd">        phase in the x-axis, with a counter arrow showing the parametric direction</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            </span>
<span class="sd">            mag_data (numpy array or pandas seres; dB): the magnitude data in decibels</span>
<span class="sd">            </span>
<span class="sd">            phase_data (numpy array or pandas series; deg unwrapped): the phase data in degrees unwrapped</span>
<span class="sd">            </span>
<span class="sd">            ax (matplotlib axis; None): If left None will create a new plot, else must</span>
<span class="sd">                be a matplotlib subplot axis to be added to</span>
<span class="sd">            </span>
<span class="sd">            title (str; &#39;&#39;): Subplot title string</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns a Nichols plot, and if an axis was passed to `ax` will be modified</span>
<span class="sd">            with the Nichols plot</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - add x,y scale control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mag_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">phase_data</span><span class="p">),</span> <span class="s1">&#39;mag_data and phase_data, must all be the same length&#39;</span>

        <span class="k">if</span> <span class="n">ax</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;matplotlib.axes._subplots.AxesSubplot&#39;&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;ax must be a matplotlib axis&#39;</span>

        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phase_data</span><span class="p">,</span> <span class="n">mag_data</span><span class="p">)</span>
        <span class="n">line</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">eecomplex_plot_templets</span><span class="o">.</span><span class="n">add_arrow</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        
        <span class="c1">#xlim</span>
        <span class="n">xmin</span><span class="o">=</span><span class="n">phase_data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="n">phase_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span>
        
        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmax</span><span class="o">&lt;</span><span class="n">xmin</span><span class="p">:</span>
            <span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmax</span>
        
        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmin</span><span class="o">&gt;</span><span class="n">xmax</span><span class="p">:</span>
            <span class="n">xmax</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmin</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;[deg]&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[dB]&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="c1">#ax.axhline(0, linestyle=&#39;--&#39;, linewidth=2.0, color=&#39;black&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39; of &#39;</span><span class="o">+</span><span class="n">title</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nichols Plot</span><span class="si">{title}</span><span class="s1">&#39;</span><span class="p">);</span>
        

    <span class="k">def</span> <span class="nf">nyquist_plot_templet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_data</span><span class="p">,</span> <span class="n">imag_data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Templet plot to make a Nyquist plot with imaginary in the y-axis and</span>
<span class="sd">        real in the x-axis, with a counter arrow showing the parametric direction</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            </span>
<span class="sd">            real_data (numpy array or pandas series): the real data </span>
<span class="sd">            </span>
<span class="sd">            imag_data (numpy array or pandas series): the imaginary data</span>
<span class="sd">            </span>
<span class="sd">            ax (matplotlib axis; None): If left None will create a new plot, else must</span>
<span class="sd">                be a matplotlib subplot axis to be added to</span>
<span class="sd">            </span>
<span class="sd">            title (str; &#39;&#39;): Subplot title string</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns a Nyquist plot, and if an axis was passed to `ax` will be modified</span>
<span class="sd">            with the Nyquist plot</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - add x,y scale control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_data</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">imag_data</span><span class="p">),</span> <span class="s1">&#39;real_data and imag_data, must all be the same length&#39;</span>

        <span class="k">if</span> <span class="n">ax</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;matplotlib.axes._subplots.AxesSubplot&#39;&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;ax must be a matplotlib axis&#39;</span>

        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">imag_data</span><span class="p">)</span>
        <span class="n">line</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">eecomplex_plot_templets</span><span class="o">.</span><span class="n">add_arrow</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="c1">#xlim</span>
        <span class="n">xmin</span><span class="o">=</span><span class="n">real_data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="n">real_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span>

        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmax</span><span class="o">&lt;</span><span class="n">xmin</span><span class="p">:</span>
            <span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmax</span>
        
        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmin</span><span class="o">&gt;</span><span class="n">xmax</span><span class="p">:</span>
            <span class="n">xmax</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">xmin</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>

        <span class="c1">#ylim</span>
        <span class="n">ymin</span><span class="o">=</span><span class="n">imag_data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span><span class="p">;</span> <span class="n">ymax</span><span class="o">=</span><span class="n">imag_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span>

        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">ymax</span><span class="o">&lt;</span><span class="n">ymin</span><span class="p">:</span>
            <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">ymax</span>
        
        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">ymin</span><span class="o">&gt;</span><span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">ymin</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39; of &#39;</span><span class="o">+</span><span class="n">title</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nyquist Plot</span><span class="si">{title}</span><span class="s1">&#39;</span><span class="p">);</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_arrow</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_positions</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add an arrow to a line axis in the direction of the parametric data.</span>

<span class="sd">        line:       Line2D object</span>
<span class="sd">        positions:   list or array of index positions to draw an arrow(s) at; if None will draw at least one arrow</span>
<span class="sd">        num_positions: int; then number arrows to draw along the length of the line; if 1 will draw at the mean</span>
<span class="sd">        direction:  &#39;left&#39; or &#39;right&#39;</span>
<span class="sd">        size: the size of the arrow in font-size points</span>
<span class="sd">        color:      if None, line color is taken.</span>

<span class="sd">        from: https://stackoverflow.com/questions/34017866/arrow-on-a-line-plot-with-matplotlib</span>
<span class="sd">        and also use:https://stackoverflow.com/questions/52042183/matplotlib-get-color-for-subplot</span>

<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#if color is None:</span>
        <span class="c1">#    color = line.get_color()</span>

        <span class="n">xdata</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
        <span class="n">ydata</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
        
        
        <span class="k">if</span> <span class="p">(</span><span class="n">positions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_positions</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">positions</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">positions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_positions</span><span class="o">!=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">line_len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_positions</span><span class="o">&gt;=</span><span class="n">line_len</span><span class="p">:</span>
                <span class="n">num_positions</span><span class="o">==</span><span class="n">line_len</span>
            <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">xdata</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">line_len</span><span class="o">/</span><span class="n">num_positions</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_positions</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">),</span> <span class="s1">&#39;positions must be int index positions&#39;</span>
        
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
            <span class="c1"># find the closest index</span>
            <span class="n">start_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">xdata</span> <span class="o">-</span> <span class="n">pos</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">end_ind</span> <span class="o">=</span> <span class="n">start_ind</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">end_ind</span> <span class="o">=</span> <span class="n">start_ind</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="n">line</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">start_ind</span><span class="p">],</span> <span class="n">ydata</span><span class="p">[</span><span class="n">start_ind</span><span class="p">]),</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">end_ind</span><span class="p">],</span> <span class="n">ydata</span><span class="p">[</span><span class="n">end_ind</span><span class="p">]),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">),</span>
                <span class="n">size</span><span class="o">=</span><span class="n">size</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we invoke the class and start by creating the single graph Bode plot with twinx axis so that magnitude and phase are overlapping on one plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_p</span><span class="o">=</span><span class="n">eecomplex_plot_templets</span><span class="p">()</span>

<span class="n">ac_p</span><span class="o">.</span><span class="n">bode_plot_one_templet</span><span class="p">(</span><span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_29_0.png" src="../_images/AC_2_RCL_filters_29_0.png" />
</div>
</div>
<p>And here we use the seconed Bode plot method to make the graph with the joined subplots but each subplot has the magnitude and phase respectivly</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_p</span><span class="o">.</span><span class="n">bode_plot_two_templet</span><span class="p">(</span><span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_31_0.png" src="../_images/AC_2_RCL_filters_31_0.png" />
</div>
</div>
<p>Here is the Nichols plot pf out data with parmteriztion arrows showing the direction of increasing frequancy. Note that since that data was aquared logrimgly and the space inside <code class="docutils literal notranslate"><span class="pre">eecomplex_plot_templets.add_arrow</span></code> uses linear supdivsion the spacing on the arrows is going to follow logrithmicly as well</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_p</span><span class="o">.</span><span class="n">nichols_plot_templet</span><span class="p">(</span><span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_33_0.png" src="../_images/AC_2_RCL_filters_33_0.png" />
</div>
</div>
<p>And finally, we create the Nyquist plot again with the same parametricness shown by the arrows and with the same linear to log issue in their spacing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_p</span><span class="o">.</span><span class="n">nyquist_plot_templet</span><span class="p">(</span><span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_real_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">],</span> <span class="n">ac_rep_tool</span><span class="o">.</span><span class="n">ac_sim_imag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_35_0.png" src="../_images/AC_2_RCL_filters_35_0.png" />
</div>
</div>
</div>
<div class="section" id="a-quick-filter-exploration-tool-for-the-rest-of-this-notebook">
<h3>A quick filter exploration tool for the rest of this notebook¶<a class="headerlink" href="#a-quick-filter-exploration-tool-for-the-rest-of-this-notebook" title="Permalink to this headline">¶</a></h3>
<p>Here we create an easy use tool using mutable inheritance of our three ac tools wherein the  <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method it performs the AC simulation, makes the representation transformations, and plot. And in the second method, we get grab the symbolic transfer function for the filter and pass it the same frequencies as the SPICE simulation and plot it on top of the SPICE simulation to examine any mild to gross divergence from the SPICE simulation and the symbolic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 qfilter_explorer class</span>
<span class="c1">#class to perform the anylsis of the filtes in Ch2 sec 2</span>

<span class="k">class</span> <span class="nc">qfilter_explorer</span><span class="p">(</span><span class="n">ac_ease</span><span class="p">,</span> <span class="n">ac_representation_tool</span><span class="p">,</span> <span class="n">eecomplex_plot_templets</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">circ</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">start_freq</span><span class="o">=.</span><span class="mi">1</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_freq</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_GHz</span><span class="p">):</span>
        
        <span class="c1">#do what ac_ease is supposed to do at startup</span>
        <span class="c1">#instainte the simulation from the circuit</span>
        <span class="n">ac_ease</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">circ</span><span class="p">)</span>
        <span class="c1">#setup the simulation parameter with the helper method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_sweep_setup</span><span class="p">(</span><span class="n">start_freq</span><span class="p">,</span> <span class="n">stop_freq</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;decade&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1">#do the simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_ac_sim</span><span class="p">()</span>
        
        
        <span class="c1">#do what ac_representation_tool is supposed to do at startup</span>
        <span class="c1">#and pass in the selfs from `ac_ease`&#39;s ac_resultsNB_DF</span>
        <span class="n">ac_representation_tool</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="p">)</span>
        <span class="c1">#generate the representations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_real_imag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_mag_phase</span><span class="p">()</span>
        
        
        <span class="n">eecomplex_plot_templets</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">ax_bode</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bode_plot_one_templet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_bode</span><span class="p">)</span>

        <span class="n">ax_nichols</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nichols_plot_templet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nichols</span><span class="p">)</span>

        <span class="n">ax_nyquist</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nyquist_plot_templet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_real_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_imag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out_[V]&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nyquist</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">symbolic_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
        
        <span class="c1">#get the tf and get the data</span>
        <span class="n">tf</span><span class="o">=</span><span class="n">filter_obj</span><span class="o">.</span><span class="n">get_tf</span><span class="p">()</span>
        <span class="n">symbolic_data</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">frequency_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][dB]&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">symbolic_data</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">symbolic_data</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_ph</span><span class="p">]</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bode_plot_two_templet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Simulated vs Symbolic Out_[V]&#39;</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="p">[</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_ph</span><span class="p">])</span>
        
        <span class="c1">#add the symbolic data</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][dB]&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span> <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;symbolic&#39;</span><span class="p">)</span>
        <span class="n">ax_mag</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
        <span class="n">ax_ph</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][deg]&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span> <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;symbolic&#39;</span><span class="p">)</span>
        <span class="n">ax_ph</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RC Low Pass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_38_1.png" src="../_images/AC_2_RCL_filters_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">lowpassF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_39_0.png" src="../_images/AC_2_RCL_filters_39_0.png" />
</div>
</div>
<p>##Equivalent Low Pass RL filter</p>
<p>Besides RC filters, there are of course RL dual filters. Where the equivalent RL filter values to any RC filter may be found via the equivalent time constant of the RC and RL implementation such that time constants must match ie: $<span class="math notranslate nohighlight">\(RC=\tau_{RC}=\tau_{RL}=L/R\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rl_lowpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RL lowpass filter</span>

<span class="k">class</span> <span class="nc">rl_lowpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    lowpass RL filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_H; Henery): the inductance in henrys for the RL inductive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RL resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RL_Lowpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RL lowpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">term_1</span>
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 0_1 2_1; right, l=L{str(self.L_value)}&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 2_1 1_1; down, l=R{str(self.R_value)}&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rl_lowpass filter to </span>
<span class="n">rl_l</span><span class="o">=</span><span class="n">rl_lowpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="p">(</span><span class="mf">1e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*.</span><span class="mf">1e-9</span> <span class="nd">@u_H</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
<span class="n">rl_l</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_42_0.png" src="../_images/AC_2_RCL_filters_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">rl_l</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{R}{L \left(s + \frac{R}{L}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">rl_l</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{10000000}{s + 10000000}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">rl_l</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
L1 In Out 0.0001H
R1 Out 0 1000.0
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RL Low Pass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_46_1.png" src="../_images/AC_2_RCL_filters_46_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">rl_l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_47_0.png" src="../_images/AC_2_RCL_filters_47_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="the-high-pass-filter-from-all-about-electronics-rc-high-pass-filter-explained-7-57min">
<h2>The high pass filter from ALL ABOUT ELECTRONICS “RC High Pass Filter Explained” &#64;~ 7:57min<a class="headerlink" href="#the-high-pass-filter-from-all-about-electronics-rc-high-pass-filter-explained-7-57min" title="Permalink to this headline">¶</a></h2>
<p>As we saw with the RC and RL “Lowpass” filters they are named by the typical convention of how there implemented followed by some characteristic description of their magnitude response. Thus, lowpass filters minimally attenuate any single whose frequency content is less than the frequency of their 3dB knee. Whereas Highpass filters are the complement to that where they will highly attenuate any single whose frequency content is less than there 3dB knee as shown below using the example from ALL ABOUT ELELECTROINC YT video on “RC High Pass Filters”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;9Dx0b0ukNAM&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">477</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/9Dx0b0ukNAM?start=477"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rc_highpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RC highpass filter</span>

<span class="k">class</span> <span class="nc">rc_highpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    highpass RC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RC_highpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RC highpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">term_1</span>
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;C 0_1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R 2_1 1_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
            
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">highpassF</span><span class="o">=</span><span class="n">rc_highpass</span><span class="p">(</span><span class="n">C_value</span><span class="o">=</span><span class="mf">1.5</span><span class="nd">@u_nF</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_kOhm</span><span class="p">)</span>
<span class="n">highpassF</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_51_0.png" src="../_images/AC_2_RCL_filters_51_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">highpassF</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s}{s + \frac{1}{C R}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">highpassF</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s}{s + \frac{200000}{3}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">highpassF</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 In Out 1.5nF
R1 Out 0 10kOhm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RC High Pass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_55_1.png" src="../_images/AC_2_RCL_filters_55_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">highpassF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_56_0.png" src="../_images/AC_2_RCL_filters_56_0.png" />
</div>
</div>
</div>
<div class="section" id="rl-highpass">
<h2>RL Highpass<a class="headerlink" href="#rl-highpass" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rl_highpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RL highpass filter</span>

<span class="k">class</span> <span class="nc">rl_highpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    highpass RL filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RL inductive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RL resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RL_highpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RL highpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 0_1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 2_1 1_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
        
            
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rl_h</span><span class="o">=</span><span class="n">rl_highpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="p">(</span><span class="mf">10e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span><span class="mf">1.5e-9</span> <span class="nd">@u_H</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_kOhm</span><span class="p">)</span>
<span class="n">rl_h</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_59_0.png" src="../_images/AC_2_RCL_filters_59_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">rl_h</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s}{s + \frac{R}{L}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">rl_h</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s}{s + \frac{200000}{3}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">rl_h</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
L1 Out 0 0.15H
R1 In Out 10kOhm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RL High Pass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_63_1.png" src="../_images/AC_2_RCL_filters_63_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">rl_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_64_0.png" src="../_images/AC_2_RCL_filters_64_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="first-order-cascade-filter">
<h1>First Order Cascade filter<a class="headerlink" href="#first-order-cascade-filter" title="Permalink to this headline">¶</a></h1>
<p>Though as we will see there are more complex single filter designs that can implement a needed filter profile the other way to implement the needed filter profile is by cascading primitive filter sections as shown by ALL ABOUT ELELECTOINCS where here we will just implement the passive version of the cascaded bandpass filter shown below.</p>
<div class="section" id="the-band-pass-filter-from-all-about-electronics-band-pass-filter-and-band-stop-filter-explained-4-03min">
<h2>The band pass filter from ALL ABOUT ELECTRONICS “Band Pass Filter and Band Stop Filter Explained” &#64;~ 4:03min<a class="headerlink" href="#the-band-pass-filter-from-all-about-electronics-band-pass-filter-and-band-stop-filter-explained-4-03min" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;dmPIydL0lyM&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">243</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/dmPIydL0lyM?start=243"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_inter</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Inter&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">)</span>

<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_V</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_kHz</span><span class="p">)</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="n">highpassFsection</span><span class="o">=</span><span class="n">rc_highpass</span><span class="p">(</span><span class="n">C_value</span><span class="o">=</span><span class="mf">1.5</span><span class="nd">@u_nF</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_kOhm</span><span class="p">)</span>
<span class="n">highpassFsection</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_inter</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">lowpassFsection</span><span class="o">=</span><span class="n">rc_lowpass</span><span class="p">(</span><span class="n">C_value</span><span class="o">=</span><span class="mf">1.5</span><span class="nd">@u_nF</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_kOhm</span><span class="p">)</span>
<span class="n">lowpassFsection</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_inter</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>


<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 In Inter 1.5nF
C2 Out 0 1.5nF
R1 Inter 0 10kOhm
R2 Inter Out 1kOhm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 10V 10kHz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RC Band pass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_70_1.png" src="../_images/AC_2_RCL_filters_70_1.png" />
</div>
</div>
<p>Becouse this is a cascaded filter to get the symbolic filter we need to casade them where for a recap of how to cascade filters in all the varies toplogies see https://x-engineer.org/graduate-engineering/signals-systems/control-systems/transfer-function-algebra/</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cascade_tf</span><span class="o">=</span><span class="n">highpassFsection</span><span class="o">.</span><span class="n">get_tf</span><span class="p">()</span> <span class="o">*</span> <span class="n">lowpassFsection</span><span class="o">.</span><span class="n">get_tf</span><span class="p">()</span> 
<span class="n">sym</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">cascade_tf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{2000000 s}{3 \left(s + \frac{200000}{3}\right) \left(s + \frac{2000000}{3}\right)}\]</div>
</div>
</div>
<p>And so for the sake of simplicity we will just reimpliment <code class="docutils literal notranslate"><span class="pre">qfilter_explorer.symbolic_tf</span></code> manulay here to compare the casdacded symbolic trnasfer fuction to the SPICE simulated results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symbolic_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">filter_responce</span><span class="o">.</span><span class="n">ac_resultsNB_DF</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="n">symbolic_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="c1">##bring the f through the sausage filter</span>
<span class="n">symbolic_data_raw</span><span class="o">=</span><span class="n">cascade_tf</span><span class="o">.</span><span class="n">frequency_response</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>

<span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][dB]&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">symbolic_data_raw</span><span class="p">))</span>
<span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">symbolic_data_raw</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_ph</span><span class="p">]</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">acplot</span><span class="o">=</span><span class="n">eecomplex_plot_templets</span><span class="p">()</span>
<span class="n">acplot</span><span class="o">.</span><span class="n">bode_plot_two_templet</span><span class="p">(</span><span class="n">filter_responce</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">filter_responce</span><span class="o">.</span><span class="n">ac_sim_mag_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][dB]&#39;</span><span class="p">],</span> <span class="n">filter_responce</span><span class="o">.</span><span class="n">ac_sim_phase_DF</span><span class="p">[</span><span class="s1">&#39;Out_[V][deg]&#39;</span><span class="p">],</span> 
                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Simulated vs Symbolic Out_[V]&#39;</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="p">[</span><span class="n">ax_mag</span><span class="p">,</span> <span class="n">ax_ph</span><span class="p">])</span>

<span class="c1">#add the symbolic data</span>
<span class="n">ax_mag</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][dB]&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span> <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;symbolic&#39;</span><span class="p">)</span>
<span class="n">ax_mag</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax_ph</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">symbolic_data</span><span class="p">[</span><span class="s1">&#39;Out_sym_[V][deg]&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span> <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;symbolic&#39;</span><span class="p">)</span>
<span class="n">ax_ph</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_74_0.png" src="../_images/AC_2_RCL_filters_74_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="second-order-filters-and-resonators">
<h1>Second-Order Filters and resonators<a class="headerlink" href="#second-order-filters-and-resonators" title="Permalink to this headline">¶</a></h1>
<p>Second-order filters are mostly designed around the following equations in their circuit implementation</p>
<ul>
<li><p>Bandwidth (<span class="math notranslate nohighlight">\(B\)</span>):<span class="math notranslate nohighlight">\(B=\omega_2-\omega_1\)</span></p></li>
<li><p>Center Frequncy (<span class="math notranslate nohighlight">\(\omega_0\)</span>): <span class="math notranslate nohighlight">\(\omega_0=\dfrac{1}{\sqrt{LC}}=\sqrt{\omega_1 \omega_2}\)</span></p></li>
<li><p>The Q Factor in general: <span class="math notranslate nohighlight">\(Q=\dfrac{\omega_0}{B}\)</span></p>
<ul class="simple">
<li><p>Q for a series RLC is: <span class="math notranslate nohighlight">\(Q=\dfrac{1}{\omega_0 RC}\)</span></p></li>
<li><p>Q for a parrel RLC is: <span class="math notranslate nohighlight">\(Q=\omega_0 RC\)</span></p></li>
</ul>
<p>And are called second-order since with having both a Capacitor and Inductor the differential equations in the time domain become second order. Below we will implement the four main second-order filter types: Lowpass, Highpass, Bandpass, Bandstop, in both their series and parral configurations. Where the templet around the values for the RLC elements used for these filters is the bandwidth frequencies of the ALL ABOUT CIRCUITS example of a passive cascaded filter above using a 50Ohm resistor, because.</p>
</li>
</ul>
<div class="section" id="series-based">
<h2>Series Based¶<a class="headerlink" href="#series-based" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_out</span><span class="p">,</span> <span class="n">V_in</span><span class="p">,</span> <span class="n">angfreq_1</span><span class="p">,</span> <span class="n">angfreq_2</span><span class="p">,</span> <span class="n">angfreq_0</span><span class="p">,</span> <span class="n">R_sym</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">,</span> <span class="n">Q_sym</span><span class="p">,</span> <span class="n">f_sym</span><span class="p">,</span> <span class="n">f0_sym</span><span class="p">,</span> <span class="n">B_sym</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V_</span><span class="si">{out}</span><span class="s1">, V_</span><span class="si">{in}</span><span class="s1">, omega_1, omega_2, omega_0, R, C, L, Q, f, f_0, B&#39;</span> <span class="p">)</span>
<span class="n">V_out</span><span class="p">,</span> <span class="n">V_in</span><span class="p">,</span> <span class="n">angfreq_1</span><span class="p">,</span> <span class="n">angfreq_2</span><span class="p">,</span> <span class="n">angfreq_0</span><span class="p">,</span> <span class="n">R_sym</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">,</span> <span class="n">Q_sym</span><span class="p">,</span> <span class="n">f_sym</span><span class="p">,</span> <span class="n">f0_sym</span><span class="p">,</span> <span class="n">B_sym</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_77_0.png" src="../_images/AC_2_RCL_filters_77_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span><span class="o">=</span><span class="mf">10.61e3</span><span class="p">;</span> <span class="n">f2</span><span class="o">=</span><span class="mf">106.1e3</span>
<span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">R_sym</span><span class="p">:</span><span class="mi">50</span><span class="p">}</span>
<span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span> <span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span>
<span class="n">subs</span><span class="p">[</span><span class="n">angfreq_0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span><span class="o">*</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">])</span>
<span class="n">subs</span><span class="p">[</span><span class="n">B_sym</span><span class="p">]</span><span class="o">=</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">]</span><span class="o">-</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span>
<span class="n">subs</span><span class="p">[</span><span class="n">Q_sym</span><span class="p">]</span><span class="o">=</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_0</span><span class="p">]</span><span class="o">/</span><span class="n">subs</span><span class="p">[</span><span class="n">B_sym</span><span class="p">]</span>
<span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_78_0.png" src="../_images/AC_2_RCL_filters_78_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qs_eq</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">Q_sym</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">angfreq_0</span><span class="o">*</span><span class="n">R_sym</span><span class="o">*</span><span class="n">C_sym</span><span class="p">));</span> <span class="n">Qs_eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_79_0.png" src="../_images/AC_2_RCL_filters_79_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span><span class="p">[</span><span class="n">C_sym</span><span class="p">]</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Qs_eq</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs</span><span class="p">);</span> <span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_80_0.png" src="../_images/AC_2_RCL_filters_80_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angfreq_0_eq</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">angfreq_0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L_sym</span><span class="o">*</span><span class="n">C_sym</span><span class="p">));</span> <span class="n">angfreq_0_eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_81_0.png" src="../_images/AC_2_RCL_filters_81_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span><span class="p">[</span><span class="n">L_sym</span><span class="p">]</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">angfreq_0_eq</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs</span><span class="p">);</span> <span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_82_0.png" src="../_images/AC_2_RCL_filters_82_0.png" />
</div>
</div>
<div class="section" id="rlc-series-lowpass">
<h3>RLC series lowpass<a class="headerlink" href="#rlc-series-lowpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_series_lowpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC series lowpass filter</span>

<span class="k">class</span> <span class="nc">rlc_series_lowpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    lowpass series RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_Lowpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC series lowpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_1</span><span class="p">,</span> <span class="n">term_3</span>
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=3&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R 0_1 N1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;L N1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;C 2_1 1_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_lowpass filter </span>
<span class="n">lowpassRLC_s</span><span class="o">=</span><span class="n">rlc_series_lowpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="mf">8.33e-5</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">2.7e-7</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">lowpassRLC_s</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_85_0.png" src="../_images/AC_2_RCL_filters_85_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">lowpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{1}{C L \left(s + \frac{R}{2 L} - \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right) \left(s + \frac{R}{2 L} + \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">lowpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{1000000000000000}{22491 \left(s - \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right) \left(s + \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">lowpassRLC_s</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 Out 0 2.7e-07
L1 N_1 Out 8.33e-05H
R1 In N_1 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Series Lowpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_89_1.png" src="../_images/AC_2_RCL_filters_89_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">lowpassRLC_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_90_0.png" src="../_images/AC_2_RCL_filters_90_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-series-highpass">
<h3>RLC series highpass<a class="headerlink" href="#rlc-series-highpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_series_highpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC series highpass filter</span>

<span class="k">class</span> <span class="nc">rlc_series_highpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    highpass series RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_highpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC series highpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_1</span><span class="p">,</span> <span class="n">term_3</span>
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=3&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 0_1 N1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C N1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 2_1 1_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_highpass filter  </span>
<span class="n">highpassRLC_s</span><span class="o">=</span><span class="n">rlc_series_highpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="mf">8.33e-5</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">2.7e-7</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">highpassRLC_s</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_93_0.png" src="../_images/AC_2_RCL_filters_93_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">highpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s^{2}}{\left(s + \frac{R}{2 L} - \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right) \left(s + \frac{R}{2 L} + \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">highpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s^{2}}{\left(s - \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right) \left(s + \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">highpassRLC_s</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 N_1 Out 2.7e-07
L1 Out 0 8.33e-05H
R1 In N_1 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Series Lowpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_97_1.png" src="../_images/AC_2_RCL_filters_97_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">highpassRLC_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_98_0.png" src="../_images/AC_2_RCL_filters_98_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-series-bandpass">
<h3>RLC series bandpass<a class="headerlink" href="#rlc-series-bandpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_series_bandpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC series bandpass filter</span>

<span class="k">class</span> <span class="nc">rlc_series_bandpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    bandpass series RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_bandpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC series bandpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_1</span><span class="p">,</span> <span class="n">term_3</span>
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=3&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 0_1 N1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C N1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 2_1 1_1; down&#39;</span><span class="p">)</span>
        
       
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_bandpass filter  </span>
<span class="n">bandpassRLC_s</span><span class="o">=</span><span class="n">rlc_series_bandpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="mf">8.33e-5</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">2.7e-7</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">bandpassRLC_s</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_101_0.png" src="../_images/AC_2_RCL_filters_101_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">bandpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{R s}{L \left(s + \frac{R}{2 L} - \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right) \left(s + \frac{R}{2 L} + \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">bandpassRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{500000000 s}{833 \left(s - \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right) \left(s + \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">bandpassRLC_s</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 N_1 Out 2.7e-07
L1 In N_1 8.33e-05H
R1 Out 0 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Series Bandpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_105_1.png" src="../_images/AC_2_RCL_filters_105_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">bandpassRLC_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_106_0.png" src="../_images/AC_2_RCL_filters_106_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-series-bandstop">
<h3>RLC series bandstop<a class="headerlink" href="#rlc-series-bandstop" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_series_bandstop filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC series bandstop filter</span>

<span class="k">class</span> <span class="nc">rlc_series_bandstop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    bandstop series RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_bandstop - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC series bandstop filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_1</span><span class="p">,</span> <span class="n">term_3</span>
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 0_1 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 2_1 N1; down&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C N1 1_1; down&#39;</span><span class="p">)</span>
        
       
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_bandstop filter</span>
<span class="n">bandstopRLC_s</span><span class="o">=</span><span class="n">rlc_series_bandstop</span><span class="p">(</span><span class="n">L_value</span><span class="o">=</span><span class="mf">8.33e-5</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">2.7e-7</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">bandstopRLC_s</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_109_0.png" src="../_images/AC_2_RCL_filters_109_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">bandstopRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{\left(s - \frac{\mathrm{j}}{\sqrt{C} \sqrt{L}}\right) \left(s + \frac{\mathrm{j}}{\sqrt{C} \sqrt{L}}\right)}{\left(s + \frac{R}{2 L} - \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right) \left(s + \frac{R}{2 L} + \frac{\sqrt{C R^{2} - 4 L}}{2 \sqrt{C} L}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">bandstopRLC_s</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{\left(s - \frac{10000000 \sqrt{510} \mathrm{j}}{1071}\right) \left(s + \frac{10000000 \sqrt{510} \mathrm{j}}{1071}\right)}{\left(s - \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right) \left(s + \frac{10000000 \sqrt{25635}}{7497} + \frac{250000000}{833}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">bandstopRLC_s</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 N_1 0 2.7e-07
L1 Out N_1 8.33e-05H
R1 In Out 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Series Bandstop Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_113_1.png" src="../_images/AC_2_RCL_filters_113_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">bandstopRLC_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_114_0.png" src="../_images/AC_2_RCL_filters_114_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="parallel-based">
<h2>Parallel Based¶<a class="headerlink" href="#parallel-based" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_out</span><span class="p">,</span> <span class="n">V_in</span><span class="p">,</span> <span class="n">angfreq_1</span><span class="p">,</span> <span class="n">angfreq_2</span><span class="p">,</span> <span class="n">angfreq_0</span><span class="p">,</span> <span class="n">R_sym</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">,</span> <span class="n">Q_sym</span><span class="p">,</span> <span class="n">f_sym</span><span class="p">,</span> <span class="n">f0_sym</span><span class="p">,</span> <span class="n">B_sym</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V_</span><span class="si">{out}</span><span class="s1">, V_</span><span class="si">{in}</span><span class="s1">, omega_1, omega_2, omega_0, R, C, L, Q, f, f_0, B&#39;</span> <span class="p">)</span>
<span class="n">V_out</span><span class="p">,</span> <span class="n">V_in</span><span class="p">,</span> <span class="n">angfreq_1</span><span class="p">,</span> <span class="n">angfreq_2</span><span class="p">,</span> <span class="n">angfreq_0</span><span class="p">,</span> <span class="n">R_sym</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">,</span> <span class="n">Q_sym</span><span class="p">,</span> <span class="n">f_sym</span><span class="p">,</span> <span class="n">f0_sym</span><span class="p">,</span> <span class="n">B_sym</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_116_0.png" src="../_images/AC_2_RCL_filters_116_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span><span class="o">=</span><span class="mf">10.61e3</span><span class="p">;</span> <span class="n">f2</span><span class="o">=</span><span class="mf">106.1e3</span>
<span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">R_sym</span><span class="p">:</span><span class="mi">50</span><span class="p">}</span>
<span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span> <span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span>
<span class="n">subs</span><span class="p">[</span><span class="n">angfreq_0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span><span class="o">*</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">])</span>
<span class="n">subs</span><span class="p">[</span><span class="n">B_sym</span><span class="p">]</span><span class="o">=</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_2</span><span class="p">]</span><span class="o">-</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_1</span><span class="p">]</span>
<span class="n">subs</span><span class="p">[</span><span class="n">Q_sym</span><span class="p">]</span><span class="o">=</span><span class="n">subs</span><span class="p">[</span><span class="n">angfreq_0</span><span class="p">]</span><span class="o">/</span><span class="n">subs</span><span class="p">[</span><span class="n">B_sym</span><span class="p">]</span>
<span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_117_0.png" src="../_images/AC_2_RCL_filters_117_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qp_eq</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">Q_sym</span><span class="p">,</span> <span class="n">angfreq_0</span><span class="o">*</span><span class="n">R_sym</span><span class="o">*</span><span class="n">C_sym</span><span class="p">);</span> <span class="n">Qp_eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_118_0.png" src="../_images/AC_2_RCL_filters_118_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span><span class="p">[</span><span class="n">C_sym</span><span class="p">]</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Qp_eq</span><span class="p">,</span> <span class="n">C_sym</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs</span><span class="p">);</span> <span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_119_0.png" src="../_images/AC_2_RCL_filters_119_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angfreq_0_eq</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">angfreq_0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L_sym</span><span class="o">*</span><span class="n">C_sym</span><span class="p">));</span> <span class="n">angfreq_0_eq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_120_0.png" src="../_images/AC_2_RCL_filters_120_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span><span class="p">[</span><span class="n">L_sym</span><span class="p">]</span><span class="o">=</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">angfreq_0_eq</span><span class="p">,</span> <span class="n">L_sym</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs</span><span class="p">);</span> <span class="n">subs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_121_0.png" src="../_images/AC_2_RCL_filters_121_0.png" />
</div>
</div>
<div class="section" id="rlc-parallel-lowpass">
<h3>RLC parallel lowpass<a class="headerlink" href="#rlc-parallel-lowpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_parallel_lowpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC parallel lowpass filter</span>

<span class="k">class</span> <span class="nc">rlc_parallel_lowpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    lowpass parallel RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_Lowpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC parallel lowpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 0_1 2_2; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C 2_2 1_1; down&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_2 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 2_1 3_1; down&#39;</span><span class="p">)</span>

       
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_lowpass filter  </span>
<span class="n">lowpassRLC_p</span><span class="o">=</span><span class="n">rlc_parallel_lowpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=.</span><span class="mi">0006750</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">3.33e-8</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">lowpassRLC_p</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_124_0.png" src="../_images/AC_2_RCL_filters_124_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">lowpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{1}{C L \left(s + \frac{1}{2 C R} - \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right) \left(s + \frac{1}{2 C R} + \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">lowpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{400000000000000}{8991 \left(s - \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right) \left(s + \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">lowpassRLC_p</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 Out 0 3.33e-08
L1 In Out 0.000675H
R1 Out 0 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Parallel Lowpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_128_1.png" src="../_images/AC_2_RCL_filters_128_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">lowpassRLC_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_129_0.png" src="../_images/AC_2_RCL_filters_129_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-parallel-highpass">
<h3>RLC parallel highpass<a class="headerlink" href="#rlc-parallel-highpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_parallel_highpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC parallel highpass filter</span>

<span class="k">class</span> <span class="nc">rlc_parallel_highpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    highpass parallel RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_highpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC parallel highpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C 0_1 2_2; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 2_2 1_1; down&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_2 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 2_1 3_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_highpass filter</span>
<span class="n">highpassRLC_p</span><span class="o">=</span><span class="n">rlc_parallel_highpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=.</span><span class="mi">0006750</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">3.33e-8</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">highpassRLC_p</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_132_0.png" src="../_images/AC_2_RCL_filters_132_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">highpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s^{2}}{\left(s + \frac{1}{2 C R} - \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right) \left(s + \frac{1}{2 C R} + \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">highpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s^{2}}{\left(s - \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right) \left(s + \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">highpassRLC_p</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 In Out 3.33e-08
L1 Out 0 0.000675H
R1 Out 0 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Parallel Highpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_136_1.png" src="../_images/AC_2_RCL_filters_136_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">highpassRLC_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_137_0.png" src="../_images/AC_2_RCL_filters_137_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-parallel-bandpass">
<h3>RLC parallel bandpass<a class="headerlink" href="#rlc-parallel-bandpass" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_parallel_bandpass filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC parallel bandpass filter</span>

<span class="k">class</span> <span class="nc">rlc_parallel_bandpass</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    bandpass parallel RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_bandpass - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC parallel bandpass filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right=2&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 0_1 2_2; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C 2_2 1_1; down&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_2 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 3_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 2_1 3_1; down&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_1 3; right=1.5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rlc_bandpass filter</span>
<span class="n">bandpassRLC_p</span><span class="o">=</span><span class="n">rlc_parallel_bandpass</span><span class="p">(</span><span class="n">L_value</span><span class="o">=.</span><span class="mi">0006750</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">3.33e-8</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">bandpassRLC_p</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_140_0.png" src="../_images/AC_2_RCL_filters_140_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">bandpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{s}{C R \left(s + \frac{1}{2 C R} - \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right) \left(s + \frac{1}{2 C R} + \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">bandpassRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{200000000 s}{333 \left(s - \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right) \left(s + \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">bandpassRLC_p</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 Out 0 3.33e-08
L1 Out 0 0.000675H
R1 In Out 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Parallel Bandpass Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_144_1.png" src="../_images/AC_2_RCL_filters_144_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">bandpassRLC_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_145_0.png" src="../_images/AC_2_RCL_filters_145_0.png" />
</div>
</div>
</div>
<div class="section" id="rlc-parallel-bandstop">
<h3>RLC parallel bandstop<a class="headerlink" href="#rlc-parallel-bandstop" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 rlc_parallel_bandstop filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an RLC parallel bandstop filter</span>

<span class="k">class</span> <span class="nc">rlc_parallel_bandstop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    bandstop parallel RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L_value (float; 1@u_F; Henerys): the inductance in farads for the RLC inductive element</span>
<span class="sd">            C_value (float; 1@u_F; Farads): the capacitance in farads for the RLC capacitive element</span>
<span class="sd">            R_value (float; 1@u_Ohm; Ohms): the resistance in ohms for the RLC resistive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="o">=</span><span class="n">L_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="o">=</span><span class="n">C_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="o">=</span><span class="n">R_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_bandstop - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC parallel bandstop filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;R_</span><span class="si">{self.subcirc_ref}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Cref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">Rref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Lref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Cref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="o">**</span><span class="n">Rref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_0</span><span class="p">,</span> <span class="n">term_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">term_1</span>
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 3_1; right=3.5&#39;</span><span class="p">)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1, 0_2; up=.3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L 0_2 2_3; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_3 2_2; down=.3&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1, 0_3; down=.3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C 0_3 2_4; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_4 2_2; up=.3&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R 2_1 3_1; down&#39;</span><span class="p">)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_2 2_1; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_1 3; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;P2 2 3; down, v=V_o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">R_value</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L_value</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the rc_bandpass filter to </span>
<span class="n">bandstopRLC_p</span><span class="o">=</span><span class="n">rlc_parallel_bandstop</span><span class="p">(</span><span class="n">L_value</span><span class="o">=.</span><span class="mi">0006750</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">C_value</span><span class="o">=</span><span class="mf">3.33e-8</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">R_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">bandstopRLC_p</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_148_0.png" src="../_images/AC_2_RCL_filters_148_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">bandstopRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{\left(s - \frac{\mathrm{j}}{\sqrt{C} \sqrt{L}}\right) \left(s + \frac{\mathrm{j}}{\sqrt{C} \sqrt{L}}\right)}{\left(s + \frac{1}{2 C R} - \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right) \left(s + \frac{1}{2 C R} + \frac{\sqrt{- 4 C R^{2} + L}}{2 C \sqrt{L} R}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">bandstopRLC_p</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{\left(s - \frac{20000000 \sqrt{111} \mathrm{j}}{999}\right) \left(s + \frac{20000000 \sqrt{111} \mathrm{j}}{999}\right)}{\left(s - \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right) \left(s + \frac{20000000 \sqrt{114}}{999} + \frac{100000000}{333}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> 

<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="n">bandstopRLC_p</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">gnd</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 In Out 3.33e-08
L1 In Out 0.000675H
R1 Out 0 50Ohm
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;RLC Parallel Bandstop Filter Responce&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_152_1.png" src="../_images/AC_2_RCL_filters_152_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">bandstopRLC_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_153_0.png" src="../_images/AC_2_RCL_filters_153_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="all-pass-filters">
<h1>All Pass filters<a class="headerlink" href="#all-pass-filters" title="Permalink to this headline">¶</a></h1>
<p>The naming of filters as has been seen is based on the shape of the Bode Magnitude Plot and for the most part, Phase has kind of been a ride along part of the filter design. Stating that, the name for an All-Pass filter is misleading; the better name is a Phase Shaping filter. These Filters ideally do not affect the magnitude of the signal passed through them and instead affect the phase. Here we will look at the lattice All-Pass filter for the low-frequency phase from the following Wikipedia article</p>
<p>https://en.wikipedia.org/wiki/Lattice_phase_equaliser</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section 2 lc_balanced_allpass_lowfreq_lattice_filt filter class</span>
<span class="c1">#class with lcapy and skidl subcircuit to create an lc all-pass filter</span>

<span class="k">class</span> <span class="nc">lc_balanced_allpass_lowfreq_lattice_filt</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SkiDl subcircuit and lcapy schematic of a</span>
<span class="sd">    bandstop parallel RLC filter primitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcirc_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L1_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span> <span class="n">L2_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">,</span>  <span class="n">C1_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">,</span> <span class="n">C2_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            subcirc_ref (str): reference to use for the base of the internal elements</span>
<span class="sd">            L1_value (float; 1@u_F; Henerys): the inductance in farads for the top inductive element</span>
<span class="sd">            L2_value (float; 1@u_F; Henerys): the inductance in farads for the bottom inductive element</span>
<span class="sd">            C1_value (float; 1@u_F; Farads): the capacitance in farads for the term 2 to term 1 capacitive element</span>
<span class="sd">            C2_value (float; 1@u_F; Farads): the capacitance in farads for the term 0 to term 2 capacitive element</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        TODO:</span>
<span class="sd">            -add assertions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#add assertions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">=</span><span class="n">subcirc_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L1_value</span><span class="o">=</span><span class="n">L1_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L2_value</span><span class="o">=</span><span class="n">L2_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C1_value</span><span class="o">=</span><span class="n">C1_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_value</span><span class="o">=</span><span class="n">C2_value</span>
        

    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_0</span><span class="p">,</span> <span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">,</span> <span class="n">term_3</span><span class="p">,</span> <span class="n">return_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Terminals:</span>
<span class="sd">        term_0, term_1, term_2, term_3</span>
<span class="sd">        </span>
<span class="sd">        Terminals are defined via:</span>
<span class="sd">        ```</span>
<span class="sd">        Left_Termanals - RLC_s_bandstop - Right_Termanals</span>
<span class="sd">                             +----+  </span>
<span class="sd">        Postive V_i   term_0-|0  2|-term_2     Postive V_o</span>
<span class="sd">        Negtive V_i   term_1-|1  3|-term_3     Negtive V_o</span>
<span class="sd">                             +----+</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            return_internls (bool; False): If True return out the internal Voltage Source,</span>
<span class="sd">                and Resistance objects in this package</span>
<span class="sd">        Returns:</span>
<span class="sd">            Returns elements to circuit RLC parallel bandstop filter part element object and if `return_internls`</span>
<span class="sd">            is True will return the internal voltage and resistance objects in that order </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subcirc_ref</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">L1ref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">1&#39;</span><span class="p">}</span>
            <span class="n">L2ref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{self.subcirc_ref}</span><span class="s1">2&#39;</span><span class="p">}</span>

            <span class="n">C1ref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">1&#39;</span><span class="p">}</span>
            <span class="n">C2ref</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;C_</span><span class="si">{self.subcirc_ref}</span><span class="s1">2&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L1ref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">L2ref</span><span class="o">=</span><span class="p">{}</span>
            
            <span class="n">C1ref</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">C2ref</span><span class="o">=</span><span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L1_value</span><span class="p">,</span> <span class="o">**</span><span class="n">L1ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l2</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L2_value</span><span class="p">,</span> <span class="o">**</span><span class="n">L2ref</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C1_value</span><span class="p">,</span> <span class="o">**</span><span class="n">C1ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_value</span><span class="p">,</span> <span class="o">**</span><span class="n">C2ref</span><span class="p">)</span>
        
        
        <span class="n">term_0</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="n">term_1</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">l2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
        <span class="n">term_2</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="n">term_3</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>   
        
        
        
        
        <span class="k">if</span> <span class="n">return_elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
    
    <span class="k">def</span> <span class="nf">lcapy_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_me</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a lcapy schematic of this classes filter that</span>
<span class="sd">        can be used for amongst other things: draw a basic schematic</span>
<span class="sd">        of this class filter, extract the transfer function, </span>
<span class="sd">        exstract the 2Port Repersntation</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            draw_me (bool): will draw a schematic of this classes filter schematic</span>
<span class="sd">            </span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">        Return:</span>
<span class="sd">            the lcapys circuit object is stored in `self.schematic` and will</span>
<span class="sd">            have abstract sympy variable for the elements if `with_values` is False</span>
<span class="sd">            and will draw the schematic of just this classes filter if `draw_me` is True</span>
<span class="sd">        </span>
<span class="sd">        TODO:</span>
<span class="sd">            - must draw this better</span>
<span class="sd">            - get the Vin statement into the schematic</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        <span class="c1">#self.schematic.add(&#39;W 0 0; right&#39;)</span>
        <span class="c1">#self.schematic.add(&#39;W 1 3; right=3.5&#39;)</span>
        <span class="c1">#self.schematic.add(&#39;P1 0 1; down, v=V_i&#39;)</span>
        
        <span class="c1">#It ant pretty but it works</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_3; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L1 0_3 2_2; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_2 2; right&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_2; rotate=-45&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C2 0_2 3; rotate=-45&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C1 2 1_2; rotate=225&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;W 1_2 1; rotate=225&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_3; right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;L2 1_3 3_2; right=2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_2 3; right&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">with_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;L1&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L1_value</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">L2_value</span><span class="p">,</span> 
                                                <span class="s1">&#39;C1&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C1_value</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_value</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="n">draw_me</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ZPK</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        will extract the symbolic transfer function for this filter</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            with_values (bool): will push the filters element values into</span>
<span class="sd">                the resulting lcapy circuit object in place of abstract sympy variables</span>
<span class="sd">            </span>
<span class="sd">            ZPK (bool): if True will try to return the TF in zero-pole-gain form</span>
<span class="sd">                else will try to return the TF in canonical form </span>
<span class="sd">                where the unity coefficient is the highest power of the denominator</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ZPK</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">ZPK</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">canonical</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_twoPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_rep</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the 2Port network representation of this filter.</span>
<span class="sd">        The 2Port representation can be controlled</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            network_rep (str; &#39;Y&#39;): control string for what</span>
<span class="sd">                representation is used to choose from:</span>
<span class="sd">                </span>
<span class="sd">                &#39;Z&#39;: two-port Z-parameters matrix</span>
<span class="sd">                &#39;Y&#39;: two-port Y-parameters matrix</span>
<span class="sd">                &#39;H&#39;: two-port H-parameters matrix</span>
<span class="sd">                &#39;G&#39;: two-port G-parameters matrix</span>
<span class="sd">                &#39;ABCD&#39;: two-port A-parameters matrix</span>
<span class="sd">                &#39;invABCD&#39;: two-port B-parameters matrix</span>
<span class="sd">                &#39;S&#39;: two-port S-parameters matrix</span>
<span class="sd">                &#39;T&#39;: two-port T-parameters matrix</span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="n">draw_me</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_values</span><span class="o">=</span><span class="n">with_values</span><span class="p">)</span>
        
        <span class="c1">#create an action dict to get the 2P rep</span>
        <span class="n">rep_actions</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Zparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Yparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Hparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Gparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;ABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Aparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;invABCD&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Bparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Sparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Tparams</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">network_rep</span> <span class="ow">in</span> <span class="n">rep_actions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;`</span><span class="si">{network_rep}</span><span class="s1">` is not 2Port rep&#39;</span>
        
        <span class="k">return</span> <span class="n">rep_actions</span><span class="p">[</span><span class="n">network_rep</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">schematic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you’re wondering what a lattice filter is, the fact of the matter is that you have seen them before in terms of bridge circuits. See the following Wikipedia article on Lattice Networks</p>
<p>https://www.eeeguide.com/wp-content/uploads/2019/11/Lattice-Network.jpg</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instatate the allpass latice filter to </span>
<span class="n">allpasslat_lf</span><span class="o">=</span><span class="n">lc_balanced_allpass_lowfreq_lattice_filt</span><span class="p">()</span>
<span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance conflict 0.2761423749153966 vs 1.0 in horizontal graph for WWanon2 between nodes (2_2) and (2), due to incompatible sizes
</pre></div>
</div>
<img alt="../_images/AC_2_RCL_filters_158_1.png" src="../_images/AC_2_RCL_filters_158_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters abstract transfer function</span>
<span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[- \frac{\left(s - \frac{1}{\sqrt[4]{C_{1}} \sqrt[4]{C_{2}} \sqrt[4]{L_{1}} \sqrt[4]{L_{2}}}\right) \left(s + \frac{1}{\sqrt[4]{C_{1}} \sqrt[4]{C_{2}} \sqrt[4]{L_{1}} \sqrt[4]{L_{2}}}\right) \left(s - \frac{\mathrm{j}}{\sqrt[4]{C_{1}} \sqrt[4]{C_{2}} \sqrt[4]{L_{1}} \sqrt[4]{L_{2}}}\right) \left(s + \frac{\mathrm{j}}{\sqrt[4]{C_{1}} \sqrt[4]{C_{2}} \sqrt[4]{L_{1}} \sqrt[4]{L_{2}}}\right)}{\left(s - \frac{\mathrm{j}}{\sqrt{C_{1}} \sqrt{L_{1}}}\right) \left(s + \frac{\mathrm{j}}{\sqrt{C_{1}} \sqrt{L_{1}}}\right) \left(s - \frac{\mathrm{j}}{\sqrt{C_{2}} \sqrt{L_{2}}}\right) \left(s + \frac{\mathrm{j}}{\sqrt{C_{2}} \sqrt{L_{2}}}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get this filters transfer function</span>
<span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">get_tf</span><span class="p">(</span><span class="n">with_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[- \frac{\left(s - 1\right) \left(s + 1\right)}{\left(s - \mathrm{j}\right) \left(s + \mathrm{j}\right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="c1">#create the nets; the last one is needed to deal with singularity issues when dealing with lattice circuits and ground</span>
<span class="n">net_in</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">);</span> <span class="n">net_out</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out&#39;</span><span class="p">);</span> <span class="n">net_outlower</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;Out2&#39;</span><span class="p">)</span>
<span class="c1">#create a 1V AC test source and attache to nets</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_in</span><span class="p">,</span> <span class="n">gnd</span>
<span class="c1">#net_in+=dummy_1[2]</span>

<span class="c1">#attaceh term_0 to net_in and term_2 to net_out per scikit-rf convention all </span>
<span class="c1">#other terminals are grounded</span>
<span class="c1">#but need to add dummy resistors to deal with singular issues and get solvable matric</span>
<span class="n">dummy_botin</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
<span class="n">dummy_botin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>

<span class="n">dummy_botout</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
<span class="n">dummy_botout</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>
<span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">SKiDl</span><span class="p">(</span><span class="n">net_in</span><span class="p">,</span> <span class="n">dummy_botin</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">net_out</span><span class="p">,</span> <span class="n">dummy_botout</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
C1 Out N_1 1
C2 In N_2 1
L1 In Out 1H
L2 N_1 N_2 1H
V1 In 0 DC 0V AC 1V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
Rdummy 0 N_1 0
Rdummy_1 N_2 0 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dummy_bot*</span></code> resistors that are in the simulation are needed in order for SPICE to no longer throw a singular matrix error. Where the test circuit is drawn below. This might not be needed if the output (terminal 3) of the lattice filter was allowed to float. Floating circuits will be discussed in the next section on transformers in detail. Here all inputs and outputs will be referenced to ground.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_testcir</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vs In 0; down&#39;</span><span class="p">)</span>
<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; down=0.2, sground&#39;</span><span class="p">)</span>

<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W In U1.l1; right&#39;</span><span class="p">)</span>
<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rdummy 0 U1.l2; right, l=0Ohm&#39;</span><span class="p">)</span>

<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;U1 chip2121; right, l=</span><span class="si">{latice}</span><span class="s1">, pinlabels={l1=0,l2=1, r1=2,r2=3}&#39;</span><span class="p">)</span>

<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W U1.r1 Out; right&#39;</span><span class="p">)</span>
<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rdummy_1 U1.r2 Out2; right, l=0Ohm&#39;</span><span class="p">)</span>
<span class="n">lat_testcir</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W Out2 Out2_1; down=0.2, sground&#39;</span><span class="p">)</span>



<span class="n">lat_testcir</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_163_0.png" src="../_images/AC_2_RCL_filters_163_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">=</span><span class="n">qfilter_explorer</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="s1">&#39;LC All-Pass Low Frequcy Lattice Filter&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start_freq</th>
      <th>Stop_Freq</th>
      <th>SamplingInc</th>
      <th>StepType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1 Hz</td>
      <td>1 GHz</td>
      <td>20</td>
      <td>decade</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_2_RCL_filters_164_1.png" src="../_images/AC_2_RCL_filters_164_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_responce</span><span class="o">.</span><span class="n">symbolic_tf</span><span class="p">(</span><span class="n">allpasslat_lf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_2_RCL_filters_165_0.png" src="../_images/AC_2_RCL_filters_165_0.png" />
</div>
</div>
<p>The reason it’s diverging and more specifically flipped in phase might be due to how lcapy is treating the <code class="docutils literal notranslate"><span class="pre">0</span></code> as ground when it formulates the modified nodal analysis. As seen below with the lack of a <code class="docutils literal notranslate"><span class="pre">V_3</span></code> term. Going to pass on fixing this right now but it is top of the TODO list for this section</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">NodalAnalysis</span><span class="p">(</span><span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">laplace</span><span class="p">())</span>
<span class="n">n</span><span class="o">.</span><span class="n">nodal_equations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">126</span><span class="o">-</span><span class="mi">2419374</span><span class="n">f2f5d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">lcapy_self</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">n</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">NodalAnalysis</span><span class="p">(</span><span class="n">allpasslat_lf</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">laplace</span><span class="p">())</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">n</span><span class="o">.</span><span class="n">nodal_equations</span><span class="p">()</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/lcapy/nodalanalysis.py</span> in <span class="ni">__init__</span><span class="nt">(self, cct, node_prefix)</span>
<span class="nn">     64         self._y = matrix([val for key, val</span> in <span class="ni">self._unknowns.items</span><span class="nt">() if key != &#39;0&#39;])</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span> 
<span class="ne">---&gt; </span><span class="mi">66</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_equations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_equations</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> 
<span class="g g-Whitespace">     </span><span class="mi">68</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/lcapy/nodalanalysis.py</span> in <span class="ni">_make_equations</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>                     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Component </span><span class="si">%s</span><span class="s1"> does not have node </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elt</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">126</span>                     <span class="n">result</span> <span class="o">+=</span> <span class="n">elt</span><span class="o">.</span><span class="n">cpt</span><span class="o">.</span><span class="n">i_equation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unknowns</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unknowns</span><span class="p">[</span><span class="n">n2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span>                 <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">result</span><span class="p">,</span> <span class="n">expr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/lcapy/oneport.py</span> in <span class="ni">i_equation</span><span class="nt">(self, v, kind)</span>
<span class="g g-Whitespace">    </span><span class="mi">889</span>         <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;super&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">890</span>             <span class="k">return</span> <span class="n">SuperpositionCurrent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">*</span> <span class="n">expr</span><span class="p">(</span><span class="n">Derivative</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">t</span><span class="p">)))</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">891</span>         <span class="k">return</span> <span class="n">SuperpositionCurrent</span><span class="p">(</span><span class="n">SuperpositionVoltage</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Z</span><span class="o">.</span><span class="n">_selectexpr</span><span class="p">(</span><span class="n">kind</span><span class="p">))</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">892</span> 
<span class="g g-Whitespace">    </span><span class="mi">893</span>     <span class="k">def</span> <span class="nf">v_equation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">):</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/lcapy/expr.py</span> in <span class="ni">__getattr__</span><span class="nt">(self, attr)</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span>         <span class="n">expr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">637</span>             <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">638</span>         <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span>             <span class="k">raise</span>

<span class="ne">AttributeError</span>: &#39;Mul&#39; object has no attribute &#39;_selectexpr&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="citations">
<h2>Citations:<a class="headerlink" href="#citations" title="Permalink to this headline">¶</a></h2>
<p>[1] ALL ABOUT ELECTRONICS. “RC Low Pass Filter Explained,” YouTube, Aug 20, 2017. [Video file]. Available: https://youtu.be/_2L0l-E1Wx0. [Accessed: Nov 30, 2020].</p>
<p>[2] ALL ABOUT ELECTRONICS. “RC High Pass Filter Explained,” YouTube, Aug 23, 2017. [Video file]. Available: https://youtu.be/9Dx0b0ukNAM. [Accessed: Nov 30, 2020].</p>
<p>[3] ALL ABOUT ELECTRONICS. “Band Pass Filter and Band Stop Filter Explained,” YouTube, Sep 2, 2017. [Video file]. Available: https://youtu.be/dmPIydL0lyM. [Accessed: Nov 30, 2020].</p>
<p>[4] S. Makarov, R. Ludwig and S. Bitar, Practical electrical engineering. Cham: Springer International Publishing, 2016, pp. 514-515.</p>
<p>[5] “Lattice phase equaliser”, En.wikipedia.org, 2021. [Online]. Available: https://en.wikipedia.org/wiki/Lattice_phase_equaliser. [Accessed: 10- Jan- 2021].</p>
<p>[6] “Lattice network”, En.wikipedia.org, 2021. [Online]. Available: https://en.wikipedia.org/wiki/Lattice_network. [Accessed: 10- Jan- 2021].</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./AC_2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="AC_1_One-Two-Three_Phase_AC.html" title="previous page">&lt;no title&gt;</a>
    <a class='right-next' id="next-link" href="AC_4_PZ.html" title="next page">What is PZ anylsis</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Steven K Armour (PyLCARS)<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>