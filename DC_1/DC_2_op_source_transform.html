
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Working with SKiDl elements &#8212; Python &amp; SPICE</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DC Sweeps" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html" />
    <link rel="prev" title="Getting started with Python &amp; SPICE, DC Operating Point Analysis" href="DC_1_op_ohm.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python & SPICE</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../needed_libraries.html">
   Dependency install instruction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="DC_1.html">
   Chapter 1 DC Simulations and Basic DC Elements with Python and SPICE
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="DC_1_op_ohm.html">
     Getting started with Python &amp; SPICE, DC Operating Point Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_1_op_ohm.html#spice-s-dc-operating-point-simulation-op">
     SPICE’s DC Operating Point simulation
     <code class="docutils literal notranslate">
      <span class="pre">
       .op
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Working with SKiDl elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html">
     DC Sweeps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#dc-load-sweep-of-an-ideal-voltage-source">
     DC load sweep of an Ideal Voltage source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#a-better-dc-sim-interaction">
     A Better
     <code class="docutils literal notranslate">
      <span class="pre">
       .dc
      </span>
     </code>
     Sim Interaction¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#ideal-current-source">
     Ideal Current Source¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#first-testbench-element">
     First testbench element¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html">
     Controlled Dependent Sources in SPICE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#ccvs">
     CCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#enter-the-spice-transfer-function">
     Enter the SPICE transfer function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#lcapy">
     LCAPY
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#vcvs">
     VCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#cccs">
     CCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_4_dependent_sources_and_tf.html#vccs">
     VCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_5_Thvenin_Norton.html">
     Thevenin’s DC Equivalent Circuit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_5_Thvenin_Norton.html#norton-s-theorem">
     Norton’s Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_6_DC_MaxPower_MaxEfficiency.html">
     Maximum Power Transfer Theorem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../AC_2/AC_1.html">
   Chapter 2 AC simulations with Python and SPICE
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html">
     Capacitors and Inductors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#ac-sources">
     AC Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#v-max-fourier-terms-and-rms">
     <span class="math notranslate nohighlight">
      \(V_{max}\)
     </span>
     ,  Fourier terms, and RMS¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#single-phase-cirucit">
     Single Phase Cirucit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#two-phase-system">
     Two-Phase System¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#three-phase-four-wire-y-star-topology">
     Three Phase Four Wire Y (Star) Topology ¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#three-phase-three-wire-delta-topology">
     Three Phase Three Wire
     <span class="math notranslate nohighlight">
      \(\Delta\)
     </span>
     Topology
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html">
     Basic Passive Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#first-order-cascade-filter">
     First Order Cascade filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#second-order-filters-and-resonators">
     Second-Order Filters and resonators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#all-pass-filters">
     All Pass filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html">
     Mutual Inductance and SPICE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html#series-mutual-inductance">
     Series Mutual inductance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html#parallel-mutual-inductance">
     Parallel Mutual Inductance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html#purposely-designed-mutual-inductive-element-the-razivi-t-coil">
     Purposely designed Mutual Inductive Element; The Razivi T-Coil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html#transformers">
     Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_3_CoupledMag.html#citations">
     Citations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html">
     What is PZ anylsis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#pz-analysis-of-an-rc-lowpass-filter">
     PZ analysis of an RC lowpass filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#pz-ease">
     PZ ease
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#pole-zero-analysis-of-a-series-band-reject-filter">
     Pole-Zero analysis of a Series Band Reject filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#pole-zero-analysis-of-a-lattice-all-pass-filter">
     Pole-Zero analysis of a lattice All-Pass filter¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#add-the-razavi-t-coil-after-the-previous-magnetic-section-is-done">
     Add the Razavi T-coil after the previous magnetic section is done¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_4_PZ.html#citations">
     Citations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html">
   Checking tool
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#basic-elements">
   Basic Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-sinusoidalmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SinusoidalMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-pulsemixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PulseMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-exponentialmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     ExponentialMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-piecewiselinearmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PieceWiseLinearMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-singlefrequencyfmmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SingleFrequencyFMMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-amplitudemodulatedmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     AmplitudeModulatedMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-randommixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     RandomMixin
    </span>
   </code>
   Based
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/DC_1/DC_2_op_source_transform.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book/issues/new?title=Issue%20on%20page%20%2FDC_1/DC_2_op_source_transform.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PyLCARS/Python-and-SPICE-Book/master?urlpath=tree/docs/DC_1/DC_2_op_source_transform.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-1-from-source-transformation-6-30-min">
   Example 1 from “Source Transformation” @ ~6:30 min
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-very-important-word-about-current-source-in-spice">
     A very important word about current source in SPICE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#skidl-s-diabetic-syntax">
     SKiDl’s Diabetic Syntax
     <code class="docutils literal notranslate">
      <span class="pre">
       &amp;
      </span>
     </code>
     ,
     <code class="docutils literal notranslate">
      <span class="pre">
       |
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crafting-the-transfomation-tool">
     Crafting the transfomation tool
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validate-the-transform">
     validate the transform¶
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#internal-parameters">
   internal parameters:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-transform-internals">
     pre transform_internals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#post-transform-internals">
     post transform internals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantitive-comparison">
     Quantitive comparison ¶
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#citations">
   Citations:
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><strong>TODO</strong></p>
<ul class="simple">
<li><p>create a better control stuc for internal parameters to, look as SKiDl’s lib file that does the conversion from SKiDl to pyspice for inspiration</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Library import statements</span>

<span class="kn">from</span> <span class="nn">skidl.pyspice</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#can you say cheeky </span>
<span class="kn">import</span> <span class="nn">PySpice</span> <span class="k">as</span> <span class="nn">pspice</span>
<span class="c1">#becouse it&#39;s written by a kiwi you know</span>
<span class="kn">import</span> <span class="nn">lcapy</span> <span class="k">as</span> <span class="nn">kiwi</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">traceback</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: KICAD_SYMBOL_DIR environment variable is missing, so the default KiCad symbol libraries won&#39;t be searched.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#notebook specific loading control statements </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#tool to log notebook internals</span>
<span class="c1">#https://github.com/jrjohansson/version_information</span>
<span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> skidl, PySpice,lcapy, sympy, numpy, matplotlib, pandas, scipy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.6 64bit [GCC 7.3.0]</td></tr><tr><td>IPython</td><td>7.12.0</td></tr><tr><td>OS</td><td>Linux 4.19.104 microsoft standard x86_64 with debian bullseye sid</td></tr><tr><td>skidl</td><td>0.0.31.dev0</td></tr><tr><td>PySpice</td><td>1.4.3</td></tr><tr><td>lcapy</td><td>0.75.dev0</td></tr><tr><td>sympy</td><td>1.6.2</td></tr><tr><td>numpy</td><td>1.18.1</td></tr><tr><td>matplotlib</td><td>3.3.0</td></tr><tr><td>pandas</td><td>1.1.4</td></tr><tr><td>scipy</td><td>1.4.1</td></tr><tr><td colspan='2'>Thu Jan 28 00:40:14 2021 MST</td></tr></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import the op read tool from last subchapter</span>
<span class="kn">from</span> <span class="nn">DC_1_Codes</span> <span class="kn">import</span> <span class="n">op_results_collect</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-with-skidl-elements">
<h1>Working with SKiDl elements<a class="headerlink" href="#working-with-skidl-elements" title="Permalink to this headline">¶</a></h1>
<p>The following example, to be honest, is pedantic; but it serves to introduce the current source in SPICE which can be a real headache. It also shows how to let Python do the work of interacting with elements that we will readily make great use of down the road.</p>
<p>So why is thus so pedantic? source transformations are mostly an analytic simplification tool. And while yes there is some practicality in being able to find a matching current source to a voltage source and vice versa with equivalent power from the standpoint of Thevenin and Norton’s theorem. There are, however, serious limation with how the real circuits handle inputs of voltage and current differently. And frankly, from SPICE’s point of view for this exercise, it doesn’t care, it’s going to solve regardless. So if you need a refresher on source transformations with an illustration of why there a really great analytical tool please watch ALL ABOUT ELECTRONICS YT video on “Source Transformations” where this example is pulled from.</p>
<div class="section" id="example-1-from-source-transformation-6-30-min">
<h2>Example 1 from “Source Transformation” &#64; ~6:30 min<a class="headerlink" href="#example-1-from-source-transformation-6-30-min" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;FtEU5ZoO-fg&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">390</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/FtEU5ZoO-fg?start=390"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="section" id="a-very-important-word-about-current-source-in-spice">
<h3>A very important word about current source in SPICE<a class="headerlink" href="#a-very-important-word-about-current-source-in-spice" title="Permalink to this headline">¶</a></h3>
<p>Before building the circuit above a word about any current sources in SPICE. Recalling the discussion around the surefire method of measuring currents in SPICE using a 0V Liner Voltage Souce (aka the SPICE ammeter trick) in SPICE current flow is in the positive direction from a positive voltage to a negative voltage. So by convention, we draw independent and dependent sources with an arrow in the direction of how current is being added. While that means that all current sources are polarized such that the positive terminal is at the tail of the drawn current arrow and the head is the negative terminal. When you use a schematic editor with built-in SPICE it does all the terminal work in the background. But when we are indirectly working with netlist, via SKiDL, you will have to make sure you remember this. Or else this will bite you in the butt and keep costing you time till have this arrow and terminal connection for current ingrained into you.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">vs_4</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_4&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">4</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">vs_8</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_8&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">8</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">cs_2</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_2&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_A</span><span class="p">)</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>

<span class="p">(</span><span class="n">gnd</span><span class="o">&amp;</span><span class="n">vs_4</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">&amp;</span><span class="n">r1</span><span class="p">)</span> <span class="o">|</span><span class="n">r2</span> 

<span class="n">vs_8</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="p">(</span><span class="n">gnd</span> <span class="o">&amp;</span> <span class="n">cs_2</span> <span class="o">|</span> <span class="n">r3</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">preop_sim</span><span class="o">=</span><span class="n">op_results_collect</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="c1">#store the results for comperasion to post souce transfromations</span>
<span class="n">pre_tf_res</span><span class="o">=</span><span class="n">preop_sim</span><span class="o">.</span><span class="n">results_df</span>
<span class="n">pre_tf_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
Vs_4 0 N_1 4V
Vs_8 N_2 N_3 8V
Is_2 0 N_3 2A
R1 N_1 N_2 6Ohm
R2 0 N_2 12Ohm
R3 0 N_3 12Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N_1</th>
      <td>Node_Voltage</td>
      <td>-4</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_2</th>
      <td>Node_Voltage</td>
      <td>6</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_3</th>
      <td>Node_Voltage</td>
      <td>-2</td>
      <td>V</td>
    </tr>
    <tr>
      <th>Vs_4</th>
      <td>Branch_Curr</td>
      <td>1.66667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Vs_8</th>
      <td>Branch_Curr</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="skidl-s-diabetic-syntax">
<h3>SKiDl’s Diabetic Syntax <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code><a class="headerlink" href="#skidl-s-diabetic-syntax" title="Permalink to this headline">¶</a></h3>
<p>Notice above that usage of Pythons logical AND operator &amp; and logical OR operator | in creating the circuit. Since &amp; and | are just operators in python we can do what is called operator extensions to them to make them act in special ways in a certain context. In SKiDls particular case the logical and (&amp;) is a shorthand for putting two elements in series. And the logical OR (|) is shorthand for putting two elements in parral. Furthermore, these operators and parentheses sensitive, and are not polarized sensitive and so polarized elements need to have their terminals called out when using the. There called Diabetic Syntical Suger in light of their release announcement entitled <a class="reference external" href="http://xess.com/skidl/docs/_site/blog/sweetening-skidl">“SWEETENING SKIDL”</a>. Using is up to your codding style and that of your colleagues. All joking aside they are extremely useful operators to know how to use, and we will use them in this book.</p>
</div>
<div class="section" id="crafting-the-transfomation-tool">
<h3>Crafting the transfomation tool<a class="headerlink" href="#crafting-the-transfomation-tool" title="Permalink to this headline">¶</a></h3>
<p>We are not going into that much detial about these tool. The important thing is that we can take advante that all our elements (SKiDl part) and nets are objects in Python. And therefore have methods and attriputs that are accesable and therefore more usable then helping produce part of a line of a SPICE netlist. For instiance Voltage and Current souce store there dcvalue in <code class="docutils literal notranslate"><span class="pre">&lt;V\I&gt;.dc_value</span></code> where resitors store there resistince in <code class="docutils literal notranslate"><span class="pre">R.value</span></code>.This then alows us to use the elements to perform calculation outside of SPICE and even better assisit in creating new elements as we have done below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a DC_1_Codes.py</span>
<span class="c1">#chapter 1 section 2 get_skidl_spice_ref function</span>
<span class="c1">#used for getting the name of the element as it would appear in a</span>
<span class="c1">#generated netlist</span>

<span class="k">def</span> <span class="nf">get_skidl_spice_ref</span><span class="p">(</span><span class="n">skidle_element</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to retrieve SKiDL element name as appears in the final netlist</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        skidle_element (skidl.part.Part): SKiDl part to get the netlist name from</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        returns a string with the netlist name of `skidle_element`, or throws an</span>
<span class="sd">        error if `skidle_element` is not a SKiDl part</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">skidle_element</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.part.Part&#39;&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;`skidle_element` must be a SKiDl part&#39;</span>
    
    <span class="k">if</span> <span class="n">skidle_element</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">!=</span><span class="n">skidle_element</span><span class="o">.</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">skidle_element</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">+</span><span class="n">skidle_element</span><span class="o">.</span><span class="n">ref</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">skidle_element</span><span class="o">.</span><span class="n">ref</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a DC_1_Codes.py</span>
<span class="c1">#chapter 1 section 2 dc_cs2vs function</span>
<span class="c1">#creates a voltage source element to the current source based on the </span>
<span class="c1">#value if the input DC current element and it&#39;s parallel resistor</span>
<span class="c1">#via the source transformation rules</span>

<span class="k">def</span> <span class="nf">dc_cs2vs</span><span class="p">(</span><span class="n">dc_cs</span><span class="p">,</span> <span class="n">cs_par_res</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new equivalent voltage source to the current source with parallel resistance</span>
<span class="sd">    Args:</span>
<span class="sd">        dc_cs (SKiDl current source): the current source to transform to a voltage source</span>
<span class="sd">        cs_par_res (SKiDl resistor): the parrel resistor to the current source to be transformed</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        returns an equivalent DC voltage source element to the current source based on the </span>
<span class="sd">        value if the input DC current element and it&#39;s parallel resistor via the source transformation rules </span>
<span class="sd">    </span>
<span class="sd">    TODO:</span>
<span class="sd">        -figure out how to do assertion check that cs_par_res is in parallel to dc_cs</span>
<span class="sd">        </span>
<span class="sd">    Future:</span>
<span class="sd">        -make into subcircuit with net inputs to automatically add the new source and resistance to the circuit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">#do assertion checks to insure that passed in objects are what they are supposed to be</span>
    <span class="k">assert</span> <span class="n">dc_cs</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;dc_cs&gt; was not a current source&#39;</span>
    <span class="k">assert</span> <span class="n">cs_par_res</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cs_par_res&gt; was not a resistor&#39;</span>
    
    
    <span class="n">old_maxpower</span><span class="o">=</span><span class="nb">float</span><span class="p">((</span><span class="n">dc_cs</span><span class="o">.</span><span class="n">dc_value</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cs_par_res</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">new_vs_val</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">dc_cs</span><span class="o">.</span><span class="n">dc_value</span><span class="o">*</span><span class="n">cs_par_res</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">new_vs_val</span><span class="o">*</span><span class="n">dc_cs</span><span class="o">.</span><span class="n">dc_value</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">old_maxpower</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;Um, something wrong since before and after max power not equal&quot;</span>
    
    <span class="n">new_vs_ref</span><span class="o">=</span><span class="n">dc_cs</span><span class="o">.</span><span class="n">ref</span>
    <span class="k">if</span> <span class="n">new_vs_ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;I&#39;</span><span class="p">:</span>
        <span class="n">new_vs_ref</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="o">+</span><span class="n">new_vs_ref</span>
    
    
    <span class="n">new_vs_ref</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;V</span><span class="si">{new_vs_ref[1:]}</span><span class="s2">_f_</span><span class="si">{new_vs_ref}</span><span class="s2">&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">new_vs_ref</span><span class="p">)</span>
    
    
    <span class="n">eq_vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">dc_value</span><span class="o">=</span><span class="n">new_vs_val</span><span class="nd">@u_V</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">new_vs_ref</span><span class="p">)</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;New voltage source values: </span><span class="si">{new_vs_val}</span><span class="s2"> [V] with max aviabel power </span><span class="si">{old_maxpower}</span><span class="s2"> [W] </span><span class="se">\n</span><span class="s2"> transformed creation statment will be like: </span><span class="se">\n</span><span class="s2">`(gnd &amp; &lt;eq_vs&gt;[&#39;n&#39;, &#39;p&#39;] &amp; &lt;cs_par_res&gt;)`&quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">eq_vs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a DC_1_Codes.py</span>
<span class="c1">#chapter 1 section 2 dc_vs2cs function</span>
<span class="c1">#creats current source element to the voltage source based on the </span>
<span class="c1">#value if the input DC current element and it&#39;s series resistor</span>
<span class="c1">#via the source transformation rules</span>

<span class="k">def</span> <span class="nf">dc_vs2cs</span><span class="p">(</span><span class="n">dc_vs</span><span class="p">,</span> <span class="n">vs_ser_res</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new equivalent current source to voltage source with series resistance</span>
<span class="sd">    Args:</span>
<span class="sd">        dc_vs (SKiDl voltage source): the voltage source to transform to a current source</span>
<span class="sd">        vs_ser_res (SKiDl resistor): the serries resistor to the voltage source to be transformed</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">    TODO:</span>
<span class="sd">        -figure out how to do assertion check that vs_ser_res is in serries to dc_vs</span>
<span class="sd">    </span>
<span class="sd">    Future:</span>
<span class="sd">        -make into subcircuit with net inputs to automatically add the new source and resistance to the circuit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">#do assertion checks to insure that passed in objects are what they are supposed to be</span>
    <span class="k">assert</span> <span class="n">dc_vs</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;dc_vs&gt; was not a voltage source&#39;</span>
    <span class="k">assert</span> <span class="n">vs_ser_res</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;vs_ser_res&gt; was not a resistor&#39;</span>
    
    <span class="n">old_maxpower</span><span class="o">=</span><span class="nb">float</span><span class="p">((</span><span class="n">dc_vs</span><span class="o">.</span><span class="n">dc_value</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">vs_ser_res</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">new_cs_val</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">dc_vs</span><span class="o">.</span><span class="n">dc_value</span><span class="o">/</span><span class="n">vs_ser_res</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">new_cs_val</span><span class="o">*</span><span class="n">dc_vs</span><span class="o">.</span><span class="n">dc_value</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">old_maxpower</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;Um, something wrong since before and after max power not equal&quot;</span>


    <span class="n">new_cs_ref</span><span class="o">=</span><span class="n">dc_vs</span><span class="o">.</span><span class="n">ref</span>
    <span class="k">if</span> <span class="n">new_cs_ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;V&#39;</span><span class="p">:</span>
        <span class="n">new_cs_ref</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="o">+</span><span class="n">new_cs_ref</span>
    
    
    <span class="n">new_cs_ref</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;I</span><span class="si">{new_cs_ref[1:]}</span><span class="s2">_f_</span><span class="si">{new_cs_ref}</span><span class="s2">&quot;</span>
    <span class="c1">#print(new_cs_ref)</span>
    
    
    <span class="n">eq_cs</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">dc_value</span><span class="o">=</span><span class="n">new_cs_val</span><span class="nd">@u_A</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">new_cs_ref</span><span class="p">)</span><span class="c1"># might still need this: , circuit=vs_ser_res.circuit)</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;New current source values: </span><span class="si">{new_cs_val}</span><span class="s2"> [A] with max aviabel power </span><span class="si">{old_maxpower}</span><span class="s2"> [W] </span><span class="se">\n</span><span class="s2"> transformed creation statment will be like:</span><span class="se">\n</span><span class="s2"> `(gnd &amp; &lt;eq_cs&gt;[&#39;n&#39;, &#39;p&#39;] | &lt;vs_ser_res&gt;)` </span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">eq_cs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="validate-the-transform">
<h3>validate the transform¶<a class="headerlink" href="#validate-the-transform" title="Permalink to this headline">¶</a></h3>
<p>For this, we are to transform the left voltage source and series resistors and the right current source and parral resistor simultaneously which halfway deviates from what ALL ABOUT ELECTRONICS did working the example analytically. We will have the center parallel resistor and voltage source as a reference network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>

<span class="n">vs_8</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_8&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">8</span><span class="nd">@u_V</span><span class="p">)</span>

<span class="n">cs_4_f_cs_4</span><span class="o">=</span><span class="n">dc_vs2cs</span><span class="p">(</span><span class="n">vs_4</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>

<span class="n">vs_2_f_cs_2</span><span class="o">=</span><span class="n">dc_cs2vs</span><span class="p">(</span><span class="n">cs_2</span><span class="p">,</span> <span class="n">r3</span><span class="p">)</span>


<span class="p">(</span><span class="n">gnd</span><span class="o">&amp;</span><span class="n">cs_4_f_cs_4</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">|</span><span class="n">r1</span><span class="p">)</span> <span class="o">|</span><span class="n">r2</span> 

<span class="n">vs_8</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="p">(</span><span class="n">gnd</span> <span class="o">&amp;</span> <span class="n">vs_2_f_cs_2</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">r3</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>


<span class="n">postop_sim</span><span class="o">=</span><span class="n">op_results_collect</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="c1">#store the results for comperaion to pre souce transfromations</span>
<span class="n">post_tf_res</span><span class="o">=</span><span class="n">postop_sim</span><span class="o">.</span><span class="n">results_df</span>
<span class="n">post_tf_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/iridium/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:43: UserWarning: New current source values: 0.6666666666666666 [A] with max aviabel power 2.6666666666666665 [W] 
 transformed creation statment will be like:
 `(gnd &amp; &lt;eq_cs&gt;[&#39;n&#39;, &#39;p&#39;] | &lt;vs_ser_res&gt;)` 

/home/iridium/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:44: UserWarning: New voltage source values: 24.0 [V] with max aviabel power 48.0 [W] 
 transformed creation statment will be like: 
`(gnd &amp; &lt;eq_vs&gt;[&#39;n&#39;, &#39;p&#39;] &amp; &lt;cs_par_res&gt;)`

No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vs_2_f_Is_2
.title 
R1 0 N_1 6Ohm
R2 0 N_1 12Ohm
R3 N_3 N_2 12Ohm
Vs_8 N_1 N_2 8V
Is_4_f_Vs_4 N_1 0 0.6666666666666666A
Vs_2_f_Is_2 N_3 0 24.0V
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N_1</th>
      <td>Node_Voltage</td>
      <td>6</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_3</th>
      <td>Node_Voltage</td>
      <td>24</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_2</th>
      <td>Node_Voltage</td>
      <td>-2</td>
      <td>V</td>
    </tr>
    <tr>
      <th>Vs_8</th>
      <td>Branch_Curr</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Vs_2_f_Is_2</th>
      <td>Branch_Curr</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since we stored the results from the pre transformed circuit we can try to do an eyeball compersion between the two dataframes, however, since the net names are no longer the same we only can look at the branch current of vs_8 which remained constant</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_tf_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N_1</th>
      <td>Node_Voltage</td>
      <td>-4</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_2</th>
      <td>Node_Voltage</td>
      <td>6</td>
      <td>V</td>
    </tr>
    <tr>
      <th>N_3</th>
      <td>Node_Voltage</td>
      <td>-2</td>
      <td>V</td>
    </tr>
    <tr>
      <th>Vs_4</th>
      <td>Branch_Curr</td>
      <td>1.66667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Vs_8</th>
      <td>Branch_Curr</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pre_tf_res</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">vs_8</span><span class="p">)]</span><span class="o">==</span><span class="n">post_tf_res</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">vs_8</span><span class="p">)])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Thus we can assume that the circuits are source equivalents of each other, but this book is about cultivating analog design verification. And assuming can yield performance hits and even worse the need for a SPIN. Therefore DONT ASSUME, figure out a way to VERIFY via Quantifiable answers.</p>
</div>
</div>
<div class="section" id="internal-parameters">
<h2>internal parameters:<a class="headerlink" href="#internal-parameters" title="Permalink to this headline">¶</a></h2>
<p>ngspice (in fact most SPICE engines) elements have what are called internal parameters. Most of the setup parameters like dc_value, resistance, ect along with nitty-gritty parameters for more advanced SPICE simulations that will get too. What we are after of now are the internal values that store results of simulations as we have alluded to in the non surefire way to save internal parameters. For instance, resistors have a way of measuring the internal current flowing through them the but the caveat is that it only returns real values in ngspice, which will be an issue when doing AC simulations. But for DC simulations is a tool we should utilize. Also at the time of writing this PySPICE has a quark that internal values are not retrieved at the same time the branch currents and net voltages are. So to get both the simulation has to be run twice and the author is not sure if this is quark of ngspice or PySPICE but the author will look into it at a later time.</p>
<p>For now, just know internal parameters have a string calls of <code class="docutils literal notranslate"><span class="pre">&lt;Elelement</span> <span class="pre">name&gt;&#64;[&lt;internal</span> <span class="pre">paamamater&gt;]</span></code> that is passed to a PySPICE simulation objects <code class="docutils literal notranslate"><span class="pre">.save_internal_parameters</span></code> method and then are returned in the results as the original string call to the results super dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a DC_1_Codes.py</span>
<span class="c1">#chapter 1 section 2 op_internal_ivp class</span>
<span class="c1"># class to get both the branch currents and node voltages,</span>
<span class="c1"># along with the internal parameters values for </span>
<span class="c1"># DC operating point analysis</span>

<span class="k">class</span> <span class="nc">op_internal_ivp</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for creating a SPICE simulation on the whole circuits internal parameters for current, voltage, and power</span>
<span class="sd">    for dc operating point (.op) simulations. Will only collect internal parameters and not global voltage and currents </span>
<span class="sd">    of the circuit</span>
<span class="sd">    TODO:</span>
<span class="sd">        Make this inheritable from op_results_collect </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op_sim_circ</span><span class="p">,</span> <span class="n">display_results</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic class to get pyspice operating_point (ngspice `.op`) simulation results</span>
<span class="sd">        for internal parameters for Resistors, Current Source, Voltage Source current, voltage, power</span>
<span class="sd">        respectively</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            op_sim_circ (pspice.Spice.Netlist.Circuit): the Netlist circuit produced </span>
<span class="sd">            from SKiDl&#39;s `generate_netlist()`</span>
<span class="sd">            </span>
<span class="sd">            display_results (bool; False): option to have the simulation results</span>
<span class="sd">                stored in `self.results_df` automatically displayed from a jupyter notebook</span>
<span class="sd">                ell</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            will create a simulation in `self.op_sim`, raw results of dc operating </span>
<span class="sd">            point simulation will be stored in `self.op_sim_results`, the tablized</span>
<span class="sd">            results will be stored in pandas dataframe `self.results_df`</span>
<span class="sd">        </span>
<span class="sd">        TODO: </span>
<span class="sd">            - add kwargs to the simulator</span>
<span class="sd">            - add an assertion that only a pyspice netlist circuit obj can</span>
<span class="sd">                    be passed into op_sim_circ</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#need to add assertions for op_sim_circ ==pspice.Spice.Netlist.Circuit</span>
        
        <span class="c1">#store the circuit internally</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_sim_circ</span><span class="o">=</span><span class="n">op_sim_circ</span>
        <span class="c1">#create the sim obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">op_sim_circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
        
        <span class="c1">#store bool to display results dataframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="o">=</span><span class="n">display_results</span>
        
        <span class="c1">#create the internal parameters to save</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_savable_items</span><span class="p">()</span>
        <span class="c1">#run the sim for .op for internal parameters and record results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_and_record</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">create_savable_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to create a listing of internal parameters and the table of the results.</span>
<span class="sd">        Right now only creates savable internal parameters for:</span>
<span class="sd">        Linear Dependent Voltage Sources: current, power</span>
<span class="sd">        Linear Dependent Current Sources: current, voltage, power</span>
<span class="sd">        Standard Resistor: current, voltage, power</span>
<span class="sd">        Linear Dependent Current Sources: current, voltage, power</span>
<span class="sd">        VCCS: current, voltage, power</span>
<span class="sd">        VCVS: current, voltage, power</span>
<span class="sd">        CCVS: current, voltage, power</span>
<span class="sd">        CCCS:currrent, voltage, power</span>
<span class="sd">        </span>
<span class="sd">        See ngspice manual typically chapter 31 &quot;Model and Device Parameters&quot;</span>
<span class="sd">        for more deitals about deice intiernal parmaters</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Circ_Item&#39;</span><span class="p">,</span> <span class="s1">&#39;Item_Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Unit&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Circ_Item&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1">#helper row creation statement</span>
        <span class="k">def</span> <span class="nf">add_row</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Item_Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Unit&#39;</span><span class="p">]]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="p">]</span>
            
        
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_sim_circ</span><span class="o">.</span><span class="n">element_names</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Ref: ngspice documentation chapter 31 (typically): Model and Device Parameters</span>
<span class="sd">                </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1">#resistors</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;R&#39;</span><span class="p">:</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[i]&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[p]&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>
            
            <span class="c1">#independnt current source</span>
            <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;I&#39;</span><span class="p">:</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[c]&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[v]&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[p]&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>
            
            <span class="c1">#independ Voltage source</span>
            <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">:</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[i]&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[p]&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>
            
            <span class="c1">#controlled sources</span>
            <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]:</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[i]&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[v]&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
                <span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{e}</span><span class="s1">[p]&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Circ Element </span><span class="si">{e}</span><span class="s2"> is not setup to have internals read, skiping&quot;</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">sim_and_record</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run the .op simulation and get the internal values </span>
<span class="sd">        </span>
<span class="sd">        Args: None</span>
<span class="sd">        Returns:</span>
<span class="sd">            `self.internal_opsim_res` store the raw results of the .op for internal pamtyers</span>
<span class="sd">            whereas `self.results_df` stores the pandas dataframe of internal parameters results</span>
<span class="sd">        </span>
<span class="sd">        TODO: figure out how to do this at the same time as the main node branch sim</span>
<span class="sd">            this doing separately is getting old</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_items</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_sim</span><span class="o">.</span><span class="n">save_internal_parameters</span><span class="p">(</span><span class="o">*</span><span class="n">save_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_opsim_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">op_sim</span><span class="o">.</span><span class="n">operating_point</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">save</span> <span class="ow">in</span> <span class="n">save_items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">save</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_opsim_res</span><span class="p">[</span><span class="n">save</span><span class="p">]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;.op sim internal parmter results&#39;</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pre-transform-internals">
<h3>pre transform_internals<a class="headerlink" href="#pre-transform-internals" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">vs_4</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_4&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">4</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">vs_8</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_8&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">8</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">cs_2</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_2&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_A</span><span class="p">)</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>

<span class="p">(</span><span class="n">gnd</span><span class="o">&amp;</span><span class="n">vs_4</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">&amp;</span><span class="n">r1</span><span class="p">)</span> <span class="o">|</span><span class="n">r2</span> 

<span class="n">vs_8</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="p">(</span><span class="n">gnd</span> <span class="o">&amp;</span> <span class="n">cs_2</span> <span class="o">|</span> <span class="n">r3</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
Vs_4 0 N_1 4V
Vs_8 N_2 N_3 8V
Is_2 0 N_3 2A
R1 N_1 N_2 6Ohm
R2 0 N_2 12Ohm
R3 0 N_3 12Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preop_ivp_sim</span><span class="o">=</span><span class="n">op_internal_ivp</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">pre_ivp_res</span><span class="o">=</span><span class="n">preop_ivp_sim</span><span class="o">.</span><span class="n">results_df</span>
<span class="n">pre_ivp_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @is_2[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r1[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vs_4[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vs_8[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r2[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r3[p] power
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>@Vs_4[i]</th>
      <td>internal</td>
      <td>-1.66667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Vs_4[p]</th>
      <td>internal</td>
      <td>6.66667</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@Vs_8[i]</th>
      <td>internal</td>
      <td>-2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Vs_8[p]</th>
      <td>internal</td>
      <td>17.3333</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@Is_2[c]</th>
      <td>internal</td>
      <td>2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Is_2[v]</th>
      <td>internal</td>
      <td>-2</td>
      <td>V</td>
    </tr>
    <tr>
      <th>@Is_2[p]</th>
      <td>internal</td>
      <td>4</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R1[i]</th>
      <td>internal</td>
      <td>-1.66667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R1[p]</th>
      <td>internal</td>
      <td>16.6667</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R2[i]</th>
      <td>internal</td>
      <td>-0.5</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R2[p]</th>
      <td>internal</td>
      <td>3</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R3[i]</th>
      <td>internal</td>
      <td>0.166667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R3[p]</th>
      <td>internal</td>
      <td>0.333333</td>
      <td>W</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="post-transform-internals">
<h3>post transform internals<a class="headerlink" href="#post-transform-internals" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">12</span><span class="nd">@u_Ohm</span><span class="p">)</span>

<span class="n">vs_8</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;s_8&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">8</span><span class="nd">@u_V</span><span class="p">)</span>

<span class="n">cs_f_vs_4</span><span class="o">=</span><span class="n">dc_vs2cs</span><span class="p">(</span><span class="n">vs_4</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>

<span class="n">vs_f_cs_2</span><span class="o">=</span><span class="n">dc_cs2vs</span><span class="p">(</span><span class="n">cs_2</span><span class="p">,</span> <span class="n">r3</span><span class="p">)</span>


<span class="p">(</span><span class="n">gnd</span><span class="o">&amp;</span><span class="n">cs_f_vs_4</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">|</span><span class="n">r1</span><span class="p">)</span> <span class="o">|</span><span class="n">r2</span> 

<span class="n">vs_8</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="p">(</span><span class="n">gnd</span> <span class="o">&amp;</span> <span class="n">vs_f_cs_2</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">r3</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vs_2_f_Is_2
.title 
R1 0 N_1 6Ohm
R2 0 N_1 12Ohm
R3 N_3 N_2 12Ohm
Vs_8 N_1 N_2 8V
Is_4_f_Vs_4 N_1 0 0.6666666666666666A
Vs_2_f_Is_2 N_3 0 24.0V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/iridium/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:43: UserWarning: New current source values: 0.6666666666666666 [A] with max aviabel power 2.6666666666666665 [W] 
 transformed creation statment will be like:
 `(gnd &amp; &lt;eq_cs&gt;[&#39;n&#39;, &#39;p&#39;] | &lt;vs_ser_res&gt;)` 

/home/iridium/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:44: UserWarning: New voltage source values: 24.0 [V] with max aviabel power 48.0 [W] 
 transformed creation statment will be like: 
`(gnd &amp; &lt;eq_vs&gt;[&#39;n&#39;, &#39;p&#39;] &amp; &lt;cs_par_res&gt;)`

No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postop_ivp_sim</span><span class="o">=</span><span class="n">op_internal_ivp</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">post_ivp_res</span><span class="o">=</span><span class="n">postop_ivp_sim</span><span class="o">.</span><span class="n">results_df</span>
<span class="n">post_ivp_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vs_2_f_is_2[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r2[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r1[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vs_8[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @is_4_f_vs_4[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r3[p] power
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>@R1[i]</th>
      <td>internal</td>
      <td>-1</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R1[p]</th>
      <td>internal</td>
      <td>6</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R2[i]</th>
      <td>internal</td>
      <td>-0.5</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R2[p]</th>
      <td>internal</td>
      <td>3</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R3[i]</th>
      <td>internal</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R3[p]</th>
      <td>internal</td>
      <td>56.3333</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@Vs_8[i]</th>
      <td>internal</td>
      <td>-2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Vs_8[p]</th>
      <td>internal</td>
      <td>17.3333</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@Is_4_f_Vs_4[c]</th>
      <td>internal</td>
      <td>0.666667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Is_4_f_Vs_4[v]</th>
      <td>internal</td>
      <td>-6</td>
      <td>V</td>
    </tr>
    <tr>
      <th>@Is_4_f_Vs_4[p]</th>
      <td>internal</td>
      <td>4</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@Vs_2_f_Is_2[i]</th>
      <td>internal</td>
      <td>-2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Vs_2_f_Is_2[p]</th>
      <td>internal</td>
      <td>52</td>
      <td>W</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="quantitive-comparison">
<h3>Quantitive comparison ¶<a class="headerlink" href="#quantitive-comparison" title="Permalink to this headline">¶</a></h3>
<p>Since our results are stored in Pandas dataframes we can make use of the power of Pandas to do data analysis to get insight into what is going on. Where below we get a merger of the two dataframes side by side for all the elements that remained the same in the circuit pre and post-transformation. And we then follow that up with color-coding of what values remained the same between the pre and post-transformation of the circuit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_post_comp</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pre_ivp_res</span><span class="p">,</span> <span class="n">post_ivp_res</span><span class="p">],</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>  <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="s1">&#39;Post&#39;</span><span class="p">])</span>
<span class="n">pre_post_comp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">Pre</th>
      <th colspan="3" halign="left">Post</th>
    </tr>
    <tr>
      <th></th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
      <th>Item_Type</th>
      <th>Value</th>
      <th>Unit</th>
    </tr>
    <tr>
      <th>Circ_Item</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>@Vs_8[i]</th>
      <td>internal</td>
      <td>-2.16667</td>
      <td>A</td>
      <td>internal</td>
      <td>-2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@Vs_8[p]</th>
      <td>internal</td>
      <td>17.3333</td>
      <td>W</td>
      <td>internal</td>
      <td>17.3333</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R1[i]</th>
      <td>internal</td>
      <td>-1.66667</td>
      <td>A</td>
      <td>internal</td>
      <td>-1</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R1[p]</th>
      <td>internal</td>
      <td>16.6667</td>
      <td>W</td>
      <td>internal</td>
      <td>6</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R2[i]</th>
      <td>internal</td>
      <td>-0.5</td>
      <td>A</td>
      <td>internal</td>
      <td>-0.5</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R2[p]</th>
      <td>internal</td>
      <td>3</td>
      <td>W</td>
      <td>internal</td>
      <td>3</td>
      <td>W</td>
    </tr>
    <tr>
      <th>@R3[i]</th>
      <td>internal</td>
      <td>0.166667</td>
      <td>A</td>
      <td>internal</td>
      <td>2.16667</td>
      <td>A</td>
    </tr>
    <tr>
      <th>@R3[p]</th>
      <td>internal</td>
      <td>0.333333</td>
      <td>W</td>
      <td>internal</td>
      <td>56.3333</td>
      <td>W</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">color_results</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>    
    <span class="n">is_equal</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Pre&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>    
    <span class="k">if</span> <span class="n">is_equal</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;background-color: lightgreen&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;background-color: yellow&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="n">pre_post_comp</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">color_results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col5{
            background-color:  lightgreen;
        }#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col5,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col0,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col1,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col2,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col3,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col4,#T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col5{
            background-color:  yellow;
        }</style><table id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819f" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" colspan=3>Pre</th>        <th class="col_heading level0 col3" colspan=3>Post</th>    </tr>    <tr>        <th class="blank level1" ></th>        <th class="col_heading level1 col0" >Item_Type</th>        <th class="col_heading level1 col1" >Value</th>        <th class="col_heading level1 col2" >Unit</th>        <th class="col_heading level1 col3" >Item_Type</th>        <th class="col_heading level1 col4" >Value</th>        <th class="col_heading level1 col5" >Unit</th>    </tr>    <tr>        <th class="index_name level0" >Circ_Item</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row0" class="row_heading level0 row0" >@Vs_8[i]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col0" class="data row0 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col1" class="data row0 col1" >-2.166667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col2" class="data row0 col2" >A</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col3" class="data row0 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col4" class="data row0 col4" >-2.166667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow0_col5" class="data row0 col5" >A</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row1" class="row_heading level0 row1" >@Vs_8[p]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col0" class="data row1 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col1" class="data row1 col1" >17.333333</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col2" class="data row1 col2" >W</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col3" class="data row1 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col4" class="data row1 col4" >17.333333</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow1_col5" class="data row1 col5" >W</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row2" class="row_heading level0 row2" >@R1[i]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col0" class="data row2 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col1" class="data row2 col1" >-1.666667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col2" class="data row2 col2" >A</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col3" class="data row2 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col4" class="data row2 col4" >-1.000000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow2_col5" class="data row2 col5" >A</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row3" class="row_heading level0 row3" >@R1[p]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col0" class="data row3 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col1" class="data row3 col1" >16.666667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col2" class="data row3 col2" >W</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col3" class="data row3 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col4" class="data row3 col4" >6.000000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow3_col5" class="data row3 col5" >W</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row4" class="row_heading level0 row4" >@R2[i]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col0" class="data row4 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col1" class="data row4 col1" >-0.500000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col2" class="data row4 col2" >A</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col3" class="data row4 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col4" class="data row4 col4" >-0.500000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow4_col5" class="data row4 col5" >A</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row5" class="row_heading level0 row5" >@R2[p]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col0" class="data row5 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col1" class="data row5 col1" >3.000000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col2" class="data row5 col2" >W</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col3" class="data row5 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col4" class="data row5 col4" >3.000000</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow5_col5" class="data row5 col5" >W</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row6" class="row_heading level0 row6" >@R3[i]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col0" class="data row6 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col1" class="data row6 col1" >0.166667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col2" class="data row6 col2" >A</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col3" class="data row6 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col4" class="data row6 col4" >2.166667</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow6_col5" class="data row6 col5" >A</td>
            </tr>
            <tr>
                        <th id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819flevel0_row7" class="row_heading level0 row7" >@R3[p]</th>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col0" class="data row7 col0" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col1" class="data row7 col1" >0.333333</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col2" class="data row7 col2" >W</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col3" class="data row7 col3" >internal</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col4" class="data row7 col4" >56.333333</td>
                        <td id="T_0fa59e2c_613c_11eb_a3fb_dfd7329e819frow7_col5" class="data row7 col5" >W</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>The results show that the part of the network that remained the same had identical currents and power through their elements. While the resistors that we transformed in accordance with the source transformations. This is due to source efficiency since the full network presents different equivalent circuits to each of the transforms and therefore different voltage, current, and power draws on each source.</p>
</div>
</div>
<div class="section" id="citations">
<h2>Citations:<a class="headerlink" href="#citations" title="Permalink to this headline">¶</a></h2>
<p>[1] ALL ABOUT ELECTRONICS. “Source transformation in network analysis,” YouTube, Dec 24, 2016. [Video file]. Available: https://youtu.be/FtEU5ZoO-fg. [Accessed: Nov 30, 2020].</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./DC_1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="DC_1_op_ohm.html" title="previous page">Getting started with Python &amp; SPICE, DC Operating Point Analysis</a>
    <a class='right-next' id="next-link" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html" title="next page">DC Sweeps</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Steven K Armour (PyLCARS)<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>