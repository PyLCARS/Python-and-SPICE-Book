
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Controlled Dependent Sources in SPICE &#8212; Python &amp; SPICE</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Thevenin’s DC Equivalent Circuit" href="DC_5_Thvenin_Norton.html" />
    <link rel="prev" title="DC Sweeps" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python & SPICE</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../needed_libraries.html">
   Dependency install instruction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="DC_1.html">
   Chapter 1 DC Simulations and Basic DC Elements with Python and SPICE
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="DC_1_op_ohm.html">
     Getting started with Python &amp; SPICE, DC Operating Point Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_1_op_ohm.html#spice-s-dc-operating-point-simulation-op">
     SPICE’s DC Operating Point simulation
     <code class="docutils literal notranslate">
      <span class="pre">
       .op
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_2_op_source_transform.html">
     Working with SKiDl elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html">
     DC Sweeps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#dc-load-sweep-of-an-ideal-voltage-source">
     DC load sweep of an Ideal Voltage source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#a-better-dc-sim-interaction">
     A Better
     <code class="docutils literal notranslate">
      <span class="pre">
       .dc
      </span>
     </code>
     Sim Interaction¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#ideal-current-source">
     Ideal Current Source¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html#first-testbench-element">
     First testbench element¶
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Controlled Dependent Sources in SPICE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#ccvs">
     CCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#enter-the-spice-transfer-function">
     Enter the SPICE transfer function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#lcapy">
     LCAPY
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#vcvs">
     VCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#cccs">
     CCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#vccs">
     VCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_5_Thvenin_Norton.html">
     Thevenin’s DC Equivalent Circuit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_5_Thvenin_Norton.html#norton-s-theorem">
     Norton’s Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DC_6_DC_MaxPower_MaxEfficiency.html">
     Maximum Power Transfer Theorem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../AC_2/AC_1.html">
   Chapter 2 AC simulations with Python and SPICE
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html">
     Capacitors and Inductors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#ac-sources">
     AC Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#v-max-fourier-terms-and-rms">
     <span class="math notranslate nohighlight">
      \(V_{max}\)
     </span>
     ,  Fourier terms, and RMS¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#single-phase-cirucit">
     Single Phase Cirucit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#two-phase-system">
     Two-Phase System¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#three-phase-four-wire-y-star-topology">
     Three Phase Four Wire Y (Star) Topology ¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_1_One-Two-Three_Phase_AC.html#three-phase-three-wire-delta-topology">
     Three Phase Three Wire
     <span class="math notranslate nohighlight">
      \(\Delta\)
     </span>
     Topology
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html">
     Basic Passive Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#first-order-cascade-filter">
     First Order Cascade filter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#second-order-filters-and-resonators">
     Second-Order Filters and resonators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AC_2/AC_2_RCL_filters.html#all-pass-filters">
     All Pass filters
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html">
   Checking tool
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#basic-elements">
   Basic Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-sinusoidalmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SinusoidalMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-pulsemixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PulseMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-exponentialmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     ExponentialMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-piecewiselinearmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PieceWiseLinearMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-singlefrequencyfmmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SingleFrequencyFMMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-amplitudemodulatedmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     AmplitudeModulatedMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-randommixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     RandomMixin
    </span>
   </code>
   Based
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/DC_1/DC_4_dependent_sources_and_tf.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PyLCARS/Python-and-SPICE-Book/issues/new?title=Issue%20on%20page%20%2FDC_1/DC_4_dependent_sources_and_tf.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PyLCARS/Python-and-SPICE-Book/master?urlpath=tree/docs/DC_1/DC_4_dependent_sources_and_tf.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Controlled Dependent Sources in SPICE
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ccvs">
   CCVS
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enter-the-spice-transfer-function">
   Enter the SPICE transfer function
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-tf">
     Using .tf
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lcapy">
   LCAPY
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vcvs">
   VCVS
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cccs">
   CCCS
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vccs">
   VCCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#citations">
     Citations:
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><strong>TODO</strong></p>
<ul class="simple">
<li><p>Clean up the lcapy usage</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Library import statements</span>

<span class="kn">from</span> <span class="nn">skidl.pyspice</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#can you say cheeky </span>
<span class="kn">import</span> <span class="nn">PySpice</span> <span class="k">as</span> <span class="nn">pspice</span>
<span class="c1">#becouse it&#39;s written by a kiwi you know</span>
<span class="kn">import</span> <span class="nn">lcapy</span> <span class="k">as</span> <span class="nn">kiwi</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">traceback</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: KICAD_SYMBOL_DIR environment variable is missing, so the default KiCad symbol libraries won&#39;t be searched.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#notebook specific loading control statements </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#tool to log notebook internals</span>
<span class="c1">#https://github.com/jrjohansson/version_information</span>
<span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> skidl, PySpice,lcapy, sympy, numpy, matplotlib, pandas, scipy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.6 64bit [GCC 7.3.0]</td></tr><tr><td>IPython</td><td>7.12.0</td></tr><tr><td>OS</td><td>Linux 4.19.104 microsoft standard x86_64 with debian bullseye sid</td></tr><tr><td>skidl</td><td>0.0.31.dev0</td></tr><tr><td>PySpice</td><td>1.4.3</td></tr><tr><td>lcapy</td><td>0.70</td></tr><tr><td>sympy</td><td>1.6.2</td></tr><tr><td>numpy</td><td>1.18.1</td></tr><tr><td>matplotlib</td><td>3.3.0</td></tr><tr><td>pandas</td><td>1.1.4</td></tr><tr><td>scipy</td><td>1.4.1</td></tr><tr><td colspan='2'>Sun Jan 10 17:08:13 2021 MST</td></tr></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DC_1_Codes</span> <span class="kn">import</span> <span class="n">dc_ease</span><span class="p">,</span> <span class="n">get_skidl_spice_ref</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="controlled-dependent-sources-in-spice">
<h1>Controlled Dependent Sources in SPICE<a class="headerlink" href="#controlled-dependent-sources-in-spice" title="Permalink to this headline">¶</a></h1>
<p>Since we have current and voltage sources and can read voltage and current then there are naturally four linearly dependent controlled souces. And all four of them have their own quirkiness in implementing them in SPICE. We will here go over all four of them starting with the example from ALL ABOUT ELECTRONICS’ “Independent and Dependent (Controlled) Sources” with the rest being examples created by this author.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;SfKw8bHk7-o&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">306</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/SfKw8bHk7-o?start=306"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
</div>
<div class="section" id="ccvs">
<h1>CCVS<a class="headerlink" href="#ccvs" title="Permalink to this headline">¶</a></h1>
<p>A Current-Controlled-Voltage-Souce (CCVS) is a source that reads the current through an element and then scales with a gain [V/A], which has the special name transresistance, owing to the units, to the dependent voltage source. Where to measure for the current controlled part we read the current through the element via a series ammeter with polarity opposite to the direction of the current flow we wish to measure. It is functionally equivalent to a Shunt-Shunt feedback circuit. Alais we still do not have a fundamental circuit element that acts as a CCVS. So as ALL ABOUT ELECTRONICS showed we have to build VCVS out of an assembly of fundamental circuit elements. We construct the following example circuit contain a CCVS, analyze it. We will measure the circuit first by doing a dc sweep of the voltage source to try to understand the transresistance gain of the circuit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">r5</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r10</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ix</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;ix&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ccvs</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="n">transresistance</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">ix</span><span class="p">))</span>

<span class="n">ix</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">gnd</span>

<span class="n">ccvs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gnd</span>
<span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r10</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">r10</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R10 N_4 0 10Ohm
R2 N_3 N_1 2Ohm
R5 N_2 N_3 5Ohm
H1 N_2 0 Vix 2
Vix N_1 0 0V
Vvs N_4 N_3 5V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_sweep</span><span class="o">=</span><span class="n">dc_ease</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">sweep_DF</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">sweep_DF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">vs</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">clean_table</span><span class="p">()</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">sweep_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Start</th>
      <th>Stop</th>
      <th>Step</th>
    </tr>
    <tr>
      <th>Element</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Vvs</th>
      <td>0</td>
      <td>10</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_sweep</span><span class="o">.</span><span class="n">do_dc_sim</span><span class="p">(</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">do_dc_intsim</span><span class="p">(</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">quick_plot</span><span class="p">()</span>
<span class="n">dc_sweep</span><span class="o">.</span><span class="n">quick_plot</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r5[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r10[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @r2[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vix[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @vvs[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit is None for @h1[p] power
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/mnt/c/Users/strin/Insync/string12oil@gmail.com/Google Drive/MyProjects/python-spice/Python-and-SPICE-Book/DC_1/DC_1_Codes.py:638: UserWarning: Tight layout not applied. tight_layout cannot make axes height small enough to accommodate all axes decorations
  plt.tight_layout()
</pre></div>
</div>
<img alt="../_images/DC_4_dependent_sources_and_tf_9_7.png" src="../_images/DC_4_dependent_sources_and_tf_9_7.png" />
<img alt="../_images/DC_4_dependent_sources_and_tf_9_8.png" src="../_images/DC_4_dependent_sources_and_tf_9_8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_sweep</span><span class="o">.</span><span class="n">dc_resultsNB_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N_4_[V]</th>
      <th>N_3_[V]</th>
      <th>N_1_[V]</th>
      <th>N_2_[V]</th>
      <th>Vix_[A]</th>
      <th>Vvs_[A]</th>
    </tr>
    <tr>
      <th>Vvs</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>0.833333</td>
      <td>-0.166667</td>
      <td>0.0</td>
      <td>-0.166667</td>
      <td>0.083333</td>
      <td>0.083333</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>1.666667</td>
      <td>-0.333333</td>
      <td>0.0</td>
      <td>-0.333333</td>
      <td>0.166667</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>2.500000</td>
      <td>-0.500000</td>
      <td>0.0</td>
      <td>-0.500000</td>
      <td>0.250000</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>3.333333</td>
      <td>-0.666667</td>
      <td>0.0</td>
      <td>-0.666667</td>
      <td>0.333333</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>4.166667</td>
      <td>-0.833333</td>
      <td>0.0</td>
      <td>-0.833333</td>
      <td>0.416667</td>
      <td>0.416667</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>5.000000</td>
      <td>-1.000000</td>
      <td>0.0</td>
      <td>-1.000000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>5.833333</td>
      <td>-1.166667</td>
      <td>0.0</td>
      <td>-1.166667</td>
      <td>0.583333</td>
      <td>0.583333</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>6.666667</td>
      <td>-1.333333</td>
      <td>0.0</td>
      <td>-1.333333</td>
      <td>0.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>7.500000</td>
      <td>-1.500000</td>
      <td>0.0</td>
      <td>-1.500000</td>
      <td>0.750000</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>8.333333</td>
      <td>-1.666667</td>
      <td>0.0</td>
      <td>-1.666667</td>
      <td>0.833333</td>
      <td>0.833333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_sweep</span><span class="o">.</span><span class="n">dc_resultsINT_DF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R10[i]_[A]</th>
      <th>R10[p]_[W]</th>
      <th>R2[i]_[A]</th>
      <th>R2[p]_[W]</th>
      <th>R5[i]_[A]</th>
      <th>R5[p]_[W]</th>
      <th>H1[i]_[A]</th>
      <th>H1[v]_[V]</th>
      <th>H1[p]_[W]</th>
      <th>Vix[i]_[A]</th>
      <th>Vix[p]_[W]</th>
      <th>Vvs[i]_[A]</th>
      <th>Vvs[p]_[W]</th>
    </tr>
    <tr>
      <th>Vvs</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-0.000000</td>
      <td>-0.0</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>0.083333</td>
      <td>0.069444</td>
      <td>-0.083333</td>
      <td>0.013889</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.166667</td>
      <td>-0.0</td>
      <td>0.083333</td>
      <td>0.0</td>
      <td>0.083333</td>
      <td>0.083333</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>0.166667</td>
      <td>0.277778</td>
      <td>-0.166667</td>
      <td>0.055556</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.333333</td>
      <td>-0.0</td>
      <td>0.166667</td>
      <td>0.0</td>
      <td>0.166667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>0.250000</td>
      <td>0.625000</td>
      <td>-0.250000</td>
      <td>0.125000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.500000</td>
      <td>-0.0</td>
      <td>0.250000</td>
      <td>0.0</td>
      <td>0.250000</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>0.333333</td>
      <td>1.111111</td>
      <td>-0.333333</td>
      <td>0.222222</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.666667</td>
      <td>-0.0</td>
      <td>0.333333</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>0.416667</td>
      <td>1.736111</td>
      <td>-0.416667</td>
      <td>0.347222</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.833333</td>
      <td>-0.0</td>
      <td>0.416667</td>
      <td>0.0</td>
      <td>0.416667</td>
      <td>2.083333</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>0.500000</td>
      <td>2.500000</td>
      <td>-0.500000</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.000000</td>
      <td>-0.0</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>0.500000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>0.583333</td>
      <td>3.402778</td>
      <td>-0.583333</td>
      <td>0.680556</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.166667</td>
      <td>-0.0</td>
      <td>0.583333</td>
      <td>0.0</td>
      <td>0.583333</td>
      <td>4.083333</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>0.666667</td>
      <td>4.444444</td>
      <td>-0.666667</td>
      <td>0.888889</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.333333</td>
      <td>-0.0</td>
      <td>0.666667</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>5.333333</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>0.750000</td>
      <td>5.625000</td>
      <td>-0.750000</td>
      <td>1.125000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.500000</td>
      <td>-0.0</td>
      <td>0.750000</td>
      <td>0.0</td>
      <td>0.750000</td>
      <td>6.750000</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>0.833333</td>
      <td>6.944444</td>
      <td>-0.833333</td>
      <td>1.388889</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.666667</td>
      <td>-0.0</td>
      <td>0.833333</td>
      <td>0.0</td>
      <td>0.833333</td>
      <td>8.333333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tranres_data</span><span class="o">=</span><span class="n">dc_sweep</span><span class="o">.</span><span class="n">dc_resultsNB_DF</span><span class="p">[[</span><span class="n">node</span><span class="p">(</span><span class="n">ccvs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_[V]&#39;</span><span class="p">,</span> <span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_[A]&#39;</span><span class="p">]]</span>
<span class="n">Tranres_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N_2_[V]</th>
      <th>Vix_[A]</th>
    </tr>
    <tr>
      <th>Vvs</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>-0.166667</td>
      <td>0.083333</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>-0.333333</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>-0.500000</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>-0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>-0.833333</td>
      <td>0.416667</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>-1.000000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>-1.166667</td>
      <td>0.583333</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>-1.333333</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>-1.500000</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>-1.666667</td>
      <td>0.833333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tranres_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Vix_[A]&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_[V]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_[V]&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DC_4_dependent_sources_and_tf_13_0.png" src="../_images/DC_4_dependent_sources_and_tf_13_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MeasTranRes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Tranres_data</span><span class="p">[</span><span class="s1">&#39;Vix_[A]&#39;</span><span class="p">],</span> <span class="n">Tranres_data</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_[V]&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">MeasTranRes</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DC_4_dependent_sources_and_tf_14_0.png" src="../_images/DC_4_dependent_sources_and_tf_14_0.png" />
</div>
</div>
</div>
<div class="section" id="enter-the-spice-transfer-function">
<h1>Enter the SPICE transfer function<a class="headerlink" href="#enter-the-spice-transfer-function" title="Permalink to this headline">¶</a></h1>
<p>Why isn’t it 2; because we are looking at the effect of the whole circuit on the output node and input current. So what we need is a way to find the transfer function in a more controlled manner, enter the .tf. The transfer function is not misnamed. Normally we think Transfer function in EE we think of something with information about poles and zeros. While we will get that in the next chapter with .pz but here where still in DC. And so recalling that a transfer function also has a fundamental gain “<span class="math notranslate nohighlight">\(K\)</span>” called in terms of circuit’s DC gain or intrinsic gain. That is what .tf measures along with the input and output resistance. However, .tf is one of the most mysterious and honestly pain the butt SPICE analysis. But besides finding <span class="math notranslate nohighlight">\(K\)</span> .tf also gives us the DC resistance (so pure resistance only) of the input and output of the measurement. For a refresher for the importance of this see ALL ABOUT ELECTRONICS video on “What is Impedance? The Input Impedance and Output Impedance Explained”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;7jw2_x8dyQ8&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">290</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/7jw2_x8dyQ8?start=290"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<p>I will say that that the rules of thumb about the input impedance being as high as possible and the output impedance being as low as possible are based on basic limit analysis for voltage. For in real applications we pull and source as much voltage and current as is optimal for both the source and to meet the load operating requirements. We will discuss this in much further detail as we proceed in this book.</p>
<div class="section" id="using-tf">
<h2>Using .tf<a class="headerlink" href="#using-tf" title="Permalink to this headline">¶</a></h2>
<p>In order to use this .tf we must measure from a single source. Then to measure an output voltage we can tell it the output node pair via <code class="docutils literal notranslate"><span class="pre">V(&lt;node1&gt;,</span> <span class="pre">&lt;node2&gt;)</span></code> or give it another single voltage source. In the case of measuring the output current, we must give it a voltage source to get the current from via the SPICE ammeter trick. Lets now apply this to our CCVS example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">r5</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r10</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ix</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;ix&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ccvs</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="n">transresistance</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">ix</span><span class="p">))</span>

<span class="n">itest</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;test_source&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_A</span><span class="p">)</span>

<span class="n">itest</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span><span class="p">,</span> <span class="n">ix</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>

<span class="n">ix</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">ccvs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gnd</span>
<span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r10</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">r10</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R10 N_5 0 10Ohm
R2 N_4 N_2 2Ohm
R5 N_3 N_4 5Ohm
H1 N_3 0 Vix 2
Vix N_2 N_1 0V
Itest_source N_1 0 1A
Vvs N_5 N_4 5V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">dc_tf</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="s1">&#39;V(N3, 0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Itest_source&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_tf</span><span class="o">.</span><span class="n">nodes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;output_impedance_at_V(n3,0)&#39;: WaveForm output_impedance_at_V(n3,0) [1.]@V,
 &#39;itest_source#Input_impedance&#39;: WaveForm itest_source#Input_impedance [4.]@V,
 &#39;Transfer_function&#39;: WaveForm Transfer_function [0.]@V}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dc_tf</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>output_impedance_at_V(n3,0) [1.]
itest_source#Input_impedance [4.]
Transfer_function [0.]
</pre></div>
</div>
</div>
</div>
<p>So .tf can be a pain to use further depenind on the compintion of inputs and outputs being meassured can yield diffint output statments. So we have already abstricted this away so that it’s much easter to use and gives presnitne that outputs coonsisintly. And as we will dicues on in the next section is has real limitations and is just being introduced here. However, that is not to say it donst have use. As we will see when we start working with transiters .tf will have emmince usage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a DC_1_Codes.py</span>

<span class="c1">#chapter 1 section 4 easy_tf class</span>
<span class="c1"># class to make using the SPICE .tf function so much less of a pain</span>
<span class="c1"># has methods to all four case usages</span>

<span class="k">class</span> <span class="nc">easy_tf</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraper tool for ngspice&#39;s to make performing trnafer function (.tf) anyslis</span>
<span class="sd">    a lot less of a headeach</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">circ_netlist_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Intialztoin method</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            circ_netlist_obj (pspice.Spice.Netlist.Circuit): the Netlist circuit produced </span>
<span class="sd">                from SKiDl&#39;s `generate_netlist()`</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            creates a simation from the netlist in `self.sim`</span>
<span class="sd">        </span>
<span class="sd">        TODO: add kwargs to pass to sim creation</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">=</span><span class="n">circ_netlist_obj</span>
        <span class="c1">#create the sim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circ_netlist_obj</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
    
    
    <span class="k">def</span> <span class="nf">dc_voltage_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_voltage_source</span><span class="p">,</span> <span class="n">output_node_pos</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">output_node_neg</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">output_voltag_source</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to perfom .tf to measur an input voltage souce to either a node pair</span>
<span class="sd">        wich is eqivlint to the SPICE statoemt</span>
<span class="sd">        ```</span>
<span class="sd">        .tf(V(&lt;node_1&gt;, &lt;node_2&gt;) , &lt;voltage_souce_in&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        where `&lt;node_2&gt;` can be ommited where then seconed node is always the ground node</span>
<span class="sd">        or a seconed output voltage souce can be used in wich case this meothd is then eqivlitnt to </span>
<span class="sd">        ```</span>
<span class="sd">        .tf(&lt;voltage_souce_out&gt; , &lt;voltage_souce_in&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        it will retun the input resitince looking from the input souce to the output measure, the ouput resitince looking</span>
<span class="sd">        from the ouput meassue to the input voltage souce, and finaly the voltage gain of the input voltage souce to ouput meassure</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input_voltage_source (SKiDl Linear Voltage Souce obj): the input voltage souce given as a SKiDl linear depened voltage souce like</span>
<span class="sd">                object. </span>
<span class="sd">            </span>
<span class="sd">            output_node_pos (SKiDL net obj or SPICE net name str; None): If using a voltage souce as the ouput measurment this may be left as None</span>
<span class="sd">                else must be filled in with eather a SPICE net name as a string or a SKiDl net complint object where the SPICE</span>
<span class="sd">                net name can be exstracted from</span>
<span class="sd">            </span>
<span class="sd">            output_node_neg (SKiDL net obj or SPICE net name str; &#39;0&#39;): If using a voltage souce as the ouput measurment this may be left as &#39;0&#39; else</span>
<span class="sd">                if using measuing from a node pair must be eather a SPICE net name as a string or a SKiDl net complint object where the SPICE</span>
<span class="sd">                net name can be exstracted from. If left &#39;0&#39; the measured seconed node of the node pair will be the ground net &#39;0&#39;</span>
<span class="sd">            </span>
<span class="sd">            output_voltag_source (SKiDl Linear Voltage Souce obj; None): If meauing the ouput from a node pair (`output_node_pos` &amp; `output_node_neg`) this may be </span>
<span class="sd">                left as None. Else when measuing ouput voltge from a voltage souce provined a SKiDl linear depened voltage souce like</span>
<span class="sd">                object.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            results from this usge of .tf to measre the voltage to voltage gain will be stored in `self.vg_results`</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#do assertion check that the input is a voltage source and </span>
        <span class="k">assert</span> <span class="n">input_voltage_source</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;voltage gain must be sourced from a voltage source&#39;</span>
        <span class="n">input_src</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">input_voltage_source</span><span class="p">)</span>
        
        
        
        <span class="c1">#deal with source output</span>
        <span class="k">if</span> <span class="n">output_voltag_source</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">output_node_pos</span><span class="o">!=</span><span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">output_node_neg</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s1">&#39;If output measurment is from a `V` source, nodes node output location will be ignored&#39;</span><span class="p">)</span>
            <span class="c1">#creat the output statment</span>
            <span class="n">output_src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V({get_skidl_spice_ref(output_voltag_source)})&#39;</span>
            <span class="c1">#run the .tf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">output_src</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>
            
            
            <span class="n">output_src</span><span class="o">=</span><span class="n">output_src</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="c1">#create storage</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>
            
            <span class="c1">#store results</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Vgain&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[V/V]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>
            
        <span class="c1">#deal with node ouput</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#check the pos node</span>
            <span class="k">assert</span> <span class="n">output_node_pos</span><span class="o">!=</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;output node must be specfied when not using a `V` source&#39;</span>
            <span class="c1">#TODO need to make this assertion stronger to the cirucit under test</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;`output_node_pos` must be a SKiDl net or a node string&#39;</span> 
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">pos_node</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pos_node</span><span class="o">=</span><span class="n">output_node_pos</span>
            
            <span class="c1">#check the neg node</span>
            <span class="c1">#TODO need to make this assertion stronger to the cirucit under test</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;`output_node_neg` must be a SKiDl net or a node string&#39;</span> 
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">neg_node</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">neg_node</span><span class="o">=</span><span class="n">output_node_neg</span>
                
            <span class="c1">#formulate the output statment</span>
            <span class="n">output_src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V(</span><span class="si">{pos_node}</span><span class="s1">, </span><span class="si">{neg_node}</span><span class="s1">)&#39;</span>
            
            <span class="c1">#run the tf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">output_src</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>
            
            <span class="n">output_src</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">output_src</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
            <span class="c1">#store results</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Vgain&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[V/V]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vg_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>

        
            
        

        
    
    <span class="k">def</span> <span class="nf">dc_current_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_current_source</span><span class="p">,</span> <span class="n">output_ammeter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to perfom .tf to measur a input current souce to ouput ammeter</span>
<span class="sd">        </span>
<span class="sd">        wich is eqivlint to the SPICE statoemt</span>
<span class="sd">        ```</span>
<span class="sd">        .tf(I(&lt;output_ammeter&gt;) , &lt;input_current_source&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        it will retun the input resitince looking from the input souce to the output measure, the ouput resitince looking</span>
<span class="sd">        from the ouput meassue to the input current souce, and finaly the current gain of the input current souce to ouput meassure</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input_current_source (SKiDl Linear Current Souce obj): the input current souce given as a SKiDl linear depened current souce like</span>
<span class="sd">                object. </span>
<span class="sd">           </span>
<span class="sd">            output_ammeter (SKiDl Linear Voltage Souce obj; None): This may be a already esisitng linear voltage souce or a 0V linear voltage souce </span>
<span class="sd">                SPICE ammeater add speficly to meassure the current</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            results from this usge of .tf to measre the current to current gain will be stored in `self.ig_results`</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">input_current_source</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;current gain must be sourced from a current source&#39;</span>
        <span class="k">assert</span> <span class="n">output_ammeter</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;current gain must be meassured from a voltage source&#39;</span>
        
        <span class="n">input_src</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">input_current_source</span><span class="p">)</span>
        <span class="n">output_src</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">output_ammeter</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;I(</span><span class="si">{output_src}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ig_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>
            
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ig_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Igain&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[A/A]&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ig_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;Output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ig_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>


    
    <span class="k">def</span> <span class="nf">dc_transresistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_current_source</span><span class="p">,</span> <span class="n">output_node_pos</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">output_node_neg</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">output_voltag_source</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to perfom .tf to fine the output voltge to input current.</span>
<span class="sd">        via measuring from an input current souce to either a node pair</span>
<span class="sd">        wich is eqivlint to the SPICE statoemt</span>
<span class="sd">        ```</span>
<span class="sd">        .tf(V(&lt;node_1&gt;, &lt;node_2&gt;) , &lt;current_souce_in&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        where `&lt;node_2&gt;` can be ommited where then seconed node is always the ground node</span>
<span class="sd">        or a seconed output voltage souce can be used in wich case this meothd is then eqivlitnt to </span>
<span class="sd">        ```</span>
<span class="sd">        .tf(&lt;voltage_souce_out&gt; , &lt;current_souce_in&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        it will retun the input resitince looking from the input souce to the output measure, the ouput resitince looking</span>
<span class="sd">        from the ouput meassue to the input voltage souce, and finaly the transriseiince [A/V] gain of the input current souce to ouput meassure</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input_voltage_source (SKiDl Linear Current Souce obj): the input current souce given as a SKiDl linear depened current souce like</span>
<span class="sd">                object. </span>
<span class="sd">            </span>
<span class="sd">            output_node_pos (SKiDL net obj or SPICE net name str; None): If using a voltage souce as the ouput measurment this may be left as None</span>
<span class="sd">                else must be filled in with eather a SPICE net name as a string or a SKiDl net complint object where the SPICE</span>
<span class="sd">                net name can be exstracted from</span>
<span class="sd">            </span>
<span class="sd">            output_node_neg (SKiDL net obj or SPICE net name str; &#39;0&#39;): If using a voltage souce as the ouput measurment this may be left as &#39;0&#39; else</span>
<span class="sd">                if using measuing from a node pair must be eather a SPICE net name as a string or a SKiDl net complint object where the SPICE</span>
<span class="sd">                net name can be exstracted from. If left &#39;0&#39; the measured seconed node of the node pair will be the ground net &#39;0&#39;</span>
<span class="sd">            </span>
<span class="sd">            output_voltag_source (SKiDl Linear Voltage Souce obj; None): If meauing the ouput from a node pair (`output_node_pos` &amp; `output_node_neg`) this may be </span>
<span class="sd">                left as None. Else when measuing ouput voltge from a voltage souce provined a SKiDl linear depened voltage souce like</span>
<span class="sd">                object.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            results from this usge of .tf to measre the current to voltage gain will be stored in `self.tr_results`</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">input_current_source</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;transresistance gain must be sourced from a current source&#39;</span>
        <span class="n">input_src</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">input_current_source</span><span class="p">)</span>
        
        <span class="c1">#deal with node or source output</span>
        <span class="k">if</span> <span class="n">output_voltag_source</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">output_node_pos</span><span class="o">!=</span><span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">output_node_neg</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s1">&#39;If output measurment is from a `V` source, nodes node output location will be ignored&#39;</span><span class="p">)</span>

            <span class="n">output_src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V({get_skidl_spice_ref(output_voltag_source)})&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">output_src</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>
            
            
            <span class="n">output_src</span><span class="o">=</span><span class="n">output_src</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>
            
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Transresistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[V/A]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>
            
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">output_node_pos</span><span class="o">!=</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;output node must be specfied when not using a `V` source&#39;</span>
            <span class="c1">#TODO need to make this assertion stronger to the cirucit under test</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;`output_node_pos` must be a SKiDl net or a node string&#39;</span> 
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">pos_node</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">output_node_pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pos_node</span><span class="o">=</span><span class="n">output_node_pos</span>
            
            <span class="c1">#TODO need to make this assertion stronger to the cirucit under test</span>
            <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;`output_node_neg` must be a SKiDl net or a node string&#39;</span> 
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;&lt;class &#39;skidl.Net.Net&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">neg_node</span><span class="o">=</span><span class="n">node</span><span class="p">(</span><span class="n">output_node_neg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">neg_node</span><span class="o">=</span><span class="n">output_node_neg</span>
                
                
            <span class="n">output_src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V(</span><span class="si">{pos_node}</span><span class="s1">, </span><span class="si">{neg_node}</span><span class="s1">)&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_src</span><span class="o">=</span><span class="n">output_src</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">output_src</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>
            
            <span class="n">output_src</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">output_src</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Transresistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[V/A]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">dc_transconductance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_voltage_source</span><span class="p">,</span> <span class="n">output_ammeter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to perfom .tf to measur a input voltage souce to an ouput ammeater</span>
<span class="sd">        </span>
<span class="sd">        wich is eqivlint to the SPICE statoemt</span>
<span class="sd">        ```</span>
<span class="sd">        .tf(I(&lt;output_ammeter&gt;) , &lt;input_voltage_source&gt;)</span>
<span class="sd">        ```</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        it will retun the input resitince looking from the input souce to the output measure, the ouput resitince looking</span>
<span class="sd">        from the ouput meassue to the input current souce, and finaly the transconductance gain of the input current souce to ouput meassure</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input_voltage_source (SKiDl Linear Voltage Souce obj): the input Voltage souce given as a SKiDl linear depened Voltage souce like</span>
<span class="sd">                object. </span>
<span class="sd">           </span>
<span class="sd">            output_ammeter (SKiDl Linear Voltage Souce obj; None): This may be a already esisitng linear voltage souce or a 0V linear voltage souce </span>
<span class="sd">                SPICE ammeater add speficly to meassure the current</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            results from this usge of .tf to measre the current to current gain will be stored in `self.tc_results`</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">input_voltage_source</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;transconductance gain must be sourced from a voltage source&#39;</span>
        
        <span class="n">input_src</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">input_voltage_source</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">output_ammeter</span><span class="o">.</span><span class="n">ref_prefix</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;transconductance gain must be meassured from a voltage source&#39;</span>

        <span class="n">output_src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;I({get_skidl_spice_ref(output_ammeter)})&#39;</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">output_src</span><span class="p">,</span> <span class="n">input_src</span><span class="p">)</span>


        <span class="n">output_src</span><span class="o">=</span><span class="n">output_src</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tc_results</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_res</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;Transfer_function&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tc_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;DC_Transconductance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{output_src}</span><span class="s1">/</span><span class="si">{input_src}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[A/V]&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;Input_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tc_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Input_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">input_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;Output_impedance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tc_results</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Output_resistance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">output_src</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[Ohm]&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unexspected addintal outputs `{k, v}`&#39;</span><span class="p">)</span>
    
        
</pre></div>
</div>
</div>
</div>
<p>Start testing <code class="docutils literal notranslate"><span class="pre">easy_tf</span></code> with the exisitng cirucit used for CCVS exsample to test <code class="docutils literal notranslate"><span class="pre">easy_tf</span></code> <code class="docutils literal notranslate"><span class="pre">.dc_voltage_gain</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">=</span><span class="n">easy_tf</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_voltage_gain</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">output_voltag_source</span><span class="o">=</span><span class="n">ix</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">vg_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vix</td>
      <td>1</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>15</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Vgain</th>
      <td>Vix/Vvs</td>
      <td>0</td>
      <td>[V/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_voltage_gain</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">vg_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>(N2-0)</td>
      <td>1</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>15</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Vgain</th>
      <td>(N2-0)/Vvs</td>
      <td>0</td>
      <td>[V/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_voltage_gain</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">(</span><span class="n">r5</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]))</span>
<span class="n">test</span><span class="o">.</span><span class="n">vg_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>(N2-N_4)</td>
      <td>4.33333</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>15</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Vgain</th>
      <td>(N2-N_4)/Vvs</td>
      <td>0.333333</td>
      <td>[V/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>modify the ccvs example with a current source to test the other methods (modes) of .tf measurement</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">r5</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">r10</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">5</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ix</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;ix&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="n">ccvs</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="n">transresistance</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">ix</span><span class="p">))</span>

<span class="n">itest</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;test_source&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_A</span><span class="p">)</span>

<span class="n">itest</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span><span class="p">,</span> <span class="n">ix</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>

<span class="n">ix</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">ccvs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gnd</span>
<span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">r5</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r10</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">r10</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">test</span><span class="o">=</span><span class="n">easy_tf</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">dc_current_gain</span><span class="p">(</span><span class="n">itest</span><span class="p">,</span> <span class="n">vs</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">ig_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R10 N_5 0 10Ohm
R2 N_4 N_2 2Ohm
R5 N_3 N_4 5Ohm
H1 N_3 0 Vix 2
Vix N_2 N_1 0V
Itest_source N_1 0 1A
Vvs N_5 N_4 5V
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vvs</td>
      <td>1e+20</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Itest_source</td>
      <td>4</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Igain</th>
      <td>Vvs/Itest_source</td>
      <td>0.2</td>
      <td>[A/A]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_transresistance</span><span class="p">(</span><span class="n">itest</span><span class="p">,</span> <span class="n">output_voltag_source</span><span class="o">=</span><span class="n">vs</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">tr_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vvs</td>
      <td>1</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Itest_source</td>
      <td>4</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Transresistance</th>
      <td>Vvs/Itest_source</td>
      <td>0</td>
      <td>[V/A]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_transresistance</span><span class="p">(</span><span class="n">itest</span><span class="p">,</span> <span class="s1">&#39;N5&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">tr_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>(N5-0)</td>
      <td>1</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Itest_source</td>
      <td>4</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Transresistance</th>
      <td>(N5-0)/Itest_source</td>
      <td>0</td>
      <td>[V/A]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">dc_transconductance</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">ix</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">tc_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vix</td>
      <td>1e+20</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>15</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Transconductance</th>
      <td>Vix/Vvs</td>
      <td>0</td>
      <td>[A/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that our tool to handle the .tf <code class="docutils literal notranslate"><span class="pre">easy_tf</span></code> makes working with the .tf function a lot easer and gives a much more consisitnt ouput record then using .tf alone</p>
</div>
</div>
<div class="section" id="lcapy">
<h1>LCAPY<a class="headerlink" href="#lcapy" title="Permalink to this headline">¶</a></h1>
<p>Lcapy is the work of a new zealand profices at the unverity of cantupry, hence the ailes of kiwi since we done want clashing names spice with cirucit as it allies in it’s docs. Lcapy is not a cirucit simulator insted its one part linear anyliticl cirucit anylsis tool and one part schmitcs drawing tool via a wrarping of LaTeX’s alsdkjflj cirucit drawing tool. In this section we will just use is schmatic draing features. Though it’s ability to perform clautiona agines netlist via anylistc genrating the modfied nodal matrix (wich is part of what SPICE does) are also of great value.</p>
</div>
<div class="section" id="vcvs">
<h1>VCVS<a class="headerlink" href="#vcvs" title="Permalink to this headline">¶</a></h1>
<p>A Voltage-Controled-Voltage-Souce (VCVS) is a souce that reads the differintal voltage between two nodes and then scales that gain [V/V] to the depenetet voltage souce. It is funtinaly equivlint to a Sereis-Shunt feedback cirucit. Alais we still do not have a fundmental cirucit elelemtn that acts as a VCVS. So as ALL ABOUT ELELCTRONICS showed we have to build VCVS out of assemply of fundmantal cirucit elelemtns. We constuct the fillowing exsample ciricut contina a vcvs, anylize it and show its sshmatic with lacapy just below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span> <span class="n">net_2</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">);</span> <span class="n">net_3</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">);</span> <span class="n">net_4</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

<span class="n">vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_kOhm</span><span class="p">);</span> <span class="n">r1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">net_2</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_kOhm</span><span class="p">);</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_2</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">500</span><span class="nd">@u_Ohm</span><span class="p">);</span> <span class="n">r3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_3</span><span class="p">,</span> <span class="n">net_4</span>
<span class="n">r4</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e16</span><span class="p">);</span> <span class="n">r4</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_4</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">vcvs</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">gain</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span> <span class="n">vcvs</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">net_2</span><span class="p">,</span> <span class="n">gnd</span><span class="p">;</span> <span class="n">vcvs</span><span class="p">[</span><span class="s1">&#39;op&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">net_3</span><span class="p">,</span> <span class="n">gnd</span>


<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">test</span><span class="o">=</span><span class="n">easy_tf</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">dc_voltage_gain</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">node</span><span class="p">(</span><span class="n">net_4</span><span class="p">),</span> <span class="n">node</span><span class="p">(</span><span class="n">gnd</span><span class="p">))</span>
<span class="n">test</span><span class="o">.</span><span class="n">vg_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R1 1 2 1kOhm
R2 2 0 2kOhm
R3 3 4 500Ohm
E1 3 0 2 0 5
Ropen 4 0 1e+16
Vvs 1 0 50V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>(4-0)</td>
      <td>500</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>3000</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Vgain</th>
      <td>(4-0)/Vvs</td>
      <td>3.33333</td>
      <td>[V/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vcvs_exc</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vvs 1 0; down&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R1 1 2; right&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R2 2 0_1; down, v=V_</span><span class="si">{in}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1 0_2; right&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;E1 3 0_2 2 0_1; down, l=AV_</span><span class="si">{in}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R3 3 4; right&#39;</span><span class="p">)</span>
<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_2 0_3; right&#39;</span><span class="p">)</span>



<span class="n">vcvs_exc</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DC_4_dependent_sources_and_tf_42_0.png" src="../_images/DC_4_dependent_sources_and_tf_42_0.png" />
</div>
</div>
</div>
<div class="section" id="cccs">
<h1>CCCS<a class="headerlink" href="#cccs" title="Permalink to this headline">¶</a></h1>
<p>A Current-Contorled-Current-Source (CCCS) is a source that read the current throgh an element and then scales that gain [A/A] to the dependent current souce. Where agin for any current controled souce we read the current throught the element via a sereis ammeater with pollary opbisite to the direction of the current flow we wish to meassure. It is funtinaly equivlint to a Shunt-Series feedback cirucit. And as ALL ABOUT ELELCTICS alluded to this is equivlint to the small signal behavior of a BJT. We constuct the fillowing exsample ciricut contina a CCCS, anylize it and show its sshmatic with lacapy just below. Note that for .tf to meassure current it must have an ammeter to read from so we will add a SPICE ammeater to the output side of our cirucit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span> <span class="n">net_2</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="n">cs</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">dc_value</span><span class="o">=</span><span class="mi">20</span><span class="nd">@u_mA</span><span class="p">);</span> <span class="n">cs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span><span class="p">,</span> <span class="n">net_1</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span> <span class="n">r1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">75</span><span class="p">);</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span>
<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">75</span><span class="p">);</span> <span class="n">r3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_2</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r4</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span> <span class="n">r4</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_2</span> <span class="p">,</span> <span class="n">gnd</span>

<span class="c1">#add the CCCS sens ammeater</span>
<span class="n">isens</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;sens&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="c1">#polraty needs to be opsiste of current measure direction</span>
<span class="n">isens</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span><span class="p">,</span> <span class="n">r2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1">#add another ammeater this time for .tf to read an ouput current</span>
<span class="n">iout</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;out_amm&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">iout</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_2</span>

<span class="c1">#add the CCCS specfiying the contorl ammmeater</span>
<span class="n">cccs</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;_Ai&#39;</span><span class="p">,</span> <span class="n">current_gain</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">isens</span><span class="p">))</span>
<span class="c1">#hook up the output of the CCCS</span>
<span class="n">cccs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">iout</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">gnd</span>



<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">test</span><span class="o">=</span><span class="n">easy_tf</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">dc_current_gain</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">iout</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">ig_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R1 1 0 50
R2 1 N_1 75
R3 2 0 75
R4 2 0 50
I1 0 1 20mA
F_Ai N_2 0 Vsens 12
Vout_amm 2 N_2 0V
Vsens 0 N_1 0V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vout_amm</td>
      <td>1e+20</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>I1</td>
      <td>30</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Igain</th>
      <td>Vout_amm/I1</td>
      <td>-4.8</td>
      <td>[A/A]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the lcapy schemaitc below the ammeater for reading the control current and output current for .tf are explicilty shown as ammeaters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cccs_exc</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>

<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;I1 0 1; up&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1 1_1; right&#39;</span><span class="p">)</span>

<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R1 1_1 0_1; down&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 1_1 1_2; right&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1 0_2; right&#39;</span><span class="p">)</span>

<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R2 1_2 N_1; down&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AM_sens N_1 0_2; down&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_2 0_3; right=1.8&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;F_Ai 0_3 N_2 AM_sens; up, l=12Vsens&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AMout_amm N_2 2; right=1.5&#39;</span><span class="p">)</span>


<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2 2_1; right&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_3 0_4; right=1.5&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R3 2_1 0_4; down&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2_1 2_2; right&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_4 0_5; right&#39;</span><span class="p">)</span>
<span class="n">cccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R4 2_2 0_5; down&#39;</span><span class="p">)</span>


<span class="n">cccs_exc</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DC_4_dependent_sources_and_tf_46_0.png" src="../_images/DC_4_dependent_sources_and_tf_46_0.png" />
</div>
</div>
</div>
<div class="section" id="vccs">
<h1>VCCS<a class="headerlink" href="#vccs" title="Permalink to this headline">¶</a></h1>
<p>A Voltage-Controled-Current-Souce (VCCS) is a souce that reads the differintal voltage between two nodes and then scales that gain [A/V], wich has a special name called the transconductance becouse of the units,  to the depenetet current souce. It is funtinaly equivlint to a Sereis-series feedback cirucit. And as ALL ABOUT ELECTROINCS  alluded to a VCCS is the linear aproxmation for the small signal behavior of a FET. We constuct the fillowing exsample ciricut contina a VCCS, anylize it and show its sshmatic with lacapy just below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span> <span class="n">net_2</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">);</span> <span class="n">net_3</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>

<span class="n">vs</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">50</span><span class="nd">@u_V</span><span class="p">);</span> <span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_kOhm</span><span class="p">);</span> <span class="n">r1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">net_2</span>
<span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="nd">@u_kOhm</span><span class="p">);</span> <span class="n">r2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_2</span><span class="p">,</span> <span class="n">gnd</span>

<span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">75</span><span class="p">);</span> <span class="n">r3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_3</span><span class="p">,</span> <span class="n">gnd</span>
<span class="n">r4</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span> <span class="n">r4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">net_3</span> 


<span class="c1">#create VCCS and then wire it in </span>
<span class="n">vccs</span><span class="o">=</span><span class="n">G</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;_Gm&#39;</span><span class="p">,</span>  <span class="n">current_gain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">vccs</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">]</span><span class="o">+=</span> <span class="n">net_2</span><span class="p">,</span> <span class="n">gnd</span><span class="p">;</span> <span class="n">vccs</span><span class="p">[</span><span class="s1">&#39;op&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">]</span><span class="o">+=</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">net_3</span>

<span class="c1">#ammmetr to meassure ouput current</span>
<span class="n">iammeater</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;ammeater&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="n">iammeater</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">r4</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">test</span><span class="o">=</span><span class="n">easy_tf</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">dc_transconductance</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">iammeater</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">tc_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
R1 1 2 1kOhm
R2 2 0 2kOhm
R3 3 0 75
R4 3 N_1 50
G_Gm 0 3 2 0 0.5
Vammeater N_1 0 0
Vvs 1 0 50V
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>value</th>
      <th>units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Output_resistance</th>
      <td>Vammeater</td>
      <td>1e+20</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>Input_resistance</th>
      <td>Vvs</td>
      <td>3000</td>
      <td>[Ohm]</td>
    </tr>
    <tr>
      <th>DC_Transconductance</th>
      <td>Vammeater/Vvs</td>
      <td>0.2</td>
      <td>[A/V]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vccs_exc</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vvs 1 0; down&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R1 1 2; right&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R2 2 0_1; down, v=V_</span><span class="si">{in}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; right&#39;</span><span class="p">)</span>

<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1 0_2; right&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;G_Gm 3 0_2 2 0 0.5; down, l=0.5Vin&#39;</span><span class="p">)</span>


<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3 3_1; right=1.2&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_2 0_3; right=1.2&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R3 3_1 0_3; down&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3_1 3_2; right&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_3 0_4; right&#39;</span><span class="p">)</span>
<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R4 3_2 N_2; down&#39;</span><span class="p">)</span>

<span class="n">vccs_exc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AM N_2 0_4; down&#39;</span><span class="p">)</span>



<span class="n">vccs_exc</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/DC_4_dependent_sources_and_tf_49_0.png" src="../_images/DC_4_dependent_sources_and_tf_49_0.png" />
</div>
</div>
<p>These are realy basic examples primarly to show how to envoke depented souce in SKiDl and SPICE and secondaly show the usage of the .tf. I say secondaryl cause agian .tf will show it real value later on when dealing with transistors.</p>
<div class="section" id="citations">
<h2>Citations:<a class="headerlink" href="#citations" title="Permalink to this headline">¶</a></h2>
<p>[1] ALL ABOUT ELECTRONICS. “Independent and Dependent (Controlled) Sources
,” YouTube, Feb 3, 2017. [Video file]. Available: https://youtu.be/SfKw8bHk7-o. [Accessed: Nov 30, 2020].</p>
<p>[2] ALL ABOUT ELECTRONICS. “What is Impedance? The Input Impedance and Output Impedance Explained,” YouTube, Jun 28, 2018. [Video file]. Available: https://youtu.be/7jw2_x8dyQ8. [Accessed: Nov 30, 2020].</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./DC_1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="DC_3_PracticalSourcs_sweeps_subcirucirts.html" title="previous page">DC Sweeps</a>
    <a class='right-next' id="next-link" href="DC_5_Thvenin_Norton.html" title="next page">Thevenin’s DC Equivalent Circuit</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Steven K Armour (PyLCARS)<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>