
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Capacitors and Inductors &#8212; Python &amp; SPICE</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Checking tool" href="../Appendix/skidl_2_pyspice_check.html" />
    <link rel="prev" title="Chapter 2 AC simulations with Python and SPICE" href="AC_1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python & SPICE</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../needed_libraries.html">
   Dependency install instruction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../DC_1/DC_1.html">
   Chapter 1 DC Simulations and Basic DC Elements with Python and SPICE
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_1_op_ohm.html">
     Getting started with Python &amp; SPICE, DC Operating Point Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_1_op_ohm.html#spice-s-dc-operating-point-simulation-op">
     SPICE’s DC Operating Point simulation
     <code class="docutils literal notranslate">
      <span class="pre">
       .op
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_2_op_source_transform.html">
     Working with SKiDl elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html">
     DC Sweeps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#dc-load-sweep-of-an-ideal-voltage-source">
     DC load sweep of an Ideal Voltage source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#a-better-dc-sim-interaction">
     A Better
     <code class="docutils literal notranslate">
      <span class="pre">
       .dc
      </span>
     </code>
     Sim Interaction¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#ideal-current-source">
     Ideal Current Source¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_3_PracticalSourcs_sweeps_subcirucirts.html#first-testbench-element">
     First testbench element¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html">
     Controlled Dependent Sources in SPICE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#ccvs">
     CCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#enter-the-spice-transfer-function">
     Enter the SPICE transfer function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#lcapy">
     LCAPY
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#vcvs">
     VCVS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#cccs">
     CCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_4_dependent_sources_and_tf.html#vccs">
     VCCS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_5_Thvenin_Norton.html">
     Thevenin’s DC Equivalent Circuit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_5_Thvenin_Norton.html#norton-s-theorem">
     Norton’s Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DC_1/DC_6_DC_MaxPower_MaxEfficiency.html">
     Maximum Power Transfer Theorem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="AC_1.html">
   Chapter 2 AC simulations with Python and SPICE
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Capacitors and Inductors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#ac-sources">
     AC Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#v-max-fourier-terms-and-rms">
     <span class="math notranslate nohighlight">
      \(V_{max}\)
     </span>
     ,  Fourier terms, and RMS¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#single-phase-cirucit">
     Single Phase Cirucit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#two-phase-system">
     Two-Phase System¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#three-phase-four-wire-y-star-topology">
     Three Phase Four Wire Y (Star) Topology ¶
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#three-phase-three-wire-delta-topology">
     Three Phase Three Wire
     <span class="math notranslate nohighlight">
      \(\Delta\)
     </span>
     Topology
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html">
   Checking tool
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#basic-elements">
   Basic Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-sinusoidalmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SinusoidalMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-pulsemixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PulseMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-exponentialmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     ExponentialMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-piecewiselinearmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     PieceWiseLinearMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-singlefrequencyfmmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     SingleFrequencyFMMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-amplitudemodulatedmixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     AmplitudeModulatedMixin
    </span>
   </code>
   Based
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/skidl_2_pyspice_check.html#highlevel-elements-randommixin-based">
   Highlevel Elements
   <code class="docutils literal notranslate">
    <span class="pre">
     RandomMixin
    </span>
   </code>
   Based
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/AC_2/AC_1_One-Two-Three_Phase_AC.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FAC_2/AC_1_One-Two-Three_Phase_AC.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/AC_2/AC_1_One-Two-Three_Phase_AC.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Capacitors and Inductors
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ac-sources">
   AC Sources
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#v-max-fourier-terms-and-rms">
   <span class="math notranslate nohighlight">
    \(V_{max}\)
   </span>
   ,  Fourier terms, and RMS¶
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#single-phase-cirucit">
   Single Phase Cirucit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#power-measurments">
     Power Measurments¶
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#complex-power-and-an-e-m-side-note">
       Complex power and an E&amp;M side note¶
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-phase-circuit-with-capacitive-compensation">
     Single Phase Circuit with Capacitive Compensation¶
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-phase-system">
   Two-Phase System¶
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#three-phase-four-wire-y-star-topology">
   Three Phase Four Wire Y (Star) Topology ¶
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#three-phase-three-wire-delta-topology">
   Three Phase Three Wire
   <span class="math notranslate nohighlight">
    \(\Delta\)
   </span>
   Topology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#citations">
     Citations:
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>TODO:</p>
<ul class="simple">
<li><p>add a link to where in this book semiconductor RLCs are covered</p></li>
<li><p>add a link to where tank filters are covered</p></li>
<li><p>get a power engineer familiar with housing and 3phase to review this cause I am not one</p></li>
<li><p>get the scales on the Delta circuit fixed and figure out the spike</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile AC_2_Codes.py</span>
<span class="c1">#Library import statements</span>

<span class="kn">from</span> <span class="nn">skidl.pyspice</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#can you say cheeky </span>
<span class="kn">import</span> <span class="nn">PySpice</span> <span class="k">as</span> <span class="nn">pspice</span>
<span class="c1">#becouse it&#39;s written by a kiwi you know</span>
<span class="kn">import</span> <span class="nn">lcapy</span> <span class="k">as</span> <span class="nn">kiwi</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">traceback</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: KICAD_SYMBOL_DIR environment variable is missing, so the default KiCad symbol libraries won&#39;t be searched.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DC_1_Codes</span> <span class="kn">import</span> <span class="n">get_skidl_spice_ref</span>
<span class="c1">#notebook specific loading control statements </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#tool to log notebook internals</span>
<span class="c1">#https://github.com/jrjohansson/version_information</span>
<span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> skidl, PySpice,lcapy, sympy, numpy, matplotlib, pandas, scipy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.6 64bit [GCC 7.3.0]</td></tr><tr><td>IPython</td><td>7.12.0</td></tr><tr><td>OS</td><td>Linux 4.19.104 microsoft standard x86_64 with debian bullseye sid</td></tr><tr><td>skidl</td><td>0.0.31.dev0</td></tr><tr><td>PySpice</td><td>1.4.3</td></tr><tr><td>lcapy</td><td>0.70</td></tr><tr><td>sympy</td><td>1.6.2</td></tr><tr><td>numpy</td><td>1.18.1</td></tr><tr><td>matplotlib</td><td>3.3.0</td></tr><tr><td>pandas</td><td>1.1.4</td></tr><tr><td>scipy</td><td>1.4.1</td></tr><tr><td colspan='2'>Thu Dec 24 16:51:10 2020 MST</td></tr></table></div></div>
</div>
<div class="section" id="capacitors-and-inductors">
<h1>Capacitors and Inductors<a class="headerlink" href="#capacitors-and-inductors" title="Permalink to this headline">¶</a></h1>
<p>Now that we’re in AC simulations SPICE no longer ignores capacitors and inductors as opens and shorts respectively. So real quick how do we invoke them in SKiDl. (note where focusing here on basic standard capacitors, not semiconductor RLCs which are going to get there own discussion further along in this chapter)
Recalling that to invoke a resistor</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#create dummy nets for demo</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;N1); net_2=Net(&#39;</span><span class="n">N2</span><span class="s1">&#39;)</span>
<span class="c1">#create the resistor</span>
<span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="c1">#connect the resistor</span>
<span class="n">r1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">net_2</span>
</pre></div>
</div>
<p>that would yield a SPICE netlist statement of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span> <span class="n">N1</span> <span class="n">N2</span> <span class="mi">1</span><span class="n">Ohm</span>
</pre></div>
</div>
<p>Where to be honest we could have let SKiDl taken care of the reference and omitted it when the resistor was instantiated. For capacitors and inductors, the procedure is the same</p>
<p>Capacitor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#create dummy nets for demo</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;N1); net_2=Net(&#39;</span><span class="n">N2</span><span class="s1">&#39;)</span>
<span class="c1">#create the capacitor</span>
<span class="n">c1</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_F</span><span class="p">)</span>
<span class="c1">#connect the capacitor</span>
<span class="n">c1</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">net_2</span>
</pre></div>
</div>
<p>that would yield a SPICE netlist statment of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C1</span> <span class="n">N1</span> <span class="n">N2</span> <span class="mi">1</span><span class="n">F</span>
</pre></div>
</div>
<p>Inductor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#create dummy nets for demo</span>
<span class="n">net_1</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;N1); net_2=Net(&#39;</span><span class="n">N2</span><span class="s1">&#39;)</span>
<span class="c1">#create the inductor</span>
<span class="n">l1</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="nd">@u_H</span><span class="p">)</span>
<span class="c1">#connect the inductor</span>
<span class="n">l1</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_1</span><span class="p">,</span> <span class="n">net_2</span>
</pre></div>
</div>
<p>that would yield a SPICE netlist statement of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="n">N1</span> <span class="n">N2</span> <span class="mi">1</span><span class="n">H</span>
</pre></div>
</div>
<p>So there is no real difference except for a major subtle detail of convention. Notice that the capacitor was connected to the netlist via a polarity port statement <code class="docutils literal notranslate"><span class="pre">c1['p',</span> <span class="pre">'n']+=net_1,</span> <span class="pre">net_2</span></code>  whereas the resistor and inductor were connected with just numbering. While technically SKiDl doesn’t care if we use numbers or named terminals as long as there a one-to-one mapping inside SKiDl (see the appendix adlkfjaldjkfkj and or look at <a class="reference external" href="https://github.com/xesscorp/skidl/blob/master/skidl/libs/pyspice_sklib.py">skidl/skidl/libs/pyspice_sklib.py</a>) The reason for the difference is because ~99% of resistors in the world are unpolarized and ~90% of all inductor are also unpolarized. Whereas more than 50% of capacitors are polarized. And when you pass DC (or otherwise) in the reviser polarization of a capacitor you can degrade if  not let lose the magic black smoke as it were. (insert an image of popped and budged electrolytic caps ) So to prevent that in this book at least</p>
<p>In this section, we are just going to start working with AC circuits in SPICE. And we’re going to start simple, but with something that is very poorly talked about and this is multiphase power circuits. Where only going to be scratching the surface of how to simulate these types of circuits in SPICE. And more often than not a lot of these multiphase circuits are driving motors. So below we have a crud model of a single armature of induction motor from an <a class="reference external" href="https://electronics.stackexchange.com/questions/234290/using-a-single-phase-induction-motor-equivalent-circuit-in-ltspice">electronics StackOverflow  quarry</a> that will work well enough for these demonstrations. As it turns out getting a macro model of an electrical motor is no small feet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 single_arm_mod class</span>
<span class="c1">#used as a test load for multiphasic power circuits in this section. </span>

<span class="k">class</span> <span class="nc">single_arm_mod</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    holding class for SKiDl Package and lcapy schematic of a </span>
<span class="sd">    inductor motor amatuer model from</span>
<span class="sd">    https://electronics.stackexchange.com/questions/234290/using-a-single-phase-induction-motor-equivalent-circuit-in-ltspice</span>
<span class="sd">    used as a test load for multiphase power circuits</span>
<span class="sd">    &quot;&quot;&quot;</span>
 
    <span class="nd">@package</span>
    <span class="k">def</span> <span class="nf">SKiDl_pack</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">Net</span><span class="p">(),</span> <span class="n">N</span><span class="o">=</span><span class="n">Net</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SkiDl package to create a single-phase inductive motor armature</span>
<span class="sd">        </span>
<span class="sd">        Terminals:</span>
<span class="sd">            P: Positive terminal</span>
<span class="sd">            N: Negative terminal</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns a model based on Handbook of Electric Power Calculations, Third Edition</span>
<span class="sd">            By H. Wayne Beaty Section 6: SINGLE-PHASE MOTORS with values sourced</span>
<span class="sd">            from a stackexchange quarry (see docstring right under class)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#top loop elements</span>
        <span class="n">l1</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">31.6</span><span class="o">/</span><span class="mi">314</span><span class="nd">@u_H</span><span class="p">)</span>
        <span class="n">r1</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.8</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">l2</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">4.34</span><span class="o">/</span><span class="mi">314</span><span class="nd">@u_H</span><span class="p">)</span>
        <span class="n">r2</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.21</span><span class="o">/.</span><span class="mi">005</span><span class="nd">@u_Ohm</span><span class="p">)</span>

        <span class="c1">#bottom loop elements</span>
        <span class="n">l3</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">31.6</span><span class="o">/</span><span class="mi">314</span><span class="nd">@u_H</span><span class="p">)</span>
        <span class="n">r3</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.8</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">l4</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">4.34</span><span class="o">/</span><span class="mi">314</span><span class="nd">@u_H</span><span class="p">)</span>
        <span class="n">r4</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.21</span><span class="o">/.</span><span class="mi">005</span><span class="nd">@u_Ohm</span><span class="p">)</span>

        <span class="c1">#conect terminal loop</span>
        <span class="n">P</span> <span class="o">&amp;</span> <span class="n">l1</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span>  <span class="o">&amp;</span> <span class="n">l3</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">N</span>

        <span class="c1">#connect top loop</span>
        <span class="n">l1</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">r1</span> <span class="o">&amp;</span> <span class="n">l2</span> <span class="o">&amp;</span> <span class="n">r2</span> <span class="o">&amp;</span> <span class="n">l1</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>

        <span class="c1">#connect bottom loop</span>
        <span class="n">l3</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">r3</span> <span class="o">&amp;</span> <span class="n">l4</span> <span class="o">&amp;</span> <span class="n">r4</span> <span class="o">&amp;</span> <span class="n">l3</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>

    
    <span class="k">def</span> <span class="nf">draw_me</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lcapy schematic of the SKiDl package in this class</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns a model based on Handbook of Electric Power Calculations, Third Edition</span>
<span class="sd">            By H. Wayne Beaty Section 6: SINGLE-PHASE MOTORS with values sourced</span>
<span class="sd">            from a stackexchange quarry (see docstring right under class)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        
        <span class="c1">#termanl loop</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W P 1;right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;L1 1 3; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3 3_2; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;L3 3_2 2; down=0.5&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W N 2;right&#39;</span><span class="p">)</span>
        
        <span class="c1">#top loop</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R1 1 4; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;L2 4 5; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R2 5 3_1; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 3 3_1; right&#39;</span><span class="p">)</span>
        
        <span class="c1">#bottom loop</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R3 3_2 6; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;L4 6 7; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;R4 7 2_1; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 2 2_1; right=2&#39;</span><span class="p">)</span>
        
        
        <span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">draw_me</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_7_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_7_0.png" />
</div>
</div>
<p>So starting off what is a SKiDl Package vs a SKiDl subcircuit that was introduced in the last chapter. SKiDl subcircuits are accessible collections of elements that we have real ease of manipulation which is why we will use subcircuits to build testbenchs. Whereas SKiDl packages are more static invoke packages more akin to so-called SPICE Macro models. Both of them allow one to create functions(methods) that have ports and have pass-through parameters to their invocation. But after the invoking of a package, the internal elements are not accessible outside of the package but do appear in the final Netlist.</p>
<p>Then the next thing to address is this use of classes. We use classes as a collected binding of interrelated variables (called attributes) and functions (called methods) that work together via the <code class="docutils literal notranslate"><span class="pre">self</span></code> keyword in a class. This allows us to keep the things in our code organized along with OOP for inheritance. Here we are just using a class as a storge item to hold our package and is easily invokable in python schematic of the partial circuit that the package generates.</p>
</div>
<div class="section" id="ac-sources">
<h1>AC Sources<a class="headerlink" href="#ac-sources" title="Permalink to this headline">¶</a></h1>
<p>So far we have talked about DC source as a separate entry and that is because SKiDl and PySpice treat them as separate entries but SPICE and specifically ngspice treat DC AC and most transient source as a single element and makes the distinction via the arguments. Lets then look at the ngspice statement for an independent source form section 4.1 [typical location in the ngspice manual] of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VXXXXXXX</span> <span class="n">N</span><span class="o">+</span> <span class="n">N</span><span class="o">-</span> <span class="o">&lt;&lt;</span><span class="n">DC</span><span class="o">&gt;</span> <span class="n">DC</span><span class="o">/</span><span class="n">TRAN</span> <span class="n">VALUE</span> <span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">AC</span> <span class="o">&lt;</span><span class="n">ACMAG</span> <span class="o">&lt;</span><span class="n">ACPHASE</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">DISTOF1</span> <span class="o">&lt;</span><span class="n">F1MAG</span> <span class="o">&lt;</span><span class="n">F1PHASE</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">DISTOF2</span> <span class="o">&lt;</span><span class="n">F2MAG</span> <span class="o">&lt;</span><span class="n">F2PHASE</span> <span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Where broken down <code class="docutils literal notranslate"><span class="pre">VXXXXXXX</span> <span class="pre">N+</span> <span class="pre">N-</span></code> is the name of the source and it’s two terminals. Next is <code class="docutils literal notranslate"><span class="pre">&lt;&lt;DC&gt;</span> <span class="pre">DC/TRAN</span> <span class="pre">VALUE</span> <span class="pre">&gt;</span></code> This is the DC source that we have been invoking with V( dc_value=) in SkiDl and PySpice. This is also where the transient simulation control statement goes, more on that in a second. Then we have 	<code class="docutils literal notranslate"><span class="pre">&lt;AC</span> <span class="pre">&lt;ACMAG</span> <span class="pre">&lt;ACPHASE</span> <span class="pre">&gt;&gt;&gt;</span></code>	 These are the .ac simulation parameters of a source. For now we will ignore 	<code class="docutils literal notranslate"><span class="pre">&lt;DISTOF1</span> <span class="pre">&lt;F1MAG</span> <span class="pre">&lt;F1PHASE</span> <span class="pre">&gt;&gt;&gt;</span> <span class="pre">&lt;DISTOF2</span> <span class="pre">&lt;F2MAG</span> <span class="pre">&lt;F2PHASE</span> <span class="pre">&gt;&gt;&gt;</span></code> for chapter lkadjfkj on distortion. But in addition to the above general statement, any independent source may have tagged onto it the transient simulation statement such as Sinusoidal, exponential, pulse, etc. Thus the PySpices and SKiDl authors compounded the DC AC and transient Sinusoidal source to one invocation in SkiDl and PySPice, the SINV &amp; SINI souces. Where then all the other transient sources have their own invocation that will be discuses in the chapter on transient simulations. For this chapter what needs to be known is that linear independent DC voltage source is a subset of independent Sinusoidal sources that not only have the add .ac simulation values but also the transient simulation values. Thus the SINV statement is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">skidl_SINV</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> 
            <span class="c1">#transit sim statements</span>
            <span class="n">offset</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">5</span> <span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">damping_factor</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="c1">#ac sim statements</span>
            <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">),</span> <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
            <span class="c1">#dc outset for DC, AC, Transient simulations </span>
            <span class="n">dc_offset</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>resulting in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V1</span> <span class="n">N1</span> <span class="n">N2</span> <span class="n">DC</span> <span class="mi">5</span><span class="n">V</span> <span class="n">AC</span> <span class="mi">5</span><span class="n">V</span> <span class="o">-</span><span class="mf">90.0</span><span class="n">rad</span> <span class="n">SIN</span><span class="p">(</span><span class="mi">5</span><span class="n">V</span> <span class="mi">5</span><span class="n">V</span> <span class="mi">5</span><span class="n">Hz</span> <span class="mi">5</span><span class="n">s</span> <span class="mi">5</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
<p>and similarly SINI is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">skidl_SINI</span><span class="o">=</span><span class="n">SINEI</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> 
            <span class="c1">#transit sim statements</span>
            <span class="n">offset</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">5</span> <span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">damping_factor</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="c1">#ac sim statements</span>
            <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">),</span> <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
            <span class="c1">#dc outset for DC, AC, Transient simulations </span>
            <span class="n">dc_offset</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I1</span> <span class="n">N1</span> <span class="n">N2</span> <span class="n">DC</span> <span class="mi">5</span><span class="n">A</span> <span class="n">AC</span> <span class="mi">5</span><span class="n">A</span> <span class="o">-</span><span class="mf">90.0</span><span class="n">rad</span> <span class="n">SIN</span><span class="p">(</span><span class="mi">5</span><span class="n">A</span> <span class="mi">5</span><span class="n">A</span> <span class="mi">5</span><span class="n">Hz</span> <span class="mi">5</span><span class="n">s</span> <span class="mi">5</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
<p>[ the argument <code class="docutils literal notranslate"><span class="pre">ac_phase=np.deg2rad(-90)</span></code> is experimental and has to be provided in rads but converts to deg internal but is reported in rad, hence why it’s experimental due to the unit u_deg outputting to Celsius ]</p>
<p>In this chapter, we will only focus on the arguments <code class="docutils literal notranslate"><span class="pre">ac_phase</span></code>, <code class="docutils literal notranslate"><span class="pre">ac_magnitude</span></code>, <code class="docutils literal notranslate"><span class="pre">dc_offset</span></code>, and will deal with the transient control argument in the transient simulation chapter. Also, linear dependent sources do not need anything special done to them for .ac simulations or any other simulation for that matter since they merely read in a signal and apply a scaled output of the instantaneous single applied to the control side.
Also note that Voltage sources can not be put into parallel in inductors and the same goes for current sources and capacitors, without inciting a singular matrix error in spice. The remedy is to add a 0ohm series resistor between the source and the field element.</p>
</div>
<div class="section" id="v-max-fourier-terms-and-rms">
<h1><span class="math notranslate nohighlight">\(V_{max}\)</span>,  Fourier terms, and RMS¶<a class="headerlink" href="#v-max-fourier-terms-and-rms" title="Permalink to this headline">¶</a></h1>
<p>For a recollection of what RMS values and how they relate to max value see ALL ABOUT ELECTRONICS YT video <a class="reference external" href="https://youtu.be/qDHsokTcgck">“RMS (Root Mean Square) Value and Average Value of AC Signals”</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;qDHsokTcgck&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/qDHsokTcgck"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<p>For now, just understand that .ac simulation returns max value per frequency which is the same as the Fourier values.</p>
</div>
<div class="section" id="single-phase-cirucit">
<h1>Single Phase Cirucit<a class="headerlink" href="#single-phase-cirucit" title="Permalink to this headline">¶</a></h1>
<p>For modeling a single spice circuit we need only have all our sources have that same value of ac_phase. Here we will just use a single source in parral with our inductive motor armature to see how a .ac simulation works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>

<span class="c1">#create a sine source with max 120V</span>
<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="c1">#branch loop issue, neet dummy resistor to fix singularity</span>
<span class="n">rdummy</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gnd</span>

<span class="c1">#create and hook up the inductive motor armature</span>
<span class="n">arm1</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">();</span> <span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
L1 N_2 N_4 0.10063694267515924H
L2 N_5 N_6 0.013821656050955413H
L3 N_4 0 0.10063694267515924H
L4 N_7 N_8 0.013821656050955413H
R2 N_2 N_5 0.8Ohm
R3 N_6 N_4 442.0Ohm
R4 N_4 N_7 0.8Ohm
R5 N_8 0 442.0Ohm
V1 N_1 0 DC 0V AC 120V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
Rdummy N_1 N_2 0Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create sim</span>
<span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="c1">#run an ac sim from 48 to 62 Hz linearly over 100 data points</span>
<span class="n">ac_vals</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="n">start_frequency</span><span class="o">=</span><span class="mi">48</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_frequency</span><span class="o">=</span><span class="mi">62</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>One should have noticed that for the source since we intend to use it purely for .ac simulations no frequency of the source we specified. This is because of how .ac simulations work. First, an operating point simulation is done to linearize any nonlinear sources (we will talk about this at length in later chapters when we start working with nonlinear devices). Next, the starting frequency is set to all sinusoidal sources, where non-sinusoidal sources are ignored via their respective means. Then the circuit’s response to the first applied frequency is recorded. Then the simulation moves on to the next simulation frequency and repeats. The recoded results are sinusoids given in terms of complex representation. Thus what an ac simulation is doing from a signals and systems point of view is sampling the Fourier space response of a linearized version of the circuit under test. Thus the arguments for the ac simulation’s <code class="docutils literal notranslate"><span class="pre">start_frequency</span></code>(inclusive and non-inclusive) and <code class="docutils literal notranslate"><span class="pre">stop_frequency</span></code>( non-inclusive) set the lower and upper bound of the circuit Fourier space that the .ac simulation is going to look through. Then number_of_points tells the simulation how many points to sample in accordance with the sampling scheme set by <code class="docutils literal notranslate"><span class="pre">variation</span></code>. We will discuss the other sampling schemes in the next section but for this section will stick with linear where the starting frequency is inclusive so that frequency samples are the same as <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code></p>
<p>The results are returned in the same manner as when using .dc expect we replace the .sweep in the return of .dc with .frequnacy in a .ac simulation as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#store the results in a dataframe</span>
<span class="c1">#store the frequency to the index</span>
<span class="n">ac_data_base_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
<span class="c1">#name the index</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>
<span class="c1">#store the voltage at the positive side of the source</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;Source_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="c1">#store the current from the source</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;Source_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="s1">&#39;V1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863+0.001978j</td>
      <td>0.135522-1.978116j</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863+0.001972j</td>
      <td>0.135522-1.972313j</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863+0.001967j</td>
      <td>0.135521-1.966544j</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863+0.001961j</td>
      <td>0.135521-1.960809j</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863+0.001955j</td>
      <td>0.135521-1.955107j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>119.999863+0.001546j</td>
      <td>0.135501-1.546182j</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>119.999863+0.001543j</td>
      <td>0.135501-1.542638j</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>119.999863+0.001539j</td>
      <td>0.135501-1.539111j</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>119.999863+0.001536j</td>
      <td>0.135501-1.535600j</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>119.999863+0.001532j</td>
      <td>0.135501-1.532105j</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<p>As we see these are complex values representing the frequency response of 120V sinusoid with frequency controlled by the ac simulation. And thus, we naively plot them we will have issues with matplotlib not knowing how to interpret complex values thusly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#quick plot of the voltage and current vs the frequency</span>
<span class="c1">#since the values are Fourier terms there going to be complex</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/iridium/anaconda3/lib/python3.7/site-packages/numpy/core/_asarray.py:85: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
/home/iridium/anaconda3/lib/python3.7/site-packages/numpy/core/_asarray.py:85: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
</pre></div>
</div>
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_22_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_22_1.png" />
</div>
</div>
<p>Thus, to analyze these Fourier components we need to decode the information contained in the complex sinusoid representation. We start by looking at the magnitude representation achieved by applying <code class="docutils literal notranslate"><span class="pre">np.abs</span></code> below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make a magnitude version of the data and plot it</span>
<span class="n">ac_data_mag_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_mag_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_mag_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863</td>
      <td>1.982753</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863</td>
      <td>1.976964</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863</td>
      <td>1.971208</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863</td>
      <td>1.965486</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863</td>
      <td>1.959798</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>119.999863</td>
      <td>1.552108</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>119.999863</td>
      <td>1.548578</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>119.999863</td>
      <td>1.545064</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>119.999863</td>
      <td>1.541567</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>119.999863</td>
      <td>1.538085</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_24_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_24_1.png" />
</div>
</div>
<p>Thus, showing that the linear dependent voltage source is indeed holding the proper voltage of 120V regardless of the frequency but that the current being drawn from the source is a function of the operating frequency. And for this section, the simulation frequency is chosen to represent a sweep through <span class="math notranslate nohighlight">\(\pm2\)</span>Hz of the two major power gid operating frequency of 50 and 60 Hz.</p>
<p>Next, we look at the phase information in terms of radians, where radians are seldom used in power analysis. We do this via <code class="docutils literal notranslate"><span class="pre">np.angle</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the phase in terms of rads; not typically done in power</span>
<span class="n">ac_data_degrad_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_degrad_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_degrad_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000016</td>
      <td>-1.502393</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000016</td>
      <td>-1.502192</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000016</td>
      <td>-1.501992</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000016</td>
      <td>-1.501791</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000016</td>
      <td>-1.501591</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>0.000013</td>
      <td>-1.483383</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>0.000013</td>
      <td>-1.483184</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>0.000013</td>
      <td>-1.482984</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>0.000013</td>
      <td>-1.482785</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>0.000013</td>
      <td>-1.482585</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_26_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_26_1.png" />
</div>
</div>
<p>We can look at the same thing in terms of degrees by adding the argument <code class="docutils literal notranslate"><span class="pre">deg=True</span></code> to <code class="docutils literal notranslate"><span class="pre">np.angle</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the phase in degrees</span>
<span class="n">ac_data_degang_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_degang_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_degang_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000944</td>
      <td>-86.080757</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000942</td>
      <td>-86.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000939</td>
      <td>-86.057793</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000936</td>
      <td>-86.046303</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000933</td>
      <td>-86.034813</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>0.000738</td>
      <td>-84.991608</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>0.000737</td>
      <td>-84.980179</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>0.000735</td>
      <td>-84.968735</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>0.000733</td>
      <td>-84.957298</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>0.000732</td>
      <td>-84.945862</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_28_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_28_1.png" />
</div>
</div>
<p>This shows that there is some slight phase in the voltage with respect to the ground. But this is mostly numerical issues. What is mostly happening is that the current is lagging the voltage at the ground from 86 to 85 degrees. This is  obvious given that the load is fully resistive inductive.</p>
<p>There is one more representation of the phase and that is phase unwrapped. This most for other simulations in this chapter but we will discuss it here. When using np.deg in degrees it will cycle back on itself every 360 degrees. We don’t get this in the radian interpretation. Thus, we have also have phase degree unwrapped which accumulates the angle phase to that its value can go beyond 360 degrees. Here it doesn’t do us much good but in the next sections, this view will become extremely important.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 angle_phase_unwrap lambda function</span>
<span class="c1">#lambda function to find the unwrapped phase from complex values </span>

<span class="n">angle_phase_unwrap</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the phase in degrees unwrapped, since the phase here did not go</span>
<span class="c1">#beyond 2pi doesn&#39;t do anything</span>
<span class="n">ac_data_deganguw_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">angle_phase_unwrap</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_deganguw_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_deganguw_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000944</td>
      <td>-86.080758</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000942</td>
      <td>-86.069270</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000939</td>
      <td>-86.057788</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000936</td>
      <td>-86.046300</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000933</td>
      <td>-86.034811</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>0.000738</td>
      <td>-84.991609</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>0.000737</td>
      <td>-84.980175</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>0.000735</td>
      <td>-84.968735</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>0.000733</td>
      <td>-84.957294</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>0.000732</td>
      <td>-84.945861</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_31_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_31_1.png" />
</div>
</div>
<div class="section" id="power-measurments">
<h2>Power Measurments¶<a class="headerlink" href="#power-measurments" title="Permalink to this headline">¶</a></h2>
<p>Since with SPICE we have access to current and voltage and with Python we have a better claualtor then pretty much any SPICE utlity ever lets make some tooling to find all the typical power terms:</p>
<ul class="simple">
<li><p>the instaniues power: <span class="math notranslate nohighlight">\(p[W]=v \cdot i [V \cdot A]\)</span></p></li>
<li><p>the averge or avtive Power: <span class="math notranslate nohighlight">\(P[W]=\dfrac{\Re( v \cdot i^*)}{2} [V \cdot A]\)</span></p></li>
<li><p>the reactive power: <span class="math notranslate nohighlight">\(Q[VAR]=\dfrac{\Im( v \cdot i^*)}{2} [V \cdot A]\)</span></p></li>
<li><p>the complex power: <span class="math notranslate nohighlight">\(S[VAR]=\dfrac{ v \cdot i^*}{2} [V \cdot A]\)</span></p></li>
<li><p>the apparent power: <span class="math notranslate nohighlight">\(s[VAR]=\left| \dfrac{ v \cdot i^*}{2} \right| [V \cdot A]\)</span></p></li>
<li><p>the power factor: <span class="math notranslate nohighlight">\(pf[]=\dfrac{P}{s} [W/VA]\)</span></p></li>
<li><p>the power factor angle: <span class="math notranslate nohighlight">\(\phi_{pf}[deg/rad]=\arccos\left(\dfrac{P}{s}\right) [W/VA]\)</span></p></li>
<li><p>the parrel compentions capcitor value per frequancy: <span class="math notranslate nohighlight">\(C[F]=\frac{2 P \cdot \left( \tan{\left(\theta_{i} \right)} - \tan{\left(\theta_{f} \right)}\right)}{\omega |V|^{2}}\)</span></p></li>
<li><p>the parrel compentions inductor value per frequancy: <span class="math notranslate nohighlight">\(L[H]= \frac{|V|^{2}}{2 P \cdot \omega \left( \tan{\left(\theta_{i} \right)} - \tan{\left(\theta_{f} \right)}\right)} \)</span></p></li>
</ul>
<p>For a refresher on most of these terms ALL ABOUT ELELECTINCS YT video <a class="reference external" href="https://youtu.be/iDYWfBGwT1w">“What is Power Factor? What is Leading &amp; Lagging Power factor ? Power Factor Correction Methods”</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;iDYWfBGwT1w&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/iDYWfBGwT1w"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="section" id="complex-power-and-an-e-m-side-note">
<h3>Complex power and an E&amp;M side note¶<a class="headerlink" href="#complex-power-and-an-e-m-side-note" title="Permalink to this headline">¶</a></h3>
<p>The reactive power Q is often treated as a fictitious power term; It’s not. Poynting’s theorem, that theorem that defines photon power in classical E&amp;M is $<span class="math notranslate nohighlight">\(-\oint_{S} (E \times H) \cdot dS=\iiint_{V} \left[ \dfrac{\mu}{2}\dfrac{\partial|H|^2}{\partial t} +\dfrac{\epsilon}{2}\dfrac{\partial|E|^2}{\partial t} + E\cdot J \right]dV \)</span>$ Where recalling that Poynting’s theorem is also about power flux for E&amp;M filds we can break it down to</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(-\oint_{S} (E \times H) \cdot dS\)</span> = the complex power <span class="math notranslate nohighlight">\(S\)</span>, aka the full elemtromatic power inclosed in a volume</p></li>
<li><p><span class="math notranslate nohighlight">\(\iiint_{V} E\cdot J dV\)</span> = the average or active power <span class="math notranslate nohighlight">\(P\)</span> this is the dissipative power aka the ohmic power</p></li>
<li><p><span class="math notranslate nohighlight">\(\iiint_{V} \left[ \dfrac{\mu}{2}\dfrac{\partial|H|^2}{\partial t} +\dfrac{\epsilon}{2}\dfrac{\partial|E|^2}{\partial t} \right] dV\)</span> is the reactive poewr <span class="math notranslate nohighlight">\(Q\)</span>, or the power stored in the E &amp; M fields. Wich are physical empoided by captiors and inductors in our circuits.</p></li>
</ul>
<p>One of the consequences of this is that the power factor tells us is whether the E field or the M field is containing the majority of the reactive power.</p>
<p>With respect to a periodic steady-state signal like a sinusoid, it is true that the time average of the reactive power is zero. But as All ABOUT ELELCTROINCS showed what is happening during the period is that the power in the field is being pulled from the source during the first half of the period and then returned to the source in the second half. In other words, the reactive power is sloshing back and forth. This is not a good thing, especially at the source. So what we do is add a compensating reciprocal element to bring the power factor to close to zero. Wich is the same as saying that an LC oscillator is created so that the reactive power sloshing about is in a local tank (parrel LC elements are also called tank circuits) instead of with the whole circuit. Also if anyone says reactive power is fictitious ask why we then need flyback diodes on inductors. Cause I can ensure you a driving sinusoid is removed from the circuit the reactive power stored in the inductor will very quickly become active power in the circuit if not compensated for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 power_calcs_ac class</span>
<span class="c1">#class to store power calculations and aid functions as staticmethods</span>

<span class="k">class</span> <span class="nc">power_calcs_ac</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Because I am too lazy to create one that works with time</span>
<span class="sd">    based data as well this only works with the .ac Fourier like data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">instantaneous_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the instantaneous power: </span>
<span class="sd">        $$p[W]=v \cdot i [V \cdot A]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called instantaneous power in Watts</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">voltage</span><span class="o">*</span><span class="n">current</span>
                               
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">averge_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called average power: </span>
<span class="sd">        $$P[W]=\dfrac{\Re( v \cdot i^*)}{2} [V \cdot A]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called average power in Watts</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Power</span><span class="o">=</span><span class="n">voltage</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="n">Power</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Power</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">Power</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">reactive_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called reactive power: </span>
<span class="sd">        $$Q[VAR]=\dfrac{\Im( v \cdot i^*)}{2} [V \cdot A]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called reactive power in Volt-Ampere Reactive [VAR]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Qpower</span><span class="o">=</span><span class="n">voltage</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="n">Qpower</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Qpower</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">Qpower</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">complex_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called complex power: </span>
<span class="sd">        $$S[VA]=\dfrac{ v \cdot i^*}{2}  [V \cdot A]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whos length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called apparent power in Volt-Ampere [VA]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Spower</span><span class="o">=</span><span class="n">voltage</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="n">Spower</span><span class="o">=</span><span class="n">Spower</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">Spower</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">apparent_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called apparent power: </span>
<span class="sd">        $$S[VA]=\left| \dfrac{ v \cdot i^*}{2} \right| [V \cdot A]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called complex power in Volt-Ampere [VA]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Spower</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">complex_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">spower</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Spower</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spower</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">power_factor_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called power factor via: </span>
<span class="sd">        $$pf[]=\dfrac{P}{s} [W/VA]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whos length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called power factor that is unitless </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Ppower</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">averge_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">spower</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">apparent_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">pf</span><span class="o">=</span><span class="n">Ppower</span><span class="o">/</span><span class="n">spower</span>
        <span class="k">return</span> <span class="n">pf</span>
    
    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">power_factor_angle_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to compute the so-called power factor angle via: </span>
<span class="sd">        $$\phi_{pf}[deg/rad]=\arccos\left(\dfrac{P}{s}\right) [W/VA]$$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">            </span>
<span class="sd">            deg (bool; True): When True returns the power factor angle in degrees, else in radians</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the so-called power factor angle in degrees when `deg` is true, else in radians</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pf</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">power_factor_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">pf_ang</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
            <span class="n">pf_ang</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">pf_ang</span><span class="p">)</span>
            
        
        <span class="k">return</span> <span class="n">pf_ang</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Cparallel_comp</span><span class="p">(</span><span class="n">new_pf_ang</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">frequancy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Statcmethod to calculate the parallel compensating capacitor for inductive loads</span>
<span class="sd">        based on the following equation</span>
<span class="sd">        </span>
<span class="sd">        $$ C[F]=\frac{2 P \cdot \left( \tan{\left(\theta_{i} \right)} - \tan{\left(\theta_{f} \right)}\right)}{\omega |V|^{2}} $$</span>

<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            new_pf_ang (float; deg):new power factor angle goal</span>
<span class="sd">            </span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whose length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">            </span>
<span class="sd">            frequency (np.float): the frequencies matching the current and voltage arrays</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the needed compensation to reach the target power factor in Farads </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Power</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">averge_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">int_pf_ang</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">power_factor_angle_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">deltaQ</span><span class="o">=</span><span class="n">Power</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">int_pf_ang</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">new_pf_ang</span><span class="p">)))</span>
        <span class="n">Vmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">voltage</span><span class="p">)</span>
        <span class="n">angfreq</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">frequancy</span>
        
        <span class="n">C</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deltaQ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">angfreq</span><span class="o">*</span><span class="n">Vmag</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">C</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Lparallel_comp</span><span class="p">(</span><span class="n">new_pf_ang</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">frequancy</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Statcmethod to calculate the parallel compensating inductor for capacitive loads</span>
<span class="sd">        based on the following equation</span>
<span class="sd">        </span>
<span class="sd">        $$L[H]= \frac{|V|^{2}}{2 P \cdot \omega \left( \tan{\left(\theta_{i} \right)} - \tan{\left(\theta_{f} \right)}\right)} $$</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            new_pf_ang (float; deg):new power factor angle goal</span>
<span class="sd">            </span>
<span class="sd">            voltage (np.float or np.complex array): the voltage in terms of </span>
<span class="sd">                Fourier terms whos length must match the `current` argument</span>
<span class="sd">            </span>
<span class="sd">            current (np.float or np.complex array): the current in terms of </span>
<span class="sd">                Fourier terms whose length must match the `voltage` argument</span>
<span class="sd">            </span>
<span class="sd">            frequency (np.float): the frequencies matching the current and voltage arrays</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns an array with the needed compensation to reach the target power factor in Henrys </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">Power</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">averge_power_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">int_pf_ang</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">power_factor_angle_calc</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="n">deltaQ</span><span class="o">=</span><span class="n">Power</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">int_pf_ang</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">new_pf_ang</span><span class="p">)))</span>
        <span class="n">Vmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">voltage</span><span class="p">)</span>
        <span class="n">angfreq</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">frequancy</span>
        
        <span class="n">L</span><span class="o">=</span><span class="p">(</span><span class="n">Vmag</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">angfreq</span><span class="o">*</span><span class="n">deltaQ</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">L</span>
    
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">autogen_powercalcs</span><span class="p">(</span><span class="n">source_dataframe</span><span class="p">,</span> <span class="n">base_term</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Static method to automatically calculate and add the dataframe the </span>
<span class="sd">        instantaneous_power_calc, averge_power_calc, reactive_power_calc, complex_power_calc, apparent_power_calc, </span>
<span class="sd">        power_factor_calc power_factor_angle_calc methods in this class</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            source_dataframe (pandas.dataframe): pandas dataframe containing the AC frequencies </span>
<span class="sd">                in the index, columns in the forms of  `&lt;base_term&gt;_v_[V]` and `&lt;base_term&gt;_i_[A]`</span>
<span class="sd">            </span>
<span class="sd">            base_term (string): the based string as part of the column names of </span>
<span class="sd">                `&lt;base_term&gt;_v_[V]` and `&lt;base_term&gt;_i_[A]`</span>
<span class="sd">                that are the source columns that will be sourced to calculate the other measurements</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            adds the following:</span>
<span class="sd">            source_dataframe[f&#39;{base_term}_p_[W]&#39;], source_dataframe[f&#39;{base_term}_P_[W]&#39;], source_dataframe[f&#39;{base_term}_Q_[VAR]&#39;]</span>
<span class="sd">            source_dataframe[f&#39;{base_term}_S_[VA]&#39;] ,source_dataframe[f&#39;{base_term}_s_[VA]&#39;], source_dataframe[f&#39;{base_term}_pf_[]&#39;], </span>
<span class="sd">            source_dataframe[f&#39;{base_term}_pfang_[deg]&#39;]</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">voltage_col</span><span class="o">=</span><span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_v_[V]&#39;</span><span class="p">];</span> <span class="n">current_col</span><span class="o">=</span><span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_i_[A]&#39;</span><span class="p">]</span>
        
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_p_[W]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">instantaneous_power_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_P_[W]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">averge_power_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_Q_[VAR]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">reactive_power_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_S_[VA]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">complex_power_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_s_[VA]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">apparent_power_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pf_[]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">power_factor_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
        <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pfang_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">power_factor_angle_calc</span><span class="p">(</span><span class="n">voltage_col</span><span class="p">,</span> <span class="n">current_col</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_power_plot</span><span class="p">(</span><span class="n">source_dataframe</span><span class="p">,</span> <span class="n">base_term</span><span class="p">,</span> <span class="n">frequncy_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Staticmethod to assist in the rapid plot creation of the three common</span>
<span class="sd">        AC powers and the power factor angle in a single 2x2 subplot</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            source_dataframe (pandas.dataframe): pandas dataframe containing the AC frequencies </span>
<span class="sd">                in the index, columns in the forms of </span>
<span class="sd">                `&lt;base_term&gt;_P_[W]`, `&lt;base_term&gt;_Q_[VAR]`, `&lt;base_term&gt;_s_[VA]`, `&lt;base_term&gt;_pfang_[deg]`</span>
<span class="sd">            </span>
<span class="sd">            base_term (string): the based string as part of the column names of </span>
<span class="sd">                `&lt;base_term&gt;_P_[W]`, `&lt;base_term&gt;_Q_[VAR]`, `&lt;base_term&gt;_s_[VA]`, `&lt;base_term&gt;_pfang_[deg]`</span>
<span class="sd">                that are the source columns that create the plot</span>
<span class="sd">            </span>
<span class="sd">            frequncy_scale (string; &#39;linear&#39;): the frequency scale that that data was collected against, must</span>
<span class="sd">                be `linear` for a linear ac sweep or `decade` for a logarithm decade collection that will make the</span>
<span class="sd">                plot be semilogx</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            creates a 2x2 plot fo the power terms </span>
<span class="sd">            </span>
<span class="sd">        TODO:</span>
<span class="sd">            -add octave scale</span>
<span class="sd">            -make plot generation cleaner between the different frequency scales</span>
<span class="sd">            -make the pf_deg work for rad as well</span>
<span class="sd">            -make it work with dataframes missing power terms, have it make</span>
<span class="sd">                them on the fly</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">frequncy_scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;decade&#39;</span><span class="p">],</span> <span class="s1">&#39;frequncy_scale must be linear or decade&#39;</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="p">[[</span><span class="n">Pplot</span><span class="p">,</span> <span class="n">Qplot</span><span class="p">],</span> <span class="p">[</span><span class="n">splot</span><span class="p">,</span> <span class="n">pfangplot</span><span class="p">]]</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="n">Pplot</span><span class="p">,</span> <span class="n">Qplot</span><span class="p">,</span> <span class="n">splot</span><span class="p">,</span> <span class="n">pfangplot</span><span class="p">]</span>
        <span class="n">x</span><span class="o">=</span><span class="n">source_dataframe</span><span class="o">.</span><span class="n">index</span>
        <span class="n">x_label</span><span class="o">=</span><span class="n">source_dataframe</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
        
        <span class="k">if</span> <span class="n">frequncy_scale</span><span class="o">==</span><span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_P_[W]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">Pplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_P_[W]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_Q_[VAR]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">Qplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_Q_[VAR]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_s_[VA]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">splot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_s_[VA]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pfang_[deg]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">pfangplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pfang_[deg]&#39;</span><span class="p">])</span>
        
        <span class="k">elif</span> <span class="n">frequncy_scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_P_[W]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">Pplot</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_P_[W]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_Q_[VAR]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">Qplot</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_Q_[VAR]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_s_[VA]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">splot</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_s_[VA]&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pfang_[deg]&#39;</span> <span class="ow">in</span> <span class="n">source_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">pfangplot</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">source_dataframe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{base_term}</span><span class="s1">_pfang_[deg]&#39;</span><span class="p">])</span>
        
        <span class="c1">#set the ylabels</span>
        <span class="n">Pplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;P_[W]&#39;</span><span class="p">)</span>
        <span class="n">Qplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Q_[VAR]&#39;</span><span class="p">)</span>
        <span class="n">splot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;s_[VA]&#39;</span><span class="p">)</span>
        <span class="n">pfangplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;pf_ang_[deg]&#39;</span><span class="p">)</span>
        
        <span class="c1">#set the xlabel, ticklabel controls, grid for all the subplots</span>
        <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{base_term}</span><span class="s1">&quot; power plots&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make a seperate dataframe to stowe power values in</span>
<span class="n">ac_data_power_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Source_v_[V]&#39;, &#39;Source_i_[A]&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>With all the power calculation that are typically needed stowed away with handy utility methods to automate using them and plotting results lets put them to work</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make the power calculations</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_power_df</span><span class="p">,</span> <span class="s1">&#39;Source&#39;</span><span class="p">)</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
      <th>Source_p_[W]</th>
      <th>Source_P_[W]</th>
      <th>Source_Q_[VAR]</th>
      <th>Source_S_[VA]</th>
      <th>Source_s_[VA]</th>
      <th>Source_pf_[]</th>
      <th>Source_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863+0.001978j</td>
      <td>0.135522-1.978116j</td>
      <td>16.266512-237.373428j</td>
      <td>8.129342</td>
      <td>118.686989</td>
      <td>8.129342+118.686989j</td>
      <td>118.965065</td>
      <td>0.068334</td>
      <td>86.081703</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863+0.001972j</td>
      <td>0.135522-1.972313j</td>
      <td>16.266457-236.677048j</td>
      <td>8.129339</td>
      <td>118.338799</td>
      <td>8.129339+118.338799j</td>
      <td>118.617691</td>
      <td>0.068534</td>
      <td>86.070206</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863+0.001967j</td>
      <td>0.135521-1.966544j</td>
      <td>16.266403-235.984772j</td>
      <td>8.129333</td>
      <td>117.992645</td>
      <td>8.129333+117.992645j</td>
      <td>118.272354</td>
      <td>0.068734</td>
      <td>86.058716</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863+0.001961j</td>
      <td>0.135521-1.960809j</td>
      <td>16.266350-235.296524j</td>
      <td>8.129330</td>
      <td>117.648521</td>
      <td>8.129330+117.648521j</td>
      <td>117.929047</td>
      <td>0.068934</td>
      <td>86.047234</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863+0.001955j</td>
      <td>0.135521-1.955107j</td>
      <td>16.266294-234.612274j</td>
      <td>8.129325</td>
      <td>117.306396</td>
      <td>8.129325+117.306396j</td>
      <td>117.587738</td>
      <td>0.069134</td>
      <td>86.035744</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make the plot of the power and power factor angle</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_power_df</span><span class="p">,</span> <span class="s1">&#39;Source&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_39_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_39_0.png" />
</div>
</div>
<p>As can be seen, our power factor is clearly inductive and motor armature has a huge reactive power. Meaning that it is sourcing and returning a lot of energy in the inductor armature inductors and source.</p>
</div>
</div>
<div class="section" id="single-phase-circuit-with-capacitive-compensation">
<h2>Single Phase Circuit with Capacitive Compensation¶<a class="headerlink" href="#single-phase-circuit-with-capacitive-compensation" title="Permalink to this headline">¶</a></h2>
<p>As we saw the super inductiveness of this circuit means that armature is drawing sloshing a lot of energy to and from the circuit. We compensate for that by adding a parallel capacitor to the amateur. This capacitor buffers the sloshing from the source once the circuit has settled down into a steady state. So that the inductors are building up their magnetic field they are sourcing that energy from the capacitor, and similarly when the inductor’s magnetic fields are collapsing and sourcing power to the shunt capacitor. This sloshing is known as resonance and will be looked at more closely in the next section and the next chapter.</p>
<p>One of the calculation tools that was added to <code class="docutils literal notranslate"><span class="pre">power_calcs_ac</span></code> was <code class="docutils literal notranslate"><span class="pre">Cparallel_comp</span></code> that calculated the needed parallel capacitance given a new target power factor angle. For the most part, the ideal power factor is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find the compensation capacitance for each freq in the sweep</span>
<span class="n">ac_data_power_df</span><span class="p">[</span><span class="s1">&#39;Ccomp_[F]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">Cparallel_comp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">ac_data_power_df</span><span class="p">[</span><span class="s1">&#39;Source_v_[V]&#39;</span><span class="p">],</span>  <span class="n">ac_data_power_df</span><span class="p">[</span><span class="s1">&#39;Source_i_[A]&#39;</span><span class="p">],</span> <span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1">#get the mean value of the capacitor and where that mean frequency is</span>
<span class="c1">#dont do this in real life you will see why</span>
<span class="n">ccomp_value</span><span class="o">=</span><span class="n">ac_data_power_df</span><span class="p">[</span><span class="s1">&#39;Ccomp_[F]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_freq</span><span class="o">=</span><span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean cap at mean freq:</span><span class="si">{ccomp_value:2e}</span><span class="s1">[F]@</span><span class="si">{mean_freq}</span><span class="s1">Hz&#39;</span><span class="p">)</span>

<span class="c1">#make a plot of the compensation capacitance and the found mean</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Ccomp_[F]&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Capatiance_[F]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_freq</span><span class="p">,</span> <span class="n">ccomp_value</span><span class="p">,</span> <span class="s1">&#39;*r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mean_C&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PF-&gt;0deg compenstaion capactor vs Freqauncy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean cap at mean freq:4.291683e-05[F]@55.0Hz
</pre></div>
</div>
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_42_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_42_1.png" />
</div>
</div>
<p>What we see is that the capacitance need is a function of the frequency and has a fairly large range just within the span of 24Hz. Since we are staying basic here let’s just pick the average capacitance as the shunt compensation capacitance value to use and repeat the simulation and analysis to see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#resimulat the circuit but now with the shunt compensation capacitance</span>
<span class="n">reset</span><span class="p">()</span>

<span class="n">vs</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
<span class="c1">#branch loop issue, neet dummy resistor to fix singularly</span>
<span class="n">rdummy</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">vs</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gnd</span>

<span class="c1">#compansating capacitor </span>
<span class="n">ccomp</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ccomp_value</span><span class="nd">@u_F</span><span class="p">);</span> <span class="n">ccomp</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">gnd</span>

<span class="n">arm1</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">();</span> <span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">ccomp</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">],</span> <span class="n">gnd</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
L1 N_2 N_5 0.10063694267515924H
L2 N_6 N_7 0.013821656050955413H
L3 N_5 0 0.10063694267515924H
L4 N_8 N_9 0.013821656050955413H
R2 N_2 N_6 0.8Ohm
R3 N_7 N_5 442.0Ohm
R4 N_5 N_8 0.8Ohm
R5 N_9 0 442.0Ohm
V1 N_1 0 DC 0V AC 120V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
Ccomp N_2 0 4.2916828429243215e-05
Rdummy N_1 N_2 0Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#repreform the sim</span>
<span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">ac_vals</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="n">start_frequency</span><span class="o">=</span><span class="mi">48</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_frequency</span><span class="o">=</span><span class="mi">62</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#recoloect the VI data</span>
<span class="n">ac_data_base_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;Source_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">rdummy</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;Source_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="s1">&#39;V1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="c1">#ac_data_base_df[&#39;Source_p_[W]&#39;]=ac_data_base_df[&#39;Source_v_[V]&#39;]*ac_data_base_df[&#39;Source_i_[A]&#39;]</span>

<span class="n">ac_data_base_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863+0.000425j</td>
      <td>0.135491-0.424911j</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863+0.000415j</td>
      <td>0.135491-0.414532j</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863+0.000404j</td>
      <td>0.135490-0.404186j</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863+0.000394j</td>
      <td>0.135490-0.393875j</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863+0.000384j</td>
      <td>0.135490-0.383597j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>119.999863-0.000442j</td>
      <td>0.135483+0.441739j</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>119.999863-0.000450j</td>
      <td>0.135483+0.449858j</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>119.999863-0.000458j</td>
      <td>0.135483+0.457961j</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>119.999863-0.000466j</td>
      <td>0.135483+0.466048j</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>119.999863-0.000474j</td>
      <td>0.135483+0.474119j</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the raw data</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/iridium/anaconda3/lib/python3.7/site-packages/numpy/core/_asarray.py:85: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
/home/iridium/anaconda3/lib/python3.7/site-packages/numpy/core/_asarray.py:85: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
</pre></div>
</div>
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_47_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the magnitude</span>
<span class="n">ac_data_mag_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_mag_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_mag_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863</td>
      <td>0.445990</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863</td>
      <td>0.436113</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863</td>
      <td>0.426291</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863</td>
      <td>0.416528</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863</td>
      <td>0.406822</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>119.999863</td>
      <td>0.462049</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>119.999863</td>
      <td>0.469817</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>119.999863</td>
      <td>0.477582</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>119.999863</td>
      <td>0.485342</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>119.999863</td>
      <td>0.493097</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_48_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the phase in radians</span>
<span class="n">ac_data_degrad_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_degrad_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_degrad_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000004</td>
      <td>-1.262120</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000003</td>
      <td>-1.254890</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000003</td>
      <td>-1.247351</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000003</td>
      <td>-1.239483</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000003</td>
      <td>-1.231265</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>-0.000004</td>
      <td>1.273200</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>-0.000004</td>
      <td>1.278268</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>-0.000004</td>
      <td>1.283161</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>-0.000004</td>
      <td>1.287888</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>-0.000004</td>
      <td>1.292457</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_49_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_49_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#look at the phase in degrees</span>
<span class="n">ac_data_degang_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_degang_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_degang_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000203</td>
      <td>-72.314148</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000198</td>
      <td>-71.899910</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000193</td>
      <td>-71.467941</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000188</td>
      <td>-71.017143</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000183</td>
      <td>-70.546303</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>-0.000211</td>
      <td>72.949005</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>-0.000215</td>
      <td>73.239349</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>-0.000219</td>
      <td>73.519691</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>-0.000223</td>
      <td>73.790527</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>-0.000226</td>
      <td>74.052322</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_50_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_50_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##look at the unwraped-phase</span>
<span class="n">ac_data_deganguw_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">angle_phase_unwrap</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ac_data_deganguw_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ac_data_deganguw_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>0.000203</td>
      <td>-72.314150</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>0.000198</td>
      <td>-71.899906</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>0.000193</td>
      <td>-71.467944</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>0.000188</td>
      <td>-71.017145</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>0.000183</td>
      <td>-70.546299</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>-0.000211</td>
      <td>72.949002</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>-0.000215</td>
      <td>73.239347</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>-0.000219</td>
      <td>73.519692</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>-0.000223</td>
      <td>73.790529</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>-0.000226</td>
      <td>74.052324</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_51_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_51_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#perform all the power calcs</span>
<span class="n">ac_data_power_df</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_power_df</span><span class="p">,</span> <span class="s1">&#39;Source&#39;</span><span class="p">)</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">ac_data_power_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source_v_[V]</th>
      <th>Source_i_[A]</th>
      <th>Source_p_[W]</th>
      <th>Source_P_[W]</th>
      <th>Source_Q_[VAR]</th>
      <th>Source_S_[VA]</th>
      <th>Source_s_[VA]</th>
      <th>Source_pf_[]</th>
      <th>Source_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>119.999863+0.000425j</td>
      <td>0.135491-0.424911j</td>
      <td>16.259047-50.989166j</td>
      <td>8.129342</td>
      <td>25.494640</td>
      <td>8.129342+25.494640j</td>
      <td>26.759352</td>
      <td>0.303794</td>
      <td>72.314354</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>119.999863+0.000415j</td>
      <td>0.135491-0.414532j</td>
      <td>16.259020-49.743675j</td>
      <td>8.129338</td>
      <td>24.871895</td>
      <td>8.129338+24.871895j</td>
      <td>26.166721</td>
      <td>0.310675</td>
      <td>71.900101</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>119.999863+0.000404j</td>
      <td>0.135490-0.404186j</td>
      <td>16.258995-48.502270j</td>
      <td>8.129333</td>
      <td>24.251188</td>
      <td>8.129333+24.251188j</td>
      <td>25.577456</td>
      <td>0.317832</td>
      <td>71.468132</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>119.999863+0.000394j</td>
      <td>0.135490-0.393875j</td>
      <td>16.258968-47.264908j</td>
      <td>8.129330</td>
      <td>23.632507</td>
      <td>8.129330+23.632507j</td>
      <td>24.991627</td>
      <td>0.325282</td>
      <td>71.017326</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>119.999863+0.000384j</td>
      <td>0.135490-0.383597j</td>
      <td>16.258944-46.031555j</td>
      <td>8.129325</td>
      <td>23.015831</td>
      <td>8.129325+23.015831j</td>
      <td>24.409309</td>
      <td>0.333042</td>
      <td>70.546478</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot of the powers with a compenstating capcitor</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_power_df</span><span class="p">,</span> <span class="s1">&#39;Source&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_53_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_53_0.png" />
</div>
</div>
<p>We see that while we have overall lowered the Reactive power from as high as 120VAR to around <span class="math notranslate nohighlight">\(\pm20\)</span>[VAR]. We have only succeeded in getting the power factor to near zero at the mean frequency of 55Hz where our mean capacitance was 4.29e-05F. Just within a sweep of 24Hz encompassing 50/60Hz we see that single frequency matching is not effective. If this was a digital single with today’s data rates and the frequency range that ideal squarewave encompass this would have been even less effective. Just with power alone this single example where naively using the mean shows that except in the tightest frequency banded systems single-frequency matching doesn’t work and instead broadband matching is needed. But we will get to those circuits much much later in this book.</p>
</div>
</div>
<div class="section" id="two-phase-system">
<h1>Two-Phase System¶<a class="headerlink" href="#two-phase-system" title="Permalink to this headline">¶</a></h1>
<p>The North American two-phase power system in the residential panel is one of the strangest things in electrical engineering that has ever been conceived. If you’re not familiar with it I recommend watching the YT video <a class="reference external" href="https://youtu.be/jMmUoZh3Hq4">“The US electrical system is not 120V”</a> from Technology Connections. Also if you’re not familiar with Ground Fault Interpreter (gfi) I recommend watching his YT video on that <a class="reference external" href="https://youtu.be/ILBjnZq0n8s">The GFCI/RCD: A Simple but Life-Saving Protector</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;jMmUoZh3Hq4&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/jMmUoZh3Hq4"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;ILBjnZq0n8s&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/ILBjnZq0n8s"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<p>For a shorter video about neutral and ground, I recommend the YT video <a class="reference external" href="https://youtu.be/-n8CiU_6KqE">The difference between neutral and ground on the electric panel</a> from grayfurnaceman.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;-n8CiU_6KqE&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/-n8CiU_6KqE"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<p>Suffice to say that the neutral branch is the nominal current return path. Where inside the residence at the primary panel earth ground is tied to neutral. Where then all subsequent grounds normally are isolated chaise ground branches. These isolated branches also lead to earth ground but are typically a current return in place of the neutral in a fault situation typical when there is conduction to the chassis. Where this typically happens in an electrical shock instance hence the GFI.</p>
<p>Below we create a rudimentary model of such a North American 2 phase panel. Where we start only at the panel, not the transformer. And in the model, we have the neutral resistively separated from the ground. Whereat the source side this resistance <code class="docutils literal notranslate"><span class="pre">Rearth</span></code> is default set to zero. It can be changed to loosely model the earth ground bonding issue that can occur where then the neutral floats. On the other side of the neutral branch, there is a separation resistor <code class="docutils literal notranslate"><span class="pre">Rgfi</span></code> that is set by default to be open to represent an open chassis ground return path. But can be changed to loosely mimic a ground fault condition. We will play with this in the chapter on transient circuits when we replace that resistor with a switch. So for now we will leave it open. Finally, the neutral and each of the phases have a wire model resistor (<code class="docutils literal notranslate"><span class="pre">RaA</span></code>, <code class="docutils literal notranslate"><span class="pre">RbB</span></code>, <code class="docutils literal notranslate"><span class="pre">RnN</span></code>) These are by default set to O Oms; however, they can be changed to facilitate three things. The source built-in resistance, the interconnection resistance, and or an open fault in the connects. Again, we will not explore those situations here but they are baked into this testbench.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 two_phase_panel class</span>
<span class="c1">#class to create a SPICE model of a North American two-phase power panel</span>
<span class="c1">#with ground branch and gfi branch in addition to neutral branch</span>

<span class="k">class</span> <span class="nc">two_phase_panel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to contain the needed Skidl package (method) to invoke the circuit for simulations</span>
<span class="sd">    and drawing just the packaged circuit via lcapy.</span>
<span class="sd">    </span>
<span class="sd">    The circuit in hand is a model of a typical North American 2Phase home panel with resistor separated</span>
<span class="sd">    neutral from the ground along with open separation to a parallel gfi path for chassis ground to the earth ground</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl_circ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Load_A_posterm</span><span class="p">,</span> <span class="n">Load_A_neuterm</span><span class="p">,</span>
                   <span class="n">Load_B_posterm</span><span class="p">,</span> <span class="n">Load_B_neuterm</span><span class="p">,</span>
                  <span class="n">RaA</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">RbB</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">RnN</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> 
                  <span class="n">Rearth</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">Rgfi</span><span class="o">=</span><span class="mf">1e16</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SKiDl subcircuit of a primitive representation of a US 120 2 phase circuit</span>
<span class="sd">        panel with resistor separated ground from neutral and open from ground return</span>
<span class="sd">        </span>
<span class="sd">        Terminals:</span>
<span class="sd">            Load_A_posterm: Positive terminal for the A phase load </span>
<span class="sd">            Load_A_neuterm: Neutral terminal for the A phase load </span>
<span class="sd">            Load_B_posterm: Positive terminal for the B phase load </span>
<span class="sd">            Load_B_neuterm: Neutral terminal for the B phase load </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            RaA (float; 0@u_Ohm; ohms): Resistance between the A source and A terminal</span>
<span class="sd">            RbB (float; 0@u_Ohm; ohms): Resistance between the B source and B terminal</span>
<span class="sd">            RnN (float; 0@u_Ohm; ohms): Resistance between the N source and N terminal</span>
<span class="sd">            Rearth (float; 0@u_Ohm; ohms): Resistance between the earth and neutral</span>
<span class="sd">            Rgfi (float; 1e16@u_Ohm; ohms): Resistance between neutral and chassis ground gfi branch</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns a SKiDl subcircuit. Some of the internal elements SkiDl objects</span>
<span class="sd">            are also stored in `self.panel_internals` which is a dictionary with </span>
<span class="sd">            names for the objects as keys and the SkiDl object&#39;s elements as corresponding values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#ngspice treats net a == net A; so add underbar to save from singular matrix</span>
        <span class="n">net_a</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">net_A</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;A_&#39;</span><span class="p">)</span>
        <span class="n">net_b</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">net_B</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">)</span>
        <span class="n">net_n</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">);</span> <span class="n">net_N</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;N_&#39;</span><span class="p">)</span>

        <span class="c1">#create wire models to deal with voltage source parallel </span>
        <span class="c1">#to inductor singularities </span>
        <span class="n">phase_a_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;aA&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RaA</span><span class="p">);</span> <span class="n">phase_a_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_a</span><span class="p">,</span> <span class="n">net_A</span>
        <span class="n">phase_b_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;bB&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RbB</span><span class="p">);</span> <span class="n">phase_b_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_b</span><span class="p">,</span> <span class="n">net_B</span>
        <span class="n">phase_n_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;nN&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RnN</span><span class="p">);</span> <span class="n">phase_n_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_n</span><span class="p">,</span> <span class="n">net_N</span>


        <span class="c1">#bus neutral to earth</span>
        <span class="c1">#create wire (resistor) to isolate neutral and earth ground </span>
        <span class="c1">#can be used to model floating neutral</span>
        <span class="n">earth_n_sep</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;gndbus&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">Rearth</span><span class="p">)</span>
        <span class="c1">#floating neutral monitor</span>
        <span class="n">earth_ammeter</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;amm_earth&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">earth_n_sep</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_n</span><span class="p">,</span> <span class="n">earth_ammeter</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="n">earth_ammeter</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>
        
        <span class="c1">#gfi branch</span>
        <span class="c1">#isolation from netureal and chaiesse groud at load</span>
        <span class="n">gfi_monter</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;amm_gfi&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="c1">#gfi branch currernt monter</span>
        <span class="n">chiasse_n_sep</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;neu_chassie&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">Rgfi</span><span class="p">);</span>
        <span class="n">net_N</span> <span class="o">&amp;</span> <span class="n">gfi_monter</span> <span class="o">&amp;</span> <span class="n">chiasse_n_sep</span> <span class="o">&amp;</span> <span class="n">gnd</span>
        


        <span class="c1">#power behind the pannel</span>
        <span class="n">vs_Aphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">vs_Aphase</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_a</span><span class="p">,</span> <span class="n">net_n</span>
        <span class="n">vs_Bphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">),</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">vs_Bphase</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_b</span><span class="p">,</span> <span class="n">net_n</span>
        
        <span class="c1">#supciruct connections</span>
        <span class="n">net_A</span><span class="o">+=</span><span class="n">Load_A_posterm</span>
        <span class="n">net_B</span><span class="o">+=</span><span class="n">Load_B_posterm</span>
        <span class="n">net_N</span><span class="o">+=</span><span class="n">Load_A_neuterm</span><span class="p">,</span> <span class="n">Load_B_neuterm</span>
        
        <span class="c1">#stowe away the elements to read from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_internals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AM_gfi&#39;</span><span class="p">:</span><span class="n">gfi_monter</span><span class="p">,</span> <span class="s1">&#39;AM_earth&#39;</span><span class="p">:</span><span class="n">earth_ammeter</span><span class="p">,</span> 
                <span class="s1">&#39;APhase_Source&#39;</span><span class="p">:</span><span class="n">vs_Aphase</span><span class="p">,</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">:</span> <span class="n">vs_Bphase</span><span class="p">}</span>
        
        
        
    
    <span class="k">def</span> <span class="nf">draw_me</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to draw a representation of this subcircuit with </span>
<span class="sd">        load representation with lcapy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        
        <span class="c1">#supplies</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;VA a n; down, l=$0^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;VB n b; down, l=$-90^{\circ}$&#39;</span><span class="p">)</span>
        
        <span class="c1">#earth ground leg</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W n n_1; left&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rgn n_1, n_2; down, f_&gt;=Idump&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AMearth n_2 0_1; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1 0; down=0.2, ground&#39;</span><span class="p">)</span>
        
        <span class="c1">#wire legs</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RaA a A_; right=2.5, f_&gt;=Isource&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RbB b B_; right=2.5, f_&gt;=Isource&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RnN n N_; right=2.5, f&lt;_=Ireturn&#39;</span><span class="p">)</span>
        
        <span class="c1">#loads</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RloadA A_ N_; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RloadB N_ B_; down&#39;</span><span class="p">)</span>
        
        <span class="c1">#chaisse gfi branch</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W N_ N1; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Ropen N1 N2; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AMgfi N2 0_2; down, f_&gt;=Igfi&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_2 0_3; down=0.2, cground&#39;</span><span class="p">)</span>
        
        

        
        <span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">USPanel</span><span class="o">=</span><span class="n">two_phase_panel</span><span class="p">()</span>
<span class="n">USPanel</span><span class="o">.</span><span class="n">draw_me</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_63_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_63_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>

<span class="c1">#whats on the 220 outlet</span>
<span class="n">arm1</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span> 
<span class="n">arm2</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>

<span class="n">USPanel</span><span class="o">.</span><span class="n">SKiDl_circ</span><span class="p">(</span><span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">arm2</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">arm2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>


<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
VA a n DC 0V AC 120V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
VB n b DC 0V AC 120V -90.0rad SIN(0V 1V 50Hz 0s 0Hz)
L1 A_ N_7 0.10063694267515924H
L2 N_8 N_9 0.013821656050955413H
L3 N_7 N_ 0.10063694267515924H
L4 N_10 N_11 0.013821656050955413H
L5 B_ N_12 0.10063694267515924H
L6 N_13 N_14 0.013821656050955413H
L7 N_12 N_ 0.10063694267515924H
L8 N_15 N_16 0.013821656050955413H
R10 B_ N_13 0.8Ohm
R11 N_14 N_12 442.0Ohm
R12 N_12 N_15 0.8Ohm
R13 N_16 N_ 442.0Ohm
R6 A_ N_8 0.8Ohm
R7 N_9 N_7 442.0Ohm
R8 N_7 N_10 0.8Ohm
R9 N_11 N_ 442.0Ohm
RaA a A_ 0Ohm
Vamm_earth N_5 0 0V
Vamm_gfi N_ N_6 0V
RbB b B_ 0Ohm
Rgndbus n N_5 0Ohm
RnN n N_ 0Ohm
Rneu_chassie N_6 0 1e+16Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">ac_vals</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="n">start_frequency</span><span class="o">=</span><span class="mi">48</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_frequency</span><span class="o">=</span><span class="mi">62</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_base_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">USPanel</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;APhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">USPanel</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;APhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">USPanel</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">USPanel</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135550-1.978080j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.978144-0.135559j</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135549-1.972277j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.972341-0.135558j</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135549-1.966508j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.966572-0.135558j</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.960772j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.960836-0.135557j</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.955071j</td>
      <td>-0.000000+120.000000j</td>
      <td>-1.955134-0.135557j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>120.000000+0.000000j</td>
      <td>0.135518-1.546158j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.546198-0.135525j</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>120.000000+0.000000j</td>
      <td>0.135517-1.542615j</td>
      <td>-0.000000+120.000000j</td>
      <td>-1.542654-0.135524j</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>120.000000-0.000000j</td>
      <td>0.135517-1.539088j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.539127-0.135524j</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>120.000000+0.000000j</td>
      <td>0.135517-1.535577j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.535616-0.135524j</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>120.000000-0.000000j</td>
      <td>0.135517-1.532082j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.532121-0.135524j</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 4 columns</p>
</div></div></div>
</div>
<p>From here we will look that the power on each phase and across the phases</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_AB</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>


<span class="n">ac_data_AB</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_AB</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&lt;AxesSubplot:xlabel=&#39;freq[Hz]&#39;&gt;, &lt;AxesSubplot:xlabel=&#39;freq[Hz]&#39;&gt;],
      dtype=object)
</pre></div>
</div>
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_68_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_68_1.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_68_2.png" src="../_images/AC_1_One-Two-Three_Phase_AC_68_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_AB</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">ac_data_AB</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>Source_AB_I_[A]</th>
      <th>Source_AB_iphase_[deg]</th>
      <th>Source_AB_p_[W]</th>
      <th>Source_AB_P_[W]</th>
      <th>Source_AB_Q_[VAR]</th>
      <th>Source_AB_S_[VA]</th>
      <th>Source_AB_s_[VA]</th>
      <th>Source_AB_pf_[]</th>
      <th>Source_AB_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135550-1.978080j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.978144-0.135559j</td>
      <td>120.000000-120.000000j</td>
      <td>169.705627</td>
      <td>-45.0</td>
      <td>2.113694-1.842521j</td>
      <td>2.804030</td>
      <td>-41.078873</td>
      <td>32.540817-474.745789j</td>
      <td>237.372894</td>
      <td>-16.270409</td>
      <td>237.372894-16.270409j</td>
      <td>237.929855</td>
      <td>0.997659</td>
      <td>3.921114</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135549-1.972277j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.972341-0.135558j</td>
      <td>120.000000-120.000000j</td>
      <td>169.705627</td>
      <td>-45.0</td>
      <td>2.107890-1.836718j</td>
      <td>2.795843</td>
      <td>-41.067390</td>
      <td>32.540634-473.353027j</td>
      <td>236.676514</td>
      <td>-16.270317</td>
      <td>236.676514-16.270317j</td>
      <td>237.235107</td>
      <td>0.997645</td>
      <td>3.932633</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135549-1.966508j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.966572-0.135558j</td>
      <td>120.000000-120.000000j</td>
      <td>169.705627</td>
      <td>-45.0</td>
      <td>2.102121-1.830950j</td>
      <td>2.787703</td>
      <td>-41.055908</td>
      <td>32.540482-471.968445j</td>
      <td>235.984222</td>
      <td>-16.270241</td>
      <td>235.984222-16.270241j</td>
      <td>236.544449</td>
      <td>0.997632</td>
      <td>3.944119</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.960772j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.960836-0.135557j</td>
      <td>120.000000-120.000000j</td>
      <td>169.705627</td>
      <td>-45.0</td>
      <td>2.096385-1.825215j</td>
      <td>2.779611</td>
      <td>-41.044426</td>
      <td>32.540329-470.591980j</td>
      <td>235.295990</td>
      <td>-16.270164</td>
      <td>235.295990-16.270164j</td>
      <td>235.857834</td>
      <td>0.997618</td>
      <td>3.955522</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.955071j</td>
      <td>-0.000000+120.000000j</td>
      <td>-1.955134-0.135557j</td>
      <td>120.000000-120.000000j</td>
      <td>169.705627</td>
      <td>-45.0</td>
      <td>2.090682-1.819514j</td>
      <td>2.771567</td>
      <td>-41.032948</td>
      <td>32.540176-469.223511j</td>
      <td>234.611755</td>
      <td>-16.270088</td>
      <td>234.611755-16.270088j</td>
      <td>235.175232</td>
      <td>0.997604</td>
      <td>3.967041</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_69_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_69_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_base_df</span><span class="p">,</span> <span class="s1">&#39;SourceA&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_base_df</span><span class="p">,</span> <span class="s1">&#39;SourceA&#39;</span><span class="p">)</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceA_p_[W]</th>
      <th>SourceA_P_[W]</th>
      <th>SourceA_Q_[VAR]</th>
      <th>SourceA_S_[VA]</th>
      <th>SourceA_s_[VA]</th>
      <th>SourceA_pf_[]</th>
      <th>SourceA_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135550-1.978080j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.978144-0.135559j</td>
      <td>16.265974-237.369553j</td>
      <td>8.132987</td>
      <td>118.684776</td>
      <td>8.132987+118.684776j</td>
      <td>118.963112</td>
      <td>0.068366</td>
      <td>86.079880</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135549-1.972277j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.972341-0.135558j</td>
      <td>16.265923-236.673187j</td>
      <td>8.132961</td>
      <td>118.336594</td>
      <td>8.132961+118.336594j</td>
      <td>118.615746</td>
      <td>0.068566</td>
      <td>86.068390</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135549-1.966508j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.966572-0.135558j</td>
      <td>16.265869-235.980927j</td>
      <td>8.132935</td>
      <td>117.990463</td>
      <td>8.132935+117.990463j</td>
      <td>118.270424</td>
      <td>0.068766</td>
      <td>86.056908</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.960772j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.960836-0.135557j</td>
      <td>16.265816-235.292694j</td>
      <td>8.132908</td>
      <td>117.646347</td>
      <td>8.132908+117.646347j</td>
      <td>117.927124</td>
      <td>0.068966</td>
      <td>86.045418</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.955071j</td>
      <td>-0.000000+120.000000j</td>
      <td>-1.955134-0.135557j</td>
      <td>16.265764-234.608475j</td>
      <td>8.132882</td>
      <td>117.304237</td>
      <td>8.132882+117.304237j</td>
      <td>117.585831</td>
      <td>0.069165</td>
      <td>86.033936</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_70_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_70_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_base_df</span><span class="p">,</span> <span class="s1">&#39;SourceB&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_base_df</span><span class="p">,</span> <span class="s1">&#39;SourceB&#39;</span><span class="p">)</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceA_p_[W]</th>
      <th>SourceA_P_[W]</th>
      <th>SourceA_Q_[VAR]</th>
      <th>SourceA_S_[VA]</th>
      <th>SourceA_s_[VA]</th>
      <th>SourceA_pf_[]</th>
      <th>SourceA_pfang_[deg]</th>
      <th>SourceB_p_[W]</th>
      <th>SourceB_P_[W]</th>
      <th>SourceB_Q_[VAR]</th>
      <th>SourceB_S_[VA]</th>
      <th>SourceB_s_[VA]</th>
      <th>SourceB_pf_[]</th>
      <th>SourceB_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135550-1.978080j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.978144-0.135559j</td>
      <td>16.265974-237.369553j</td>
      <td>8.132987</td>
      <td>118.684776</td>
      <td>8.132987+118.684776j</td>
      <td>118.963112</td>
      <td>0.068366</td>
      <td>86.079880</td>
      <td>16.267048-237.377335j</td>
      <td>-8.133524</td>
      <td>-118.688667</td>
      <td>-8.133524-118.688667j</td>
      <td>118.967026</td>
      <td>-0.068368</td>
      <td>93.920242</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135549-1.972277j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.972341-0.135558j</td>
      <td>16.265923-236.673187j</td>
      <td>8.132961</td>
      <td>118.336594</td>
      <td>8.132961+118.336594j</td>
      <td>118.615746</td>
      <td>0.068566</td>
      <td>86.068390</td>
      <td>16.266991-236.680923j</td>
      <td>-8.133495</td>
      <td>-118.340462</td>
      <td>-8.133495-118.340462j</td>
      <td>118.619637</td>
      <td>-0.068568</td>
      <td>93.931725</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135549-1.966508j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.966572-0.135558j</td>
      <td>16.265869-235.980927j</td>
      <td>8.132935</td>
      <td>117.990463</td>
      <td>8.132935+117.990463j</td>
      <td>118.270424</td>
      <td>0.068766</td>
      <td>86.056908</td>
      <td>16.266935-235.988617j</td>
      <td>-8.133468</td>
      <td>-117.994308</td>
      <td>-8.133468-117.994308j</td>
      <td>118.274300</td>
      <td>-0.068768</td>
      <td>93.943214</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.960772j</td>
      <td>0.000000+120.000000j</td>
      <td>-1.960836-0.135557j</td>
      <td>16.265816-235.292694j</td>
      <td>8.132908</td>
      <td>117.646347</td>
      <td>8.132908+117.646347j</td>
      <td>117.927124</td>
      <td>0.068966</td>
      <td>86.045418</td>
      <td>16.266880-235.300339j</td>
      <td>-8.133440</td>
      <td>-117.650169</td>
      <td>-8.133440-117.650169j</td>
      <td>117.930977</td>
      <td>-0.068968</td>
      <td>93.954697</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000+0.000000j</td>
      <td>0.135548-1.955071j</td>
      <td>-0.000000+120.000000j</td>
      <td>-1.955134-0.135557j</td>
      <td>16.265764-234.608475j</td>
      <td>8.132882</td>
      <td>117.304237</td>
      <td>8.132882+117.304237j</td>
      <td>117.585831</td>
      <td>0.069165</td>
      <td>86.033936</td>
      <td>16.266825-234.616089j</td>
      <td>-8.133412</td>
      <td>-117.308044</td>
      <td>-8.133412-117.308044j</td>
      <td>117.589668</td>
      <td>-0.069168</td>
      <td>93.966179</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_71_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_71_1.png" />
</div>
</div>
</div>
<div class="section" id="three-phase-four-wire-y-star-topology">
<h1>Three Phase Four Wire Y (Star) Topology ¶<a class="headerlink" href="#three-phase-four-wire-y-star-topology" title="Permalink to this headline">¶</a></h1>
<p>To be complete we also model the two variations of three-phase circuit topologies commonly found. We will start with the so-called Y (or star) topology which from a circuit topology standpoint is just a variation of the North American two-phase. Where a third C phase is added and all the phase source negative terminal are bounded to the neutral with 120 degrees of separation between the phases. Thus the Y topology testbench below includes the same overall structures as the <code class="docutils literal notranslate"><span class="pre">two_phase_panel</span></code> testbench has with resistor isolated neutral with separate branches to earth and chassis return.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 three_phaseY_panel class</span>
<span class="c1">#class to create a SPICE model of a three-phase Y source</span>
<span class="c1">#with ground branch and gfi branch in addition to neutral branch</span>

<span class="k">class</span> <span class="nc">three_phaseY_panel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to contain the needed Skidl package (method) to invoke the circuit for simulations</span>
<span class="sd">    and drawing just the packaged circuit via lcapy.</span>
<span class="sd">    </span>
<span class="sd">    The circuit in hand is a model of a 3 phase Y (star) source circuit with resistor separated</span>
<span class="sd">    neutral from the ground along with an open separation to a parallel gfi path for chassis ground to the earth ground</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl_circ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Load_A_posterm</span><span class="p">,</span> <span class="n">Load_A_neuterm</span><span class="p">,</span>
                   <span class="n">Load_B_posterm</span><span class="p">,</span> <span class="n">Load_B_neuterm</span><span class="p">,</span>
                   <span class="n">Load_C_posterm</span><span class="p">,</span> <span class="n">Load_C_neuterm</span><span class="p">,</span>
                  <span class="n">RaA</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">RbB</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">RcC</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">RnN</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> 
                  <span class="n">Rearth</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">,</span> <span class="n">Rgfi</span><span class="o">=</span><span class="mf">1e16</span><span class="nd">@u_Ohm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SKiDl subcircuit of a primitive representation of a 3 phase Y (star)  circuit</span>
<span class="sd">        panel with resistor separated ground from neutral and open from ground return</span>
<span class="sd">        </span>
<span class="sd">        Terminals:</span>
<span class="sd">            Load_A_posterm: Positive terminal for the A phase load </span>
<span class="sd">            Load_A_neuterm: Neutral terminal for the A phase load </span>
<span class="sd">            Load_B_posterm: Positive terminal for the B phase load </span>
<span class="sd">            Load_B_neuterm: Neutral termanl for the B phase load</span>
<span class="sd">            Load_C_posterm: Positive terminal for the C phase load </span>
<span class="sd">            Load_C_neuterm: Neutral terminal for the C phase load </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            RaA (float; 0@u_Ohm; ohms): Resistance between the A source and A terminal</span>
<span class="sd">            RbB (float; 0@u_Ohm; ohms): Resistance between the B source and B terminal</span>
<span class="sd">            RcC (float; 0@u_Ohm; ohms): Resistance between the C source and C terminal</span>
<span class="sd">            RnN (float; 0@u_Ohm; ohms): Resistance between the N source and N terminal</span>
<span class="sd">            Rearth (float; 0@u_Ohm; ohms): Resistance between the earth and neutral</span>
<span class="sd">            Rgfi (float; 1e16@u_Ohm; ohms): Resistance between neutral and chassis ground gfi branch</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns a SKiDl subcircuit. Some of the internal elements SkiDl objects</span>
<span class="sd">            are also stored in `self.panel_internals` which is a dictionary with </span>
<span class="sd">            names for the objects as keys and the SkiDl object&#39;s elements as corresponding values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#ngspice treats net a == net A; so add underbar to save from singular matrix</span>
        <span class="n">net_a</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">net_A</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;A_&#39;</span><span class="p">)</span>
        <span class="n">net_b</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">net_B</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">)</span>
        <span class="n">net_c</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">);</span> <span class="n">net_C</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;C_&#39;</span><span class="p">)</span>
        <span class="n">net_n</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">);</span> <span class="n">net_N</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;N_&#39;</span><span class="p">)</span>

        <span class="c1">#create wire models to deal with voltage source parallel </span>
        <span class="c1">#to inductor singularities </span>
        <span class="n">phase_a_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;aA&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RaA</span><span class="p">);</span> <span class="n">phase_a_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_a</span><span class="p">,</span> <span class="n">net_A</span>
        <span class="n">phase_b_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;bB&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RbB</span><span class="p">);</span> <span class="n">phase_b_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_b</span><span class="p">,</span> <span class="n">net_B</span>
        <span class="n">phase_c_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;cC&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RcC</span><span class="p">);</span> <span class="n">phase_c_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_c</span><span class="p">,</span> <span class="n">net_C</span>
        <span class="n">phase_n_wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;nN&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">RnN</span><span class="p">);</span> <span class="n">phase_n_wire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_n</span><span class="p">,</span> <span class="n">net_N</span>


        <span class="c1">#bus neutral to earth</span>
        <span class="c1">#create wire (resistor) to isolate neutral and earth ground </span>
        <span class="c1">#can be used to model floating neutral</span>
        <span class="n">earth_n_sep</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;gndbus&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">Rearth</span><span class="p">)</span>
        <span class="c1">#floating neutral monitor</span>
        <span class="n">earth_ammeter</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;amm_earth&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">earth_n_sep</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">net_n</span><span class="p">,</span> <span class="n">earth_ammeter</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="n">earth_ammeter</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">gnd</span>
        
        <span class="c1">#gfi branch</span>
        <span class="c1">#isolation from netureal and chaiesse groud at load</span>
        <span class="n">gfi_monter</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;amm_gfi&#39;</span><span class="p">,</span> <span class="n">dc_value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="c1">#gfi branch currernt monter</span>
        <span class="n">chiasse_n_sep</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;neu_chassie&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">Rgfi</span><span class="p">);</span>
        <span class="n">net_N</span> <span class="o">&amp;</span> <span class="n">gfi_monter</span> <span class="o">&amp;</span> <span class="n">chiasse_n_sep</span> <span class="o">&amp;</span> <span class="n">gnd</span>
        


        <span class="c1">#power behind the pannel</span>
        <span class="n">vs_Aphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">vs_Aphase</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_a</span><span class="p">,</span> <span class="n">net_n</span>
        <span class="n">vs_Bphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">),</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">vs_Bphase</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_b</span><span class="p">,</span> <span class="n">net_n</span>
        <span class="n">vs_Cphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">vs_Cphase</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">net_c</span><span class="p">,</span> <span class="n">net_n</span>
        
        <span class="c1">#supciruct connections</span>
        <span class="n">net_A</span><span class="o">+=</span><span class="n">Load_A_posterm</span>
        <span class="n">net_B</span><span class="o">+=</span><span class="n">Load_B_posterm</span>
        <span class="n">net_C</span><span class="o">+=</span><span class="n">Load_C_posterm</span>
        <span class="n">net_N</span><span class="o">+=</span><span class="n">Load_A_neuterm</span><span class="p">,</span> <span class="n">Load_B_neuterm</span><span class="p">,</span> <span class="n">Load_C_neuterm</span>
        
        <span class="c1">#stowe away the elements to read from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_internals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AM_gfi&#39;</span><span class="p">:</span><span class="n">gfi_monter</span><span class="p">,</span> <span class="s1">&#39;AM_earth&#39;</span><span class="p">:</span><span class="n">earth_ammeter</span><span class="p">,</span> 
                <span class="s1">&#39;APhase_Source&#39;</span><span class="p">:</span><span class="n">vs_Aphase</span><span class="p">,</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">:</span> <span class="n">vs_Bphase</span><span class="p">,</span> <span class="s1">&#39;CPhase_Source&#39;</span><span class="p">:</span> <span class="n">vs_Cphase</span><span class="p">}</span>
        
        
        
    
    <span class="k">def</span> <span class="nf">draw_me</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to draw a representation of this subcircuit with </span>
<span class="sd">        load representation with lcapy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        
        <span class="c1">#supplies</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;VA a na; down=3, l=$0^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W na nb; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;VB b nb; down=2, l=$-120^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W nb nc; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;VC c nc; down, l=$120^{\circ}$&#39;</span><span class="p">)</span>

        
        <span class="c1">#earth ground leg</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W na n_1; left&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rgn n_1, n_2; down, f_&gt;=Idump&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AMearth n_2 0_1; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_1 0; down=0.2, ground&#39;</span><span class="p">)</span>
        
        <span class="c1">#wire legs</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RaA a A_; right=2.5, f_&gt;=Isource&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RbB b B_; right=2.5, f_&gt;=Isource&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RcC c C_; right=2.5, f_&gt;=Isource&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RnN nc N_C; right=2.5, f&lt;_=Ireturn&#39;</span><span class="p">)</span>
        
        <span class="c1">#loads</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RloadC C_ N_C; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W N_C N_B; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RloadB B_ N_B; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W N_B N_A; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;RloadA A_ N_A; down&#39;</span><span class="p">)</span>

        
        <span class="c1">#chaisse gfi branch</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W N_A N1; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Ropen N1 N2; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;AMgfi N2 0_2; down, f_&gt;=Igfi&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0_2 0_3; down=0.2, cground&#39;</span><span class="p">)</span>
        
        

        
        <span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y3</span><span class="o">=</span><span class="n">three_phaseY_panel</span><span class="p">()</span>
<span class="n">Y3</span><span class="o">.</span><span class="n">draw_me</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_74_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_74_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">arm1</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span> 
<span class="n">arm2</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>
<span class="n">arm3</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>


<span class="n">Y3</span><span class="o">.</span><span class="n">SKiDl_circ</span><span class="p">(</span><span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">arm2</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">arm2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">arm3</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">arm3</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>


<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
VA a n DC 0V AC 120V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
VB b n DC 0V AC 120V -119.99999999999999rad SIN(0V 1V 50Hz 0s 0Hz)
VC c n DC 0V AC 120V 119.99999999999999rad SIN(0V 1V 50Hz 0s 0Hz)
L1 A_ N_9 0.10063694267515924H
L10 N_20 N_21 0.013821656050955413H
L11 N_19 N_ 0.10063694267515924H
L12 N_22 N_23 0.013821656050955413H
L2 N_10 N_11 0.013821656050955413H
L3 N_9 N_ 0.10063694267515924H
L4 N_12 N_13 0.013821656050955413H
L5 B_ N_14 0.10063694267515924H
L6 N_15 N_16 0.013821656050955413H
L7 N_14 N_ 0.10063694267515924H
L8 N_17 N_18 0.013821656050955413H
L9 C_ N_19 0.10063694267515924H
R10 N_13 N_ 442.0Ohm
R11 B_ N_15 0.8Ohm
R12 N_16 N_14 442.0Ohm
R13 N_14 N_17 0.8Ohm
R14 N_18 N_ 442.0Ohm
R15 C_ N_20 0.8Ohm
R16 N_21 N_19 442.0Ohm
R17 N_19 N_22 0.8Ohm
R18 N_23 N_ 442.0Ohm
R7 A_ N_10 0.8Ohm
R8 N_11 N_9 442.0Ohm
R9 N_9 N_12 0.8Ohm
RaA a A_ 0Ohm
Vamm_earth N_7 0 0V
Vamm_gfi N_ N_8 0V
RbB b B_ 0Ohm
RcC c C_ 0Ohm
Rgndbus n N_7 0Ohm
RnN n N_ 0Ohm
Rneu_chassie N_8 0 1e+16Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors or warnings found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">ac_vals</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="n">start_frequency</span><span class="o">=</span><span class="mi">48</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_frequency</span><span class="o">=</span><span class="mi">62</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_base_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;APhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;APhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;CPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">Y3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;CPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>


<span class="n">ac_data_base_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135522-1.978116j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.780860+0.871693j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.645338+1.106423j</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135522-1.972313j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.775834+0.868792j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.640313+1.103522j</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.966544j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.770838+0.865907j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.635316+1.100637j</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.960809j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.765871+0.863040j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.630350+1.097769j</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000-0.000000j</td>
      <td>0.135521-1.955107j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.760932+0.860189j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.625412+1.094918j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>120.000000+0.000000j</td>
      <td>0.135501-1.546182j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.406783+0.655743j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.271282+0.890438j</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>120.000000+0.000000j</td>
      <td>0.135501-1.542638j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.403714+0.653972j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.268213+0.888667j</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>120.000000+0.000000j</td>
      <td>0.135501-1.539111j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.400660+0.652208j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.265159+0.886903j</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>120.000000+0.000000j</td>
      <td>0.135501-1.535600j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.397619+0.650453j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.262118+0.885147j</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135501-1.532105j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.394592+0.648705j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.259091+0.883400j</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_ABC</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#AB voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#AB current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">####################################################################################</span>
<span class="c1">#BC voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#BC current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">####################################################################################</span>
<span class="c1">#CA voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#CA current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>


<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_BC_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_BC_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_BC_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_BC_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_CA_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_CA_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_CA_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_CA_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&lt;AxesSubplot:xlabel=&#39;freq[Hz]&#39;&gt;, &lt;AxesSubplot:xlabel=&#39;freq[Hz]&#39;&gt;],
      dtype=object)
</pre></div>
</div>
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_1.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_2.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_2.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_3.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_3.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_4.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_4.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_5.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_5.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_78_6.png" src="../_images/AC_1_One-Two-Three_Phase_AC_78_6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_CA_i_[A]</th>
      <th>Source_CA_I_[A]</th>
      <th>Source_CA_iphase_[deg]</th>
      <th>Source_AB_p_[W]</th>
      <th>Source_AB_P_[W]</th>
      <th>Source_AB_Q_[VAR]</th>
      <th>Source_AB_S_[VA]</th>
      <th>Source_AB_s_[VA]</th>
      <th>Source_AB_pf_[]</th>
      <th>Source_AB_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135522-1.978116j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.780860+0.871693j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.645338+1.106423j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.916382-2.849809j</td>
      <td>...</td>
      <td>1.509816+3.084540j</td>
      <td>3.434229</td>
      <td>63.919239</td>
      <td>641.109558-313.809387j</td>
      <td>24.393921</td>
      <td>356.060944</td>
      <td>24.393921+356.060944j</td>
      <td>356.895599</td>
      <td>0.06835</td>
      <td>86.080750</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135522-1.972313j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.775834+0.868792j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.640313+1.103522j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.911356-2.841105j</td>
      <td>...</td>
      <td>1.504791+3.075835j</td>
      <td>3.424202</td>
      <td>63.930729</td>
      <td>639.300293-312.764954j</td>
      <td>24.393890</td>
      <td>355.016388</td>
      <td>24.393890+355.016388j</td>
      <td>355.853485</td>
      <td>0.06855</td>
      <td>86.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.966544j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.770838+0.865907j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.635316+1.100637j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.906359-2.832451j</td>
      <td>...</td>
      <td>1.499795+3.067181j</td>
      <td>3.414233</td>
      <td>63.942215</td>
      <td>637.501587-311.726593j</td>
      <td>24.393814</td>
      <td>353.977966</td>
      <td>24.393814+353.977966j</td>
      <td>354.817505</td>
      <td>0.06875</td>
      <td>86.057785</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.960809j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.765871+0.863040j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.630350+1.097769j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.901392-2.823848j</td>
      <td>...</td>
      <td>1.494829+3.058578j</td>
      <td>3.404322</td>
      <td>63.953705</td>
      <td>635.713501-310.694275j</td>
      <td>24.393784</td>
      <td>352.945587</td>
      <td>24.393784+352.945587j</td>
      <td>353.787567</td>
      <td>0.06895</td>
      <td>86.046295</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000-0.000000j</td>
      <td>0.135521-1.955107j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.760932+0.860189j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.625412+1.094918j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.896453-2.815296j</td>
      <td>...</td>
      <td>1.489891+3.050025j</td>
      <td>3.394470</td>
      <td>63.965187</td>
      <td>633.935669-309.668030j</td>
      <td>24.393723</td>
      <td>351.919220</td>
      <td>24.393723+351.919220j</td>
      <td>352.763641</td>
      <td>0.06915</td>
      <td>86.034805</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_79_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_79_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_BC&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_BC&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_AB_s_[VA]</th>
      <th>Source_AB_pf_[]</th>
      <th>Source_AB_pfang_[deg]</th>
      <th>Source_BC_p_[W]</th>
      <th>Source_BC_P_[W]</th>
      <th>Source_BC_Q_[VAR]</th>
      <th>Source_BC_S_[VA]</th>
      <th>Source_BC_s_[VA]</th>
      <th>Source_BC_pf_[]</th>
      <th>Source_BC_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135522-1.978116j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.780860+0.871693j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.645338+1.106423j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.916382-2.849809j</td>
      <td>...</td>
      <td>356.895599</td>
      <td>0.06835</td>
      <td>86.080750</td>
      <td>-48.787842+712.121887j</td>
      <td>24.393921</td>
      <td>356.060944</td>
      <td>24.393921+356.060944j</td>
      <td>356.895599</td>
      <td>0.06835</td>
      <td>86.080750</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135522-1.972313j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.775834+0.868792j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.640313+1.103522j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.911356-2.841105j</td>
      <td>...</td>
      <td>355.853485</td>
      <td>0.06855</td>
      <td>86.069267</td>
      <td>-48.787754+710.032776j</td>
      <td>24.393877</td>
      <td>355.016388</td>
      <td>24.393877+355.016388j</td>
      <td>355.853485</td>
      <td>0.06855</td>
      <td>86.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.966544j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.770838+0.865907j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.635316+1.100637j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.906359-2.832451j</td>
      <td>...</td>
      <td>354.817505</td>
      <td>0.06875</td>
      <td>86.057785</td>
      <td>-48.787666+707.955872j</td>
      <td>24.393833</td>
      <td>353.977936</td>
      <td>24.393833+353.977936j</td>
      <td>354.817474</td>
      <td>0.06875</td>
      <td>86.057777</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.960809j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.765871+0.863040j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.630350+1.097769j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.901392-2.823848j</td>
      <td>...</td>
      <td>353.787567</td>
      <td>0.06895</td>
      <td>86.046295</td>
      <td>-48.787567+705.891113j</td>
      <td>24.393784</td>
      <td>352.945557</td>
      <td>24.393784+352.945557j</td>
      <td>353.787537</td>
      <td>0.06895</td>
      <td>86.046295</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000-0.000000j</td>
      <td>0.135521-1.955107j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.760932+0.860189j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.625412+1.094918j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.896453-2.815296j</td>
      <td>...</td>
      <td>352.763641</td>
      <td>0.06915</td>
      <td>86.034805</td>
      <td>-48.787479+703.838440j</td>
      <td>24.393740</td>
      <td>351.919220</td>
      <td>24.393740+351.919220j</td>
      <td>352.763641</td>
      <td>0.06915</td>
      <td>86.034805</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 38 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_80_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_80_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_CA&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_CA&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_BC_s_[VA]</th>
      <th>Source_BC_pf_[]</th>
      <th>Source_BC_pfang_[deg]</th>
      <th>Source_CA_p_[W]</th>
      <th>Source_CA_P_[W]</th>
      <th>Source_CA_Q_[VAR]</th>
      <th>Source_CA_S_[VA]</th>
      <th>Source_CA_s_[VA]</th>
      <th>Source_CA_pf_[]</th>
      <th>Source_CA_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>120.000000+0.000000j</td>
      <td>0.135522-1.978116j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.780860+0.871693j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.645338+1.106423j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.916382-2.849809j</td>
      <td>...</td>
      <td>356.895599</td>
      <td>0.06835</td>
      <td>86.080750</td>
      <td>-592.321777-398.312439j</td>
      <td>24.393906</td>
      <td>356.060944</td>
      <td>24.393906+356.060944j</td>
      <td>356.895599</td>
      <td>0.06835</td>
      <td>86.080757</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>120.000000-0.000000j</td>
      <td>0.135522-1.972313j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.775834+0.868792j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.640313+1.103522j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.911356-2.841105j</td>
      <td>...</td>
      <td>355.853485</td>
      <td>0.06855</td>
      <td>86.069267</td>
      <td>-590.512573-397.267761j</td>
      <td>24.393875</td>
      <td>355.016388</td>
      <td>24.393875+355.016388j</td>
      <td>355.853485</td>
      <td>0.06855</td>
      <td>86.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.966544j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.770838+0.865907j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.635316+1.100637j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.906359-2.832451j</td>
      <td>...</td>
      <td>354.817474</td>
      <td>0.06875</td>
      <td>86.057777</td>
      <td>-588.713989-396.229309j</td>
      <td>24.393845</td>
      <td>353.977936</td>
      <td>24.393845+353.977936j</td>
      <td>354.817474</td>
      <td>0.06875</td>
      <td>86.057777</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>120.000000+0.000000j</td>
      <td>0.135521-1.960809j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.765871+0.863040j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.630350+1.097769j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.901392-2.823848j</td>
      <td>...</td>
      <td>353.787537</td>
      <td>0.06895</td>
      <td>86.046295</td>
      <td>-586.925903-395.196838j</td>
      <td>24.393784</td>
      <td>352.945587</td>
      <td>24.393784+352.945587j</td>
      <td>353.787567</td>
      <td>0.06895</td>
      <td>86.046295</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>120.000000-0.000000j</td>
      <td>0.135521-1.955107j</td>
      <td>-60.000000-103.923050j</td>
      <td>-1.760932+0.860189j</td>
      <td>-60.000000+103.923050j</td>
      <td>1.625412+1.094918j</td>
      <td>180.000000+103.923050j</td>
      <td>207.8461</td>
      <td>30.000002</td>
      <td>1.896453-2.815296j</td>
      <td>...</td>
      <td>352.763641</td>
      <td>0.06915</td>
      <td>86.034805</td>
      <td>-585.148193-394.170380j</td>
      <td>24.393723</td>
      <td>351.919189</td>
      <td>24.393723+351.919189j</td>
      <td>352.763611</td>
      <td>0.06915</td>
      <td>86.034805</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 45 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_81_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_81_1.png" />
</div>
</div>
</div>
<div class="section" id="three-phase-three-wire-delta-topology">
<h1>Three Phase Three Wire <span class="math notranslate nohighlight">\(\Delta\)</span>  Topology<a class="headerlink" href="#three-phase-three-wire-delta-topology" title="Permalink to this headline">¶</a></h1>
<p>Delta topologies are just weird, I have only had to work with them once when dealing with a 480V heater on an ancient giant diffusion pump. (if you don’t know what a diffusion pump is just watch Applied Science’s video on <a class="reference external" href="https://youtu.be/SrNVLCHrJtY">“Giant glass diffusion pump and cathode ray tube demo”</a> )  ) The issue with them is that there is no neutral or ground. So because of that there being phased out when not needed. And there are ways to convert between them but to do it properly requires some specialty power engineering that is beyond this book. But for the analytical conversion see the YT videos by ALL ABOUT ELECTRONICS <a class="reference external" href="https://youtu.be/9b17eqCT4-g">“Star to Delta Conversion (With Proof and Example)”</a> &amp; <a class="reference external" href="https://youtu.be/OV0qi7yzKAM">“Delta to Star Conversion (with proof and example)”</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;9b17eqCT4-g&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/9b17eqCT4-g"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;OV0qi7yzKAM&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="500"
    height="400"
    src="https://www.youtube.com/embed/OV0qi7yzKAM"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
<p>In recreating the Delta configuration in SPICE since there is no neutral or ground and SPICE requires one it can be a challenge to add one. One school of thought is to just add a ground to any of the phases. This not ideal since when measuring a Delta circuit in the wild the measurements are done between the phases and there is no ground involved. So instead we have opted to use the Delta circuit SPICE model employed by Alexander &amp; Sadiki in their standard entry text “Fundamentals of Electric Circuits”. This method of modeling hides the ground behind open resistors connected to each phase. This is a far more robust and more representative way of modeling a Delta circuit. On top of that zero Ohm resistors are added to each of the three phases negative terminal to avoid a loop error in SPICE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%writefile -a AC_2_Codes.py</span>
<span class="c1">#chapteer 2 section1 three_phaseDelta_panel class</span>
<span class="c1">#class to create a SPICE model of a three-phase Delta source</span>


<span class="k">class</span> <span class="nc">three_phaseDelta_panel</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="nd">@subcircuit</span>
    <span class="k">def</span> <span class="nf">SKiDl_circ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aterm_power</span><span class="p">,</span> <span class="n">Bterm_power</span><span class="p">,</span> <span class="n">Cterm_power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SKiDl subcircuit of a primitive representation of a US 120 2 phase circuit</span>
<span class="sd">        panel with resistor separated ground from neutral and open from ground return</span>
<span class="sd">        </span>
<span class="sd">        Terminals:</span>
<span class="sd">            Aterm_power: terminal for the A phase to load </span>
<span class="sd">            Bterm_power: terminal for the B phase to load </span>
<span class="sd">            Cterm_power: terminal for the C phase to load </span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            returns a SKiDl subcircuit. Some of the internal elements SkiDl objects</span>
<span class="sd">            are also stored in `self.panel_internals` which is a dictionary with </span>
<span class="sd">            names for the objects as keys and the SkiDl object&#39;s elements as corresponding values</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">net_a</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">net_b</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">net_c</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
        
        <span class="c1">#things connected to terminal a</span>
        <span class="n">vs_ABphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">rabwire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;abwire&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">ragnd_open</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;aopen&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e16</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">net_a</span> <span class="o">&amp;</span> <span class="n">vs_ABphase</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">rabwire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_b</span>
        <span class="n">net_a</span> <span class="o">&amp;</span> <span class="n">ragnd_open</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">gnd</span>
        
        <span class="c1">#things connected to terminal b</span>
        <span class="n">vs_BCphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">),</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">rbcwire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;bcwire&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">rbgnd_open</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;bopen&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e16</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">net_b</span> <span class="o">&amp;</span> <span class="n">vs_BCphase</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">rbcwire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_c</span>
        <span class="n">net_b</span> <span class="o">&amp;</span> <span class="n">rbgnd_open</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">gnd</span>
        
        <span class="c1">#things connected to terminal c</span>
        <span class="n">vs_CAphase</span><span class="o">=</span><span class="n">SINEV</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="n">ac_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span>  <span class="n">ac_magnitude</span><span class="o">=</span><span class="mi">120</span><span class="nd">@u_V</span><span class="p">)</span>
        <span class="n">rcawire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;cawire&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">rcgnd_open</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;copen&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e16</span><span class="nd">@u_Ohm</span><span class="p">)</span>
        <span class="n">net_c</span> <span class="o">&amp;</span> <span class="n">vs_CAphase</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">rcawire</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_a</span>
        <span class="n">net_c</span> <span class="o">&amp;</span> <span class="n">rcgnd_open</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">gnd</span>


        
        <span class="c1"># make the connections to the rest of the circuit</span>
        <span class="n">net_a</span><span class="o">+=</span><span class="n">Aterm_power</span>
        <span class="n">net_b</span><span class="o">+=</span><span class="n">Bterm_power</span>
        <span class="n">net_c</span><span class="o">+=</span><span class="n">Cterm_power</span>
        
        
        
        
        
        <span class="c1">#stowe away the elements to read from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_internals</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;ABPhase_Source&#39;</span><span class="p">:</span><span class="n">vs_ABphase</span><span class="p">,</span><span class="s1">&#39;BCPhase_Source&#39;</span><span class="p">:</span> <span class="n">vs_BCphase</span><span class="p">,</span> <span class="s1">&#39;CAPhase_Source&#39;</span><span class="p">:</span> <span class="n">vs_CAphase</span><span class="p">}</span>
        
        
        
    
    <span class="k">def</span> <span class="nf">draw_me</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to draw a representation of this subcircuit with </span>
<span class="sd">        load representation with lcapy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">schematic</span><span class="o">=</span><span class="n">kiwi</span><span class="o">.</span><span class="n">Circuit</span><span class="p">()</span>
        
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W c1 c; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W c2 c1; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W c3 c2; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W vc c3; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vca vc va; up, l=$120^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rcawire va a3; up&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W a3 a2; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W a2 a1; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W a1 a; right&#39;</span><span class="p">)</span>
        
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Ragnd a2 0; down&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rcgnd c2 0; up&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rbgnd 0 b1; right&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W 0 0_1; left=0.2, ground&#39;</span><span class="p">)</span>

        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vab a1 vb; down, l=$0^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rabwire vb b1; down&#39;</span><span class="p">)</span>
        
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Vbc b1 vc1; down, l=$-120^{\circ}$&#39;</span><span class="p">)</span>
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Rbcwire vc1 c1; down&#39;</span><span class="p">)</span>
        
        <span class="n">schematic</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;W b1 b; right&#39;</span><span class="p">)</span>

        
        <span class="n">schematic</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D3</span><span class="o">=</span><span class="n">three_phaseDelta_panel</span><span class="p">()</span>
<span class="n">D3</span><span class="o">.</span><span class="n">draw_me</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_88_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_88_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">net_A</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;A_&#39;</span><span class="p">);</span> <span class="n">net_B</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">);</span> <span class="n">net_C</span><span class="o">=</span><span class="n">Net</span><span class="p">(</span><span class="s1">&#39;C_&#39;</span><span class="p">)</span>

<span class="n">arm1</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>
<span class="n">arm1wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">arm2</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>
<span class="n">arm2wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>
<span class="n">arm3</span><span class="o">=</span><span class="n">single_arm_mod</span><span class="o">.</span><span class="n">SKiDl_pack</span><span class="p">()</span>
<span class="n">arm3wire</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="nd">@u_Ohm</span><span class="p">)</span>

<span class="n">net_A</span> <span class="o">&amp;</span> <span class="n">arm2wire</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">arm2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_C</span> <span class="o">&amp;</span> <span class="n">arm1wire</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">arm1</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_B</span> <span class="o">&amp;</span> <span class="n">arm3wire</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">arm3</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">net_A</span>




<span class="n">D3</span><span class="o">.</span><span class="n">SKiDl_circ</span><span class="p">(</span><span class="n">net_A</span><span class="p">,</span> <span class="n">net_B</span><span class="p">,</span> <span class="n">net_C</span><span class="p">)</span>

<span class="n">circ</span><span class="o">=</span><span class="n">generate_netlist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Merging two named nets (a and A_) into a.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Merging two named nets (B_ and b) into B_.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Merging two named nets (C_ and c) into C_.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.title 
VAB a N_7 DC 0V AC 120V 0.0rad SIN(0V 1V 50Hz 0s 0Hz)
VBC B_ N_8 DC 0V AC 120V -119.99999999999999rad SIN(0V 1V 50Hz 0s 0Hz)
VCA C_ N_9 DC 0V AC 120V 119.99999999999999rad SIN(0V 1V 50Hz 0s 0Hz)
L1 B_ N_10 0.10063694267515924H
L10 N_21 N_22 0.013821656050955413H
L11 N_20 N_6 0.10063694267515924H
L12 N_23 N_24 0.013821656050955413H
L2 N_11 N_12 0.013821656050955413H
L3 N_10 N_2 0.10063694267515924H
L4 N_13 N_14 0.013821656050955413H
L5 C_ N_15 0.10063694267515924H
L6 N_16 N_17 0.013821656050955413H
L7 N_15 N_4 0.10063694267515924H
L8 N_18 N_19 0.013821656050955413H
L9 a N_20 0.10063694267515924H
R1 N_2 C_ 0Ohm
R10 B_ N_11 0.8Ohm
R11 N_12 N_10 442.0Ohm
R12 N_10 N_13 0.8Ohm
R13 N_14 N_2 442.0Ohm
R14 C_ N_16 0.8Ohm
R15 N_17 N_15 442.0Ohm
R16 N_15 N_18 0.8Ohm
R17 N_19 N_4 442.0Ohm
R18 a N_21 0.8Ohm
R19 N_22 N_20 442.0Ohm
R2 N_4 a 0Ohm
R20 N_20 N_23 0.8Ohm
R21 N_24 N_6 442.0Ohm
R3 N_6 B_ 0Ohm
Rabwire N_7 B_ 0Ohm
Raopen a 0 1e+16Ohm
Rbcwire N_8 C_ 0Ohm
Rbopen B_ 0 1e+16Ohm
Rcawire N_9 a 0Ohm
Rcopen C_ 0 1e+16Ohm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 warnings found during netlist generation.
0 errors found during netlist generation.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">=</span><span class="n">circ</span><span class="o">.</span><span class="n">simulator</span><span class="p">()</span>
<span class="n">ac_vals</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">ac</span><span class="p">(</span><span class="n">start_frequency</span><span class="o">=</span><span class="mi">48</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">stop_frequency</span><span class="o">=</span><span class="mi">62</span><span class="nd">@u_Hz</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ABPhase_Source&#39;: 
  SINEV (sinev, SINUSOIDALVOLTAGE, sinusoidalvoltage): Sinusoidal voltage source
     Pin AB/1/p,anode,+,plus,A/PASSIVE
     Pin AB/2/n,m,C,cathode,-,minus,K,negative,neg/PASSIVE,
 &#39;BCPhase_Source&#39;: 
  SINEV (sinev, SINUSOIDALVOLTAGE, sinusoidalvoltage): Sinusoidal voltage source
     Pin BC/1/p,anode,+,plus,A/PASSIVE
     Pin BC/2/n,m,C,cathode,-,minus,K,negative,neg/PASSIVE,
 &#39;CAPhase_Source&#39;: 
  SINEV (sinev, SINUSOIDALVOLTAGE, sinusoidalvoltage): Sinusoidal voltage source
     Pin CA/1/p,anode,+,plus,A/PASSIVE
     Pin CA/2/n,m,C,cathode,-,minus,K,negative,neg/PASSIVE}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_base_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ac_vals</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">())</span>
<span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;freq[Hz]&#39;</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;ABPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;ABPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BCPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;BCPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>

<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">node</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;CAPhase_Source&#39;</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>
<span class="n">ac_data_base_df</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">ac_vals</span><span class="p">[</span><span class="n">get_skidl_spice_ref</span><span class="p">(</span><span class="n">D3</span><span class="o">.</span><span class="n">panel_internals</span><span class="p">[</span><span class="s1">&#39;CAPhase_Source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">as_ndarray</span><span class="p">()</span>


<span class="n">ac_data_base_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>60.031250-3.556649j</td>
      <td>0.135554-1.978112j</td>
      <td>-59.968613-3.558628j</td>
      <td>-1.780872+0.871663j</td>
      <td>0.029606+100.365295j</td>
      <td>1.645318+1.106449j</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>60.391308-34.311031j</td>
      <td>0.135554-1.972309j</td>
      <td>-59.608559-34.313004j</td>
      <td>-1.775846+0.868761j</td>
      <td>0.389666+69.610916j</td>
      <td>1.640293+1.103547j</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>60.010448-34.633430j</td>
      <td>0.135553-1.966540j</td>
      <td>-59.989414-34.635395j</td>
      <td>-1.770850+0.865877j</td>
      <td>0.008814+69.288521j</td>
      <td>1.635297+1.100662j</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>59.996464-34.664597j</td>
      <td>0.135553-1.960804j</td>
      <td>-60.003399-34.666557j</td>
      <td>-1.765883+0.863010j</td>
      <td>-0.005165+69.257355j</td>
      <td>1.630330+1.097794j</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>60.017643-34.689152j</td>
      <td>0.135552-1.955102j</td>
      <td>-59.982220-34.691109j</td>
      <td>-1.760944+0.860159j</td>
      <td>0.016018+69.232803j</td>
      <td>1.625392+1.094943j</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61.434345</th>
      <td>59.996933-34.655178j</td>
      <td>0.135521-1.546178j</td>
      <td>-60.002930-34.656723j</td>
      <td>-1.406790+0.655724j</td>
      <td>-0.004336+69.266983j</td>
      <td>1.271269+0.890454j</td>
    </tr>
    <tr>
      <th>61.575756</th>
      <td>79.058121-45.661934j</td>
      <td>0.135521-1.542635j</td>
      <td>-40.941746-45.663475j</td>
      <td>-1.403721+0.653953j</td>
      <td>19.056849+58.260227j</td>
      <td>1.268200+0.888682j</td>
    </tr>
    <tr>
      <th>61.717171</th>
      <td>60.003307-34.609249j</td>
      <td>0.135521-1.539107j</td>
      <td>-59.996555-34.610790j</td>
      <td>-1.400666+0.652189j</td>
      <td>0.002043+69.312912j</td>
      <td>1.265146+0.886918j</td>
    </tr>
    <tr>
      <th>61.858585</th>
      <td>59.987812-34.635693j</td>
      <td>0.135520-1.535596j</td>
      <td>-60.012054-34.637230j</td>
      <td>-1.397626+0.650434j</td>
      <td>-0.013451+69.286469j</td>
      <td>1.262105+0.885162j</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>60.015533-34.611515j</td>
      <td>0.135520-1.532102j</td>
      <td>-59.984329-34.613045j</td>
      <td>-1.394599+0.648687j</td>
      <td>0.014275+69.310654j</td>
      <td>1.259079+0.883415j</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ac_data_ABC</span><span class="o">=</span><span class="n">ac_data_base_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#AB voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#AB current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_AB_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">####################################################################################</span>
<span class="c1">#BC voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#BC current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceB_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_BC_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">####################################################################################</span>
<span class="c1">#CA voltage</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_v_[V]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_v_[V]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_V_[V]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_vphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_v_[V]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#CA current</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceC_i_[A]&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;SourceA_i_[A]&#39;</span><span class="p">]</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_I_[A]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">])</span>
<span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_iphase_[deg]&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">[</span><span class="s1">&#39;Source_CA_i_[A]&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_AB_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_AB_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_BC_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_BC_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_BC_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_BC_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_CA_V_[V]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_CA_I_[A]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source_CA_vphase_[deg]&#39;</span><span class="p">,</span> <span class="s1">&#39;Source_CA_iphase_[deg]&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_0.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_0.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_1.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_2.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_2.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_3.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_3.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_4.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_4.png" />
<img alt="../_images/AC_1_One-Two-Three_Phase_AC_93_5.png" src="../_images/AC_1_One-Two-Three_Phase_AC_93_5.png" />
</div>
</div>
<p>I don’t understand why there is a bit of a spike in this simulation around 59Hz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_AB&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_CA_i_[A]</th>
      <th>Source_CA_I_[A]</th>
      <th>Source_CA_iphase_[deg]</th>
      <th>Source_AB_p_[W]</th>
      <th>Source_AB_P_[W]</th>
      <th>Source_AB_Q_[VAR]</th>
      <th>Source_AB_S_[VA]</th>
      <th>Source_AB_s_[VA]</th>
      <th>Source_AB_pf_[]</th>
      <th>Source_AB_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>60.031250-3.556649j</td>
      <td>0.135554-1.978112j</td>
      <td>-59.968613-3.558628j</td>
      <td>-1.780872+0.871663j</td>
      <td>0.029606+100.365295j</td>
      <td>1.645318+1.106449j</td>
      <td>119.999863+0.001978j</td>
      <td>119.999863</td>
      <td>0.000945</td>
      <td>1.916427-2.849775j</td>
      <td>...</td>
      <td>1.509764+3.084561j</td>
      <td>3.434226</td>
      <td>63.920181</td>
      <td>229.976562-341.968781j</td>
      <td>114.982651</td>
      <td>170.988174</td>
      <td>114.982651+170.988174j</td>
      <td>206.053314</td>
      <td>0.558024</td>
      <td>56.080757</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>60.391308-34.311031j</td>
      <td>0.135554-1.972309j</td>
      <td>-59.608559-34.313004j</td>
      <td>-1.775846+0.868761j</td>
      <td>0.389666+69.610916j</td>
      <td>1.640293+1.103547j</td>
      <td>119.999863+0.001972j</td>
      <td>119.999863</td>
      <td>0.000942</td>
      <td>1.911400-2.841070j</td>
      <td>...</td>
      <td>1.504739+3.075856j</td>
      <td>3.424198</td>
      <td>63.931671</td>
      <td>229.373383-340.924255j</td>
      <td>114.681091</td>
      <td>170.465912</td>
      <td>114.681091+170.465912j</td>
      <td>205.451645</td>
      <td>0.558190</td>
      <td>56.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>60.010448-34.633430j</td>
      <td>0.135553-1.966540j</td>
      <td>-59.989414-34.635395j</td>
      <td>-1.770850+0.865877j</td>
      <td>0.008814+69.288521j</td>
      <td>1.635297+1.100662j</td>
      <td>119.999863+0.001965j</td>
      <td>119.999863</td>
      <td>0.000938</td>
      <td>1.906403-2.832417j</td>
      <td>...</td>
      <td>1.499743+3.067202j</td>
      <td>3.414229</td>
      <td>63.943153</td>
      <td>228.773712-339.885895j</td>
      <td>114.381287</td>
      <td>169.946701</td>
      <td>114.381287+169.946701j</td>
      <td>204.853516</td>
      <td>0.558356</td>
      <td>56.057785</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>59.996464-34.664597j</td>
      <td>0.135553-1.960804j</td>
      <td>-60.003399-34.666557j</td>
      <td>-1.765883+0.863010j</td>
      <td>-0.005165+69.257355j</td>
      <td>1.630330+1.097794j</td>
      <td>119.999863+0.001961j</td>
      <td>119.999863</td>
      <td>0.000936</td>
      <td>1.901436-2.823814j</td>
      <td>...</td>
      <td>1.494777+3.058599j</td>
      <td>3.404318</td>
      <td>63.954636</td>
      <td>228.177551-338.853577j</td>
      <td>114.083237</td>
      <td>169.430511</td>
      <td>114.083237+169.430511j</td>
      <td>204.258865</td>
      <td>0.558523</td>
      <td>56.046295</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>60.017643-34.689152j</td>
      <td>0.135552-1.955102j</td>
      <td>-59.982220-34.691109j</td>
      <td>-1.760944+0.860159j</td>
      <td>0.016018+69.232803j</td>
      <td>1.625392+1.094943j</td>
      <td>119.999863+0.001957j</td>
      <td>119.999863</td>
      <td>0.000934</td>
      <td>1.896497-2.815262j</td>
      <td>...</td>
      <td>1.489840+3.050045j</td>
      <td>3.394466</td>
      <td>63.966122</td>
      <td>227.584885-337.827271j</td>
      <td>113.786934</td>
      <td>168.917358</td>
      <td>113.786934+168.917358j</td>
      <td>203.667725</td>
      <td>0.558689</td>
      <td>56.034809</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_95_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_95_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_BC&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_BC&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_AB_s_[VA]</th>
      <th>Source_AB_pf_[]</th>
      <th>Source_AB_pfang_[deg]</th>
      <th>Source_BC_p_[W]</th>
      <th>Source_BC_P_[W]</th>
      <th>Source_BC_Q_[VAR]</th>
      <th>Source_BC_S_[VA]</th>
      <th>Source_BC_s_[VA]</th>
      <th>Source_BC_pf_[]</th>
      <th>Source_BC_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>60.031250-3.556649j</td>
      <td>0.135554-1.978112j</td>
      <td>-59.968613-3.558628j</td>
      <td>-1.780872+0.871663j</td>
      <td>0.029606+100.365295j</td>
      <td>1.645318+1.106449j</td>
      <td>119.999863+0.001978j</td>
      <td>119.999863</td>
      <td>0.000945</td>
      <td>1.916427-2.849775j</td>
      <td>...</td>
      <td>206.053314</td>
      <td>0.558024</td>
      <td>56.080757</td>
      <td>181.165359+370.149933j</td>
      <td>114.982643</td>
      <td>170.988174</td>
      <td>114.982643+170.988174j</td>
      <td>206.053299</td>
      <td>0.558024</td>
      <td>56.080757</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>60.391308-34.311031j</td>
      <td>0.135554-1.972309j</td>
      <td>-59.608559-34.313004j</td>
      <td>-1.775846+0.868761j</td>
      <td>0.389666+69.610916j</td>
      <td>1.640293+1.103547j</td>
      <td>119.999863+0.001972j</td>
      <td>119.999863</td>
      <td>0.000942</td>
      <td>1.911400-2.841070j</td>
      <td>...</td>
      <td>205.451645</td>
      <td>0.558190</td>
      <td>56.069267</td>
      <td>180.562393+369.105316j</td>
      <td>114.681084</td>
      <td>170.465897</td>
      <td>114.681084+170.465897j</td>
      <td>205.451630</td>
      <td>0.558190</td>
      <td>56.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>60.010448-34.633430j</td>
      <td>0.135553-1.966540j</td>
      <td>-59.989414-34.635395j</td>
      <td>-1.770850+0.865877j</td>
      <td>0.008814+69.288521j</td>
      <td>1.635297+1.100662j</td>
      <td>119.999863+0.001965j</td>
      <td>119.999863</td>
      <td>0.000938</td>
      <td>1.906403-2.832417j</td>
      <td>...</td>
      <td>204.853516</td>
      <td>0.558356</td>
      <td>56.057785</td>
      <td>179.962967+368.066833j</td>
      <td>114.381294</td>
      <td>169.946716</td>
      <td>114.381294+169.946716j</td>
      <td>204.853531</td>
      <td>0.558356</td>
      <td>56.057785</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>59.996464-34.664597j</td>
      <td>0.135553-1.960804j</td>
      <td>-60.003399-34.666557j</td>
      <td>-1.765883+0.863010j</td>
      <td>-0.005165+69.257355j</td>
      <td>1.630330+1.097794j</td>
      <td>119.999863+0.001961j</td>
      <td>119.999863</td>
      <td>0.000936</td>
      <td>1.901436-2.823814j</td>
      <td>...</td>
      <td>204.258865</td>
      <td>0.558523</td>
      <td>56.046295</td>
      <td>179.367020+367.034363j</td>
      <td>114.083244</td>
      <td>169.430511</td>
      <td>114.083244+169.430511j</td>
      <td>204.258865</td>
      <td>0.558523</td>
      <td>56.046288</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>60.017643-34.689152j</td>
      <td>0.135552-1.955102j</td>
      <td>-59.982220-34.691109j</td>
      <td>-1.760944+0.860159j</td>
      <td>0.016018+69.232803j</td>
      <td>1.625392+1.094943j</td>
      <td>119.999863+0.001957j</td>
      <td>119.999863</td>
      <td>0.000934</td>
      <td>1.896497-2.815262j</td>
      <td>...</td>
      <td>203.667725</td>
      <td>0.558689</td>
      <td>56.034809</td>
      <td>178.774567+366.007935j</td>
      <td>113.786926</td>
      <td>168.917358</td>
      <td>113.786926+168.917358j</td>
      <td>203.667709</td>
      <td>0.558689</td>
      <td>56.034809</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 38 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_96_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_96_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">autogen_powercalcs</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_CA&#39;</span><span class="p">)</span>
<span class="n">power_calcs_ac</span><span class="o">.</span><span class="n">make_power_plot</span><span class="p">(</span><span class="n">ac_data_ABC</span><span class="p">,</span> <span class="s1">&#39;Source_CA&#39;</span><span class="p">)</span>
<span class="n">ac_data_ABC</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SourceA_v_[V]</th>
      <th>SourceA_i_[A]</th>
      <th>SourceB_v_[V]</th>
      <th>SourceB_i_[A]</th>
      <th>SourceC_v_[V]</th>
      <th>SourceC_i_[A]</th>
      <th>Source_AB_v_[V]</th>
      <th>Source_AB_V_[V]</th>
      <th>Source_AB_vphase_[deg]</th>
      <th>Source_AB_i_[A]</th>
      <th>...</th>
      <th>Source_BC_s_[VA]</th>
      <th>Source_BC_pf_[]</th>
      <th>Source_BC_pfang_[deg]</th>
      <th>Source_CA_p_[W]</th>
      <th>Source_CA_P_[W]</th>
      <th>Source_CA_Q_[VAR]</th>
      <th>Source_CA_S_[VA]</th>
      <th>Source_CA_s_[VA]</th>
      <th>Source_CA_pf_[]</th>
      <th>Source_CA_pfang_[deg]</th>
    </tr>
    <tr>
      <th>freq[Hz]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48.000000</th>
      <td>60.031250-3.556649j</td>
      <td>0.135554-1.978112j</td>
      <td>-59.968613-3.558628j</td>
      <td>-1.780872+0.871663j</td>
      <td>0.029606+100.365295j</td>
      <td>1.645318+1.106449j</td>
      <td>119.999863+0.001978j</td>
      <td>119.999863</td>
      <td>0.000945</td>
      <td>1.916427-2.849775j</td>
      <td>...</td>
      <td>206.053299</td>
      <td>0.558024</td>
      <td>56.080757</td>
      <td>-411.141937-28.181152j</td>
      <td>114.982651</td>
      <td>170.988174</td>
      <td>114.982651+170.988174j</td>
      <td>206.053314</td>
      <td>0.558024</td>
      <td>56.080757</td>
    </tr>
    <tr>
      <th>48.141415</th>
      <td>60.391308-34.311031j</td>
      <td>0.135554-1.972309j</td>
      <td>-59.608559-34.313004j</td>
      <td>-1.775846+0.868761j</td>
      <td>0.389666+69.610916j</td>
      <td>1.640293+1.103547j</td>
      <td>119.999863+0.001972j</td>
      <td>119.999863</td>
      <td>0.000942</td>
      <td>1.911400-2.841070j</td>
      <td>...</td>
      <td>205.451630</td>
      <td>0.558190</td>
      <td>56.069267</td>
      <td>-409.935791-28.181015j</td>
      <td>114.681091</td>
      <td>170.465912</td>
      <td>114.681091+170.465912j</td>
      <td>205.451645</td>
      <td>0.558190</td>
      <td>56.069267</td>
    </tr>
    <tr>
      <th>48.282829</th>
      <td>60.010448-34.633430j</td>
      <td>0.135553-1.966540j</td>
      <td>-59.989414-34.635395j</td>
      <td>-1.770850+0.865877j</td>
      <td>0.008814+69.288521j</td>
      <td>1.635297+1.100662j</td>
      <td>119.999863+0.001965j</td>
      <td>119.999863</td>
      <td>0.000938</td>
      <td>1.906403-2.832417j</td>
      <td>...</td>
      <td>204.853531</td>
      <td>0.558356</td>
      <td>56.057785</td>
      <td>-408.736694-28.180878j</td>
      <td>114.381287</td>
      <td>169.946701</td>
      <td>114.381287+169.946701j</td>
      <td>204.853516</td>
      <td>0.558356</td>
      <td>56.057785</td>
    </tr>
    <tr>
      <th>48.424244</th>
      <td>59.996464-34.664597j</td>
      <td>0.135553-1.960804j</td>
      <td>-60.003399-34.666557j</td>
      <td>-1.765883+0.863010j</td>
      <td>-0.005165+69.257355j</td>
      <td>1.630330+1.097794j</td>
      <td>119.999863+0.001961j</td>
      <td>119.999863</td>
      <td>0.000936</td>
      <td>1.901436-2.823814j</td>
      <td>...</td>
      <td>204.258865</td>
      <td>0.558523</td>
      <td>56.046288</td>
      <td>-407.544586-28.180756j</td>
      <td>114.083237</td>
      <td>169.430511</td>
      <td>114.083237+169.430511j</td>
      <td>204.258865</td>
      <td>0.558523</td>
      <td>56.046295</td>
    </tr>
    <tr>
      <th>48.565655</th>
      <td>60.017643-34.689152j</td>
      <td>0.135552-1.955102j</td>
      <td>-59.982220-34.691109j</td>
      <td>-1.760944+0.860159j</td>
      <td>0.016018+69.232803j</td>
      <td>1.625392+1.094943j</td>
      <td>119.999863+0.001957j</td>
      <td>119.999863</td>
      <td>0.000934</td>
      <td>1.896497-2.815262j</td>
      <td>...</td>
      <td>203.667709</td>
      <td>0.558689</td>
      <td>56.034809</td>
      <td>-406.359467-28.180664j</td>
      <td>113.786942</td>
      <td>168.917358</td>
      <td>113.786942+168.917358j</td>
      <td>203.667725</td>
      <td>0.558689</td>
      <td>56.034809</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 45 columns</p>
</div></div><img alt="../_images/AC_1_One-Two-Three_Phase_AC_97_1.png" src="../_images/AC_1_One-Two-Three_Phase_AC_97_1.png" />
</div>
</div>
<div class="section" id="citations">
<h2>Citations:<a class="headerlink" href="#citations" title="Permalink to this headline">¶</a></h2>
<p>[1] stackexchange Electrical Engineering. “Using a single phase induction motor equivalent circuit in LTspice,” Stack Overflow Forum, July 30, 2019. Available: https://electronics.stackexchange.com/questions/234290/using-a-single-phase-induction-motor-equivalent-circuit-in-ltspice)</p>
<p>[2] ALL ABOUT ELECTRONICS. “RMS (Root Mean Square) Value and Average Value of AC Signals
” YouTube, Sep 24, 2017. [Video file]. Available: https://youtu.be/qDHsokTcgck. [Accessed: Dec 20, 2020].</p>
<p>[3] Makarov, S., Ludwig, R. and Bitar, S., 2016. Practical Electrical Engineering. 1st ed. Cham: Springer International Publishing, pp.564-566.</p>
<p>[4] ALL ABOUT ELECTRONICS. “What is Power Factor? What is Leading &amp; Lagging Power factor ? Power Factor Correction Methods” YouTube, Nov 5, 2017. [Video file]. Available: https://youtu.be/iDYWfBGwT1w. [Accessed: Dec 20, 2020].</p>
<p>[5] Notaroš, B., 2011. Electromagnetics. Upper Saddle River: Prentice Hall, p.398.</p>
<p>[6] Technology Connections. “The US electrical system is not 120V” YouTube, Jun 22, 2020. [Video file]. Available: https://youtu.be/jMmUoZh3Hq4. [Accessed: Dec 20, 2020].</p>
<p>[7] Technology Connections. “The GFCI/RCD: A Simple but Life-Saving Protector” YouTube, Aug 17, 2018. [Video file]. Available: https://youtu.be/ILBjnZq0n8s. [Accessed: Dec 20, 2020].</p>
<p>[8] grayfurnaceman. “The difference between neutral and ground on the electric panel” YouTube, Jan 26, 2014. [Video file]. Available: https://youtu.be/-n8CiU_6KqE. [Accessed: Dec 20, 2020].</p>
<p>[9] ALL ABOUT ELECTRONICS. “Star to Delta Conversion (With Proof and Example)” YouTube, Mar 6, 2017. [Video file]. Available: https://youtu.be/9b17eqCT4-g. [Accessed: Dec 20, 2020].</p>
<p>[10] ALL ABOUT ELECTRONICS. “Delta to Star Conversion (with proof and example)” YouTube, Feb 28, 2017. [Video file]. Available: https://youtu.be/OV0qi7yzKAM. [Accessed: Dec 20, 2020].</p>
<p>[11] Alexander, C. and Sadiku, M., 2013. Fundamentals Of Electric Circuits. 5th ed. New York: McGraw-Hill, p.531.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./AC_2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="AC_1.html" title="previous page">Chapter 2 AC simulations with Python and SPICE</a>
    <a class='right-next' id="next-link" href="../Appendix/skidl_2_pyspice_check.html" title="next page">Checking tool</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Steven K Armour (PyLCARS)<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>